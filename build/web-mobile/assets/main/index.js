System.register("chunks:///_virtual/Animal.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts","./AnimalDataManager.ts","./GameController.ts","./NetworkManager.ts","./GrowthableEntity.ts"],(function(e){var t,n,r,a,s,i,c,o,u,l,h,d,p,f,m,C,v,T;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,s=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){c=e.cclegacy,o=e._decorator,u=e.director,l=e.Node},function(e){h=e.SharedDefines,d=e.GrowState,p=e.SceneItemState,f=e.CommandType},function(e){m=e.AnimalDataManager},function(e){C=e.GameController},function(e){v=e.NetworkManager},function(e){T=e.GrowthableEntity}],execute:function(){var y,_,w;c._RF.push({},"f32a1G+n41M64bv1de0LOTm","Animal",void 0);var A=o.ccclass,D=o.property;e("Animal",A("Animal")((w=t((_=function(e){function t(){for(var t,n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return t=e.call.apply(e,[this].concat(s))||this,r(t,"animalType",w,a(t)),t.gameController=void 0,t.playerController=void 0,t}n(t,e);var c=t.prototype;return c.onLoad=function(){this.gameController=u.getScene().getComponentInChildren(C),this.playerController=this.gameController.getPlayerController()},c.initialize=function(e){this.baseSpritePath=h.ANIMALS_TEXTURES,this.loadEntityData(e),this.growthStages.length>0?this.setupData(this.growthStages[0]):console.error("No growth stages found for animal with id: "+e)},c.initializeWithSceneItem=function(t,n){this.baseSpritePath=h.ANIMALS_TEXTURES,e.prototype.initializeWithSceneItem.call(this,t,n)},c.loadEntityData=function(e){var t=m.instance.findAnimalDataById(e);if(t){var n=t.animal_type;this.growthStages=m.instance.filterAnimalDataByAnimalType(n)}else console.error("No animal data found for id: "+e)},c.setupData=function(e){this.id=e.id,this.description=e.description,this.growthTime=parseFloat(e.time_min)*h.TIME_MINUTE,this.harvestItemId=e.harvest_item_id,this.farmType=e.farm_type,this.timeMin=parseFloat(e.time_min),this.levelNeed=parseInt(e.level_need)},c.canHarvest=function(){return(this.growState==d.HARVESTING||this.sceneItem.state==p.Dead)&&""!=this.harvestItemId&&this.isPlayerOwner},c.harvest=function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canHarvest()){e.next=3;break}return console.error("Animal "+this.node.name+" is not ready to harvest"),e.abrupt("return");case 3:return e.next=5,v.instance.harvest(this.sceneItem.id,this.sceneItem.item_id,this.sceneItem.type);case 5:if(!e.sent){e.next=15;break}return this.growState=d.NONE,this.eventTarget.emit(h.EVENT_ANIMAL_HARVEST,this),this.node.off(l.EventType.TOUCH_END,this.harvest,this),this.stopDiseaseStatusUpdates(),this.node.destroy(),e.abrupt("return");case 15:return console.error("Animal "+this.node.name+" harvest failed"),e.abrupt("return");case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.canPerformOperation=function(e){switch(e){case f.Care:return this.canCare();case f.Treat:return this.canTreat();case f.Cleanse:return this.canCleanse();default:return!1}},c.performOperation=function(){var e=s(i().mark((function e(t){var n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.SceneItem){e.next=3;break}return e.abrupt("return");case 3:r=null,e.t0=t,e.next=e.t0===f.Care?7:e.t0===f.Treat?12:e.t0===f.Cleanse?17:22;break;case 7:return e.next=9,v.instance.care(n.id);case 9:return(r=e.sent)&&r.success&&(this.CareCount=r.data.care_count),e.abrupt("break",22);case 12:return e.next=14,v.instance.treat(n.id);case 14:return(r=e.sent)&&r.success&&(this.TreatCount=r.data.treat_count),e.abrupt("break",22);case 17:return e.next=19,v.instance.cleanse(n.id);case 19:return(r=e.sent)&&r.success,e.abrupt("break",22);case 22:r&&r.success&&r.data.friend_id&&(console.log("Operation "+t+" on friend's animal, friend_id = "+r.data.friend_id+", diamond_added = "+r.data.diamond_added),this.playerController.playerState.addDiamond(r.data.diamond_added),this.playerController.friendState.addDiamond(r.data.diamond_added));case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),c.canCare=function(){return console.log("canCare: "+this.sceneItem.state+" "+this.CareCount+" "+this.lastCareTime+" "+h.CARE_COOLDOWN+" "+Date.now()/1e3),this.sceneItem.state!==p.Dead&&this.CareCount<h.MAX_ANIMAL_CARE_COUNT&&this.lastCareTime+h.CARE_COOLDOWN<Date.now()/1e3},c.canTreat=function(){return this.sceneItem.state!==p.Dead&&this.TreatCount<h.MAX_ANIMAL_TREAT_COUNT&&this.lastTreatTime+h.TREAT_COOLDOWN<Date.now()/1e3},c.canCleanse=function(){return this.sceneItem.state!==p.Dead&&this.CleanseCount<h.MAX_ANIMAL_CLEANSE_COUNT&&this.lastCleanseTime+h.CLEANSE_COOLDOWN<Date.now()/1e3},c.care=function(){var e=s(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.next=3,v.instance.care(this.sceneItem.id);case 3:return(t=e.sent)&&t.success&&(this.CareCount=t.data.care_count,this.lastCareTime=Date.now()/1e3),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.careByFriend=function(){var e=s(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.next=3,v.instance.careFriend(this.sceneItem.id,t);case 3:return(n=e.sent)&&n.success&&(this.CareCount=n.data.care_count,this.lastCareTime=Date.now()/1e3),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),c.treat=function(){var e=s(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.next=3,v.instance.treat(this.sceneItem.id);case 3:return(t=e.sent)&&t.success&&(this.TreatCount=t.data.treat_count,this.lastTreatTime=Date.now()/1e3),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.treatByFriend=function(){var e=s(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.next=3,v.instance.treatFriend(this.sceneItem.id,t);case 3:return(n=e.sent)&&n.success&&(this.TreatCount=n.data.treat_count,this.lastTreatTime=Date.now()/1e3),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),c.cleanse=function(){var e=s(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.next=3,v.instance.cleanse(this.sceneItem.id);case 3:return(t=e.sent)&&t.success&&(this.CleanseCount=t.data.cleanse_count,this.lastCleanseTime=Date.now()/1e3),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.cleanseByFriend=function(){var e=s(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.next=3,v.instance.cleanseFriend(this.sceneItem.id,t);case 3:return(n=e.sent)&&n.success&&(this.CleanseCount=n.data.cleanse_count,this.lastCleanseTime=Date.now()/1e3),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(T)).prototype,"animalType",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),y=_))||y);c._RF.pop()}}}));

System.register("chunks:///_virtual/AnimalDataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts"],(function(n){var t,a,i,e,r,u,l;return{setters:[function(n){t=n.createClass,a=n.asyncToGenerator,i=n.regeneratorRuntime},function(n){e=n.cclegacy,r=n.resources,u=n.JsonAsset},function(n){l=n.SharedDefines}],execute:function(){e._RF.push({},"ba8e1RcalRFVLNyvJIyInOS","AnimalDataManager",void 0),n("AnimalDataManager",function(){function n(){this.animalDataList=[]}var e=n.prototype;return e.loadAnimalData=function(){var n=a(i().mark((function n(){var t=this;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,a){r.load(l.JSON_ANIMAL_DATA,u,(function(i,e){if(i)return console.error("Failed to load AnimalData:",i),void a(i);t.animalDataList=e.json.list,n()}))})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),e.findAnimalDataById=function(n){return this.animalDataList.find((function(t){return t.id===n}))},e.findAnimalDataByName=function(n){return this.animalDataList.find((function(t){return t.name===n}))},e.filterAnimalDataByAnimalType=function(n){return this.animalDataList.filter((function(t){return t.animal_type===n}))},e.filterAnimalDataByFarmType=function(n){return this.animalDataList.filter((function(t){return t.farm_type===n}))},e.filterAnimalDataByMaxLevel=function(n){return this.animalDataList.filter((function(t){return parseInt(t.level_need)<=n}))},e.getAllAnimalData=function(){return[].concat(this.animalDataList)},e.getAnimalDataCount=function(){return this.animalDataList.length},e.isAnimalDataLoaded=function(){return this.animalDataList.length>0},t(n,null,[{key:"instance",get:function(){return null===this._instance&&(this._instance=new n),this._instance}}]),n}())._instance=null,e._RF.pop()}}}));

System.register("chunks:///_virtual/auto-config-intl-manager.ts",["cc","./l10n-manager.ts","./env"],(function(){var t,n,e,a;return{setters:[function(e){t=e.cclegacy,n=e.game},function(t){e=t.default},function(t){a=t.EDITOR}],execute:async function(){t._RF.push({},"2f21bx4gAFNj6dct9qDHJHH","auto-config-intl-manager",void 0),t.GAME_VIEW||a?await e.createIntl({}):n.onPostProjectInitDelegate.add((function(){return e.createIntl({})})),t._RF.pop()}}}));

System.register("chunks:///_virtual/BuildDataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts"],(function(t){var n,e,i,a,r,u,s;return{setters:[function(t){n=t.createClass,e=t.asyncToGenerator,i=t.regeneratorRuntime},function(t){a=t.cclegacy,r=t.resources,u=t.JsonAsset},function(t){s=t.SharedDefines}],execute:function(){a._RF.push({},"38f41AH+TRDz4vgiC1HLVIQ","BuildDataManager",void 0),t("BuildDataManager",function(){function t(){this.buildDataList=[]}var a=t.prototype;return a.loadBuildData=function(){var t=e(i().mark((function t(){var n=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){r.load(s.JSON_BUILD_DATA,u,(function(i,a){if(i)return console.error("Failed to load BuildData:",i),void e(i);n.buildDataList=a.json.list,t()}))})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a.findBuildDataById=function(t){return this.buildDataList.find((function(n){return n.id===t}))},a.findBuildDataByName=function(t){return this.buildDataList.find((function(n){return n.name===t}))},a.filterBuildDataByLevelRequirement=function(t){return this.buildDataList.filter((function(n){return parseInt(n.level_need)<=t}))},a.getAllBuildData=function(){return[].concat(this.buildDataList)},a.getBuildDataCount=function(){return this.buildDataList.length},a.isBuildDataLoaded=function(){return this.buildDataList.length>0},n(t,null,[{key:"instance",get:function(){return null===this._instance&&(this._instance=new t),this._instance}}]),t}())._instance=null,a._RF.pop()}}}));

System.register("chunks:///_virtual/Building.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourceManager.ts","./SharedDefines.ts","./BuildDataManager.ts"],(function(t){var e,i,n,r,a,s,o,u,l,c,d,h,p,g,f,m,T,S,C,E,D,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,r=t.assertThisInitialized,a=t.createClass,s=t.asyncToGenerator,o=t.regeneratorRuntime},function(t){u=t.cclegacy,l=t._decorator,c=t.EventTarget,d=t.Layers,h=t.Sprite,p=t.UITransform,g=t.BoxCollider2D,f=t.Size,m=t.Component,T=t.SpriteFrame},function(t){S=t.ResourceManager},function(t){C=t.BuildingType,E=t.SceneItemState,D=t.SharedDefines},function(t){y=t.BuildDataManager}],execute:function(){var v,N,b,B,I;u._RF.push({},"61831+EkDNPRoO0fnfBmq/J","Building",void 0);var w=l.ccclass,_=l.property,L=t("BuildingState",function(t){return t[t.NONE=0]="NONE",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.COMPLETED=2]="COMPLETED",t}({}));t("Building",w("Building")(((I=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,n(e,"id",b,r(e)),n(e,"level",B,r(e)),e.sprite=null,e.buildingData=void 0,e.sceneItem=null,e.buildingType=C.None,e.state=L.NONE,e.arrowContainer=null,e.eventTarget=new c,e.spriteCache=new Map,e}i(e,t);var u=e.prototype;return u.initialize=function(t){this.node.layer=d.nameToLayer("Building")+1,this.arrowContainer=this.node.getChildByName("Arrows"),this.arrowContainer.active=!1,this.sprite=this.getComponent(h),this.buildingData=t,this.id=t.id,this.updateSprite(),this.setState(L.CONSTRUCTING),this.buildingType=t.item_type},u.initializeFromSceneItem=function(t){console.log("Building initializeFromSceneItem start"),this.id=t.item_id,this.node.name=this.id,this.sceneItem=t,this.buildingData=y.instance.findBuildDataById(this.id),this.buildingData?(this.initialize(this.buildingData),console.log("sceneItem",t),t.state===E.Complete?this.setState(L.COMPLETED):t.state===E.InProgress&&this.setState(L.CONSTRUCTING)):console.error("Building data not found for id: "+this.id)},u.updateSprite=function(){var t=s(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.sprite||!this.buildingData.texture){t.next=8;break}if(e=this.spriteCache.get(this.buildingData.texture)){t.next=7;break}return t.next=5,S.instance.loadAsset(""+D.WINDOW_BUILDING_TEXTURES+this.buildingData.texture+"/spriteFrame",T);case 5:(e=t.sent)&&this.spriteCache.set(this.buildingData.texture,e);case 7:e&&(this.sprite.spriteFrame=e,this.updateCollider());case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),u.updateCollider=function(){var t=this.node.getComponent(p),e=this.node.getComponent(g);if(e){var i=t.contentSize;e.size=new f(.7*i.width,.7*i.height)}},u.setSprite=function(t){this.sprite=t},u.setState=function(t){if(this.state!==t){console.log("Building setState to "+t);var i=this.state;this.state=t,this.eventTarget.emit(e.EVENT_STATE_CHANGED,{oldState:i,newState:t})}},u.getState=function(){return this.state},u.completeConstruction=function(){var t=s(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState(L.COMPLETED);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),u.upgrade=function(t){return this.level++,this.eventTarget.emit(e.EVENT_LEVEL_UP,this.level),!0},u.select=function(){console.log("Building "+this.name+" selected")},u.deselect=function(){console.log("Building "+this.name+" deselected")},a(e,[{key:"BuildingData",get:function(){return this.buildingData}},{key:"isFactory",get:function(){return this.buildingType==C.Factory}},{key:"SceneItem",get:function(){return this.sceneItem}}]),e}(m)).EVENT_STATE_CHANGED="building-state-changed",I.EVENT_LEVEL_UP="building-level-up",b=e((N=I).prototype,"id",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),B=e(N.prototype,"level",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),v=N))||v);u._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var i,t,e,s,u;return{setters:[function(n){i=n.inheritsLoose,t=n.createClass},function(n){e=n.cclegacy,s=n._decorator,u=n.Component}],execute:function(){var l,r;e._RF.push({},"a3120+sV6lEbZziWW57QgDd","BuildingManager",void 0);var o=s.ccclass;s.property,n("BuildingManager",o("BuildingManager")(((r=function(n){function e(){for(var i,t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return(i=n.call.apply(n,[this].concat(e))||this).buildings=new Map,i}i(e,n);var s=e.prototype;return s.addBuilding=function(n,i){this.buildings.set(n,i)},s.hasBuildingOfType=function(n){return this.buildings.has(n)},s.focusOnBuilding=function(n){this.buildings.get(n)&&console.log("Focusing on building: "+n)},s.getBuildingPosition=function(n){var i=this.buildings.get(n);return i?i.worldPosition:null},t(e,null,[{key:"instance",get:function(){return null===this._instance&&(this._instance=new e),this._instance}}]),e}(u))._instance=null,l=r))||l);e._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingPlacementComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts","./ResourceManager.ts","./Building.ts","./NetworkManager.ts","./SpriteHelper.ts","./GameController.ts","./UIHelper.ts"],(function(n){var t,e,i,o,a,r,s,l,c,u,d,h,g,p,C,m,f,v,B,S,b,P,y,w,A,D;return{setters:[function(n){t=n.inheritsLoose,e=n.asyncToGenerator,i=n.regeneratorRuntime},function(n){o=n.cclegacy,a=n._decorator,r=n.RigidBody2D,s=n.Collider2D,l=n.Color,c=n.Director,u=n.Camera,d=n.Sprite,h=n.Vec3,g=n.Rect,p=n.PhysicsSystem2D,C=n.SpriteFrame,m=n.UITransform,f=n.BoxCollider2D,v=n.Size,B=n.Component},function(n){S=n.SharedDefines},function(n){b=n.ResourceManager},function(n){P=n.Building},function(n){y=n.NetworkManager},function(n){w=n.SpriteHelper},function(n){A=n.GameController},function(n){D=n.UIHelper}],execute:function(){var I;o._RF.push({},"de5359MGmBIoaJz/g7rdEVM","BuildingPlacementComponent",void 0);var x=a.ccclass;a.property,n("BuildingPlacementComponent",x("BuildingPlacementComponent")(I=function(n){function o(){for(var t,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(t=n.call.apply(n,[this].concat(i))||this).gameController=null,t.buildData=void 0,t.buildingManager=null,t.isPlacing=!1,t.uiCanvas=null,t.gameplayCanvas=null,t.camera=null,t.buildingSprite=null,t.collider=null,t.contactCount=0,t.isIntersecting=!1,t.debugDraw=null,t}t(o,n);var a=o.prototype;return a.onEnable=function(){var n=this.node.getComponent(r);n&&(n.enabledContactListener=!0),this.collider=this.node.getComponent(s)},a.onDisable=function(){var n=this.node.getComponent(r);n&&(n.enabledContactListener=!1)},a.onBeginContact=function(n,t,e){this.contactCount++,w.setSpriteColor(this.buildingSprite,new l(255,0,0,125)),console.log("onBeginContact self: "+this.node.name+", other: "+t.node.name+", contact count: "+this.contactCount)},a.onEndContact=function(n,t,e){this.contactCount--,0===this.contactCount&&w.setSpriteColor(this.buildingSprite,new l(255,255,255,125)),console.log("onEndContact self: "+this.node.name+", other: "+t.node.name+", contact count: "+this.contactCount)},a.initialize=function(n,t){this.gameController=c.instance.getScene().getComponentInChildren(A),this.uiCanvas=this.gameController.UICanvas.node,this.gameplayCanvas=this.gameController.GameplayCanvas.node,this.node.name=n.id,this.buildData=n,this.buildingManager=t;var e=c.instance.getScene().getChildByPath(S.PATH_CAMERA);e?(this.camera=e.getComponent(u),this.buildingSprite=this.node.getComponent(d),this.updateBuildingAppearance()):console.error("Cannot find camera node")},a.onTouchStart=function(n){this.isPlacing=!0;var t=n.getLocation();this.updateBuildingPositionAndAppearance(new h(t.x,t.y,0))},a.onTouchMove=function(n){if(this.isPlacing){var t=n.getLocation(),e=new h(t.x,t.y,0);this.updateBuildingPositionAndAppearance(e)}else this.buildingSprite&&w.setSpriteColor(this.buildingSprite,new l(255,255,255,125))},a.detectCollision=function(n){var t=D.convertPositionBetweenCanvas(n,this.uiCanvas,this.gameplayCanvas),e=new g(this.collider.worldAABB);return e.width*=.7,e.height*=.7,e.x=t.x-e.width/2,e.y=t.y-e.height/2,p.instance.testAABB(e).length>0},a.updateBuildingPositionAndAppearance=function(n){var t=this.camera.screenToWorld(n);t&&(this.node.setWorldPosition(t),this.detectCollision(t)?(0===this.contactCount&&w.setSpriteColor(this.buildingSprite,new l(255,0,0,125)),this.contactCount=1,console.log("Collision detected")):(1===this.contactCount&&w.setSpriteColor(this.buildingSprite,new l(255,255,255,125)),this.contactCount=0))},a.updateBuildingAppearance=function(){var n=this;console.log("BuildingPlacementComponent.updateBuildingAppearance start .. pending texture = "+this.buildData.texture),b.instance.loadAsset(""+S.WINDOW_BUILDING_TEXTURES+this.buildData.texture+"/spriteFrame",C).then((function(t){n.buildingSprite.spriteFrame=t;var e=n.node.getComponent(m),i=n.node.getComponent(f);if(i){var o=e.contentSize;i.size=new v(.7*o.width,.7*o.height)}}))},a.canPlaceBuilding=function(){return 0===this.contactCount},a.placeBuilding=function(){var n=e(i().mark((function n(t){var e,o,a,r,s;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("Place building"),w.setSpriteColor(this.buildingSprite,new l(255,255,255,255)),e=this.node.getWorldPosition(),o=this.node.addComponent(P),!(a=c.instance.getScene().getChildByPath(S.PATH_BUILDINGS))){n.next=10;break}this.node.removeFromParent(),a.addChild(this.node),n.next=12;break;case 10:return console.error("BuildingContainer not found, building will remain in current parent"),n.abrupt("return");case 12:return c.instance.getScene().getComponentInChildren(A),r=D.convertPositionBetweenCanvas(e,this.uiCanvas,this.gameplayCanvas),this.node.setWorldPosition(r),n.next=17,y.instance.addBuilding(this.buildData.id,r.x,r.y,a.name);case 17:s=n.sent,console.log("add building result",s),s.success&&(o.initializeFromSceneItem(s.data.sceneItem),o.completeConstruction(),console.log("add building success"),this.buildingManager.addBuilding(this.buildData.id,this.node),this.isPlacing=!1,t(s),this.destroy());case 20:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}(),a.cancelPlacement=function(){this.isPlacing=!1,this.node.destroy()},a.finalizePlacement=function(){this.isPlacing&&(this.canPlaceBuilding()?this.placeBuilding():this.cancelPlacement())},o}(B))||I);o._RF.pop()}}}));

System.register("chunks:///_virtual/CoinCollectionEffectComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,n,o,r,a,l,s,c,u,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,l=e.Prefab,s=e.Vec3,c=e.instantiate,u=e.tween,f=e.Component}],execute:function(){var p,d,h,b,C,g,P,m,y,v,w;r._RF.push({},"a2d775WJhFEEbhlDR4V1WFj","CoinCollectionEffectComponent",void 0);var D=a.ccclass,z=a.property,I=e("CoinType",function(e){return e[e.COIN=0]="COIN",e[e.DIAMOND=1]="DIAMOND",e}({}));e("CoinCollectionEffectComponent",(p=D("CoinCollectionEffectComponent"),d=z(l),h=z(l),p((g=t((C=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"coinPrefab",g,o(t)),n(t,"diamondPrefab",P,o(t)),n(t,"coinCount",m,o(t)),n(t,"spreadRadius",y,o(t)),n(t,"moveDuration",v,o(t)),n(t,"delayBetweenCoins",w,o(t)),t.targetPosition=new s,t.isPlaying=!1,t.targetPrefab=null,t}i(t,e);var r=t.prototype;return r.onLoad=function(){},r.setTargetPosition=function(e){this.targetPosition=e},r.play=function(e,t,i){var n=this;if(!this.isPlaying)if(e===I.COIN?this.targetPrefab=this.coinPrefab:e===I.DIAMOND&&(this.targetPrefab=this.diamondPrefab),this.targetPrefab){this.isPlaying=!0,this.targetPosition=i;for(var o=0;o<this.coinCount;o++)this.scheduleOnce((function(){return n.spawnCoin(t)}),o*this.delayBetweenCoins)}else console.error("No target prefab set")},r.stop=function(){this.isPlaying=!1,this.unscheduleAllCallbacks(),this.node.removeAllChildren()},r.spawnCoin=function(e){var t=this,i=c(this.targetPrefab);i.active=!0,i.parent=this.node;var n=new s(2*(Math.random()-.5)*this.spreadRadius,2*(Math.random()-.5)*this.spreadRadius,0);i.setWorldPosition(e.add(n)),u(i).to(this.moveDuration,{worldPosition:this.targetPosition}).call((function(){i.removeFromParent(),1===t.node.children.length&&(t.isPlaying=!1,t.node.emit("effectComplete"),t.node.destroy())})).start()},t}(f)).prototype,"coinPrefab",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(C.prototype,"diamondPrefab",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=t(C.prototype,"coinCount",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),y=t(C.prototype,"spreadRadius",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),v=t(C.prototype,"moveDuration",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),w=t(C.prototype,"delayBetweenCoins",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.05}}),b=C))||b));r._RF.pop()}}}));

System.register("chunks:///_virtual/CoinDataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts"],(function(n){var t,e,i,r,a,o,s;return{setters:[function(n){t=n.createClass,e=n.asyncToGenerator,i=n.regeneratorRuntime},function(n){r=n.cclegacy,a=n.resources,o=n.JsonAsset},function(n){s=n.SharedDefines}],execute:function(){r._RF.push({},"51ac6A6BJVPKa2V1Xw60EEq","CoinDataManager",void 0),n("CoinDataManager",function(){function n(){this.coinDataList=[]}var r=n.prototype;return r.loadCoinData=function(){var n=e(i().mark((function n(){var t=this;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,e){a.load(s.JSON_COIN_DATA,o,(function(i,r){if(i)return console.error("Failed to load CoinData:",i),void e(i);t.coinDataList=r.json.list,n()}))})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),r.getCoinById=function(n){return this.coinDataList.find((function(t){return t.id===n}))},r.getCoinByPayMoney=function(n){return this.coinDataList.find((function(t){return t.pay_money===n}))},r.getCoinsByPayMoneyRange=function(n,t){return this.coinDataList.filter((function(e){var i=parseInt(e.pay_money);return i>=n&&i<=t}))},r.getCoinsByGetMoneyRange=function(n,t){return this.coinDataList.filter((function(e){var i=parseInt(e.get_money);return i>=n&&i<=t}))},r.getAllCoins=function(){return[].concat(this.coinDataList)},r.getCoinCount=function(){return this.coinDataList.length},r.isCoinDataLoaded=function(){return this.coinDataList.length>0},t(n,null,[{key:"instance",get:function(){return null===this._instance&&(this._instance=new n),this._instance}}]),n}())._instance=null,r._RF.pop()}}}));

System.register("chunks:///_virtual/CoinDisplay.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CurrencyDisplayBase.ts","./SharedDefines.ts"],(function(e){var t,n,r,i,a;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator},function(e){i=e.CurrencyDisplayBase},function(e){a=e.SharedDefines}],execute:function(){var s;n._RF.push({},"fc5a2OtcTJFMrD++s+uNqe6","CoinDisplay",void 0);var c=r.ccclass;e("CoinDisplay",c("CoinDisplay")(s=function(e){function n(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).eventName=a.EVENT_PLAYER_GOLD_CHANGE,t}return t(n,e),n.prototype.getCurrencyValue=function(){return this.playerState?this.playerState.gold:0},n}(i))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/CooldownComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var n,e,t,i;return{setters:[function(o){n=o.inheritsLoose},function(o){e=o.cclegacy,t=o._decorator,i=o.Component}],execute:function(){var r;e._RF.push({},"55a10bXNBRBu74jk/OKxn/L","CooldownComponent",void 0);var c=t.ccclass;t.property,o("CooldownComponent",c("CooldownComponent")(r=function(o){function e(){for(var n,e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return(n=o.call.apply(o,[this].concat(t))||this).cooldowns=new Map,n}n(e,o);var t=e.prototype;return t.startCooldown=function(o,n,e){this.cooldowns.has(o)&&console.warn('Cooldown with key "'+o+'" already exists. Overwriting.'),console.log('Starting cooldown with key "'+o+'" for '+n+" seconds"),this.cooldowns.set(o,{remainingTime:n,duration:n,callback:e})},t.removeCooldown=function(o){this.cooldowns.delete(o)},t.isOnCooldown=function(o){return this.cooldowns.has(o)},t.getRemainingTime=function(o){var n=this.cooldowns.get(o);return n?n.remainingTime:0},t.getCooldownProgress=function(o){var n=this.cooldowns.get(o);return n?1-n.remainingTime/n.duration:1},t.update=function(o){var n=this;this.cooldowns.forEach((function(e,t){e.remainingTime-=o,e.remainingTime<=0&&(e.callback(),n.cooldowns.delete(t))}))},e}(i))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/CraftScrollViewItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourceManager.ts","./SharedDefines.ts","./ScrollViewItem.ts","./l10n.ts","./l10n-manager.ts"],(function(e){var t,i,n,r,o,a,l,u,s,c,p,d,b,f,m,h,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){l=e.cclegacy,u=e._decorator,s=e.Label,c=e.Node,p=e.Sprite,d=e.Button,b=e.SpriteFrame},function(e){f=e.ResourceManager},function(e){m=e.SharedDefines},function(e){h=e.ScrollViewItem},null,function(e){g=e.default}],execute:function(){var y,v,S,w,D,I,N,C,_,z,F,V,L,R,x;l._RF.push({},"5e4e2gI5YpI2bq36MMUWNp5","CraftScrollViewItem",void 0);var M=u.ccclass,T=u.property;e("CraftScrollViewItem",(y=M("CraftScrollViewItem"),v=T(s),S=T(s),w=T(c),D=T(s),I=T(p),N=T(d),y((z=t((_=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"lbName",z,r(t)),n(t,"lbCoin",F,r(t)),n(t,"diamondNode",V,r(t)),n(t,"lbDiamond",L,r(t)),n(t,"sprite",R,r(t)),n(t,"button",x,r(t)),t.buildData=void 0,t}i(t,e);var l=t.prototype;return l.initialize=function(e,t){this.buildData=e,this.lbName&&(this.lbName.string=g.t(e.description)),this.lbCoin&&(this.lbCoin.string=e.cost_coin.toString()),this.diamondNode&&(this.diamondNode.active=e.cost_diamond>0),this.lbDiamond&&(this.lbDiamond.string=e.cost_diamond.toString()),this.loadSpriteFrame(e.texture),this.button&&this.button.node.on(d.EventType.CLICK,(function(){return t(e)}),this),this.node.name=e.id},l.loadSpriteFrame=function(){var e=o(a().mark((function e(t){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.sprite){e.next=5;break}return e.next=3,f.instance.loadAsset(""+m.WINDOW_BUILDING_TEXTURES+t+"/spriteFrame",b);case 3:(i=e.sent)&&(this.sprite.spriteFrame=i);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.setActive=function(e){this.node.active=e},l.updateVisibilityByLevel=function(e){this.setActive(e>=this.buildData.level_need)},t}(h)).prototype,"lbName",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(_.prototype,"lbCoin",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(_.prototype,"diamondNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(_.prototype,"lbDiamond",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(_.prototype,"sprite",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(_.prototype,"button",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=_))||C));l._RF.pop()}}}));

System.register("chunks:///_virtual/CraftWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WindowBase.ts","./BuildDataManager.ts","./SharedDefines.ts","./WindowManager.ts","./CoinDisplay.ts","./DiamondDisplay.ts","./BuildingManager.ts","./CraftScrollViewItem.ts"],(function(e){var t,i,n,l,o,r,a,s,c,u,p,h,d,f,C,y,m,b,w,g,I;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,l=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose,r=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e._decorator,u=e.Node,p=e.ScrollView,h=e.Button,d=e.instantiate},function(e){f=e.WindowBase},function(e){C=e.BuildDataManager},function(e){y=e.SharedDefines},function(e){m=e.WindowManager},function(e){b=e.CoinDisplay},function(e){w=e.DiamondDisplay},function(e){g=e.BuildingManager},function(e){I=e.CraftScrollViewItem}],execute:function(){var B,D,v,L,P,T,V,E,z,N,k,W,A,M,_,S,G,K,U,F,R,x,O,H,J;s._RF.push({},"3ba238sJhJExKFO4IBALzZH","CraftWindow",void 0);var j=c.ccclass,Y=c.property,Z=function(e){return e[e.BUILDING=0]="BUILDING",e[e.PLACEMENT=1]="PLACEMENT",e}(Z||{});e("CraftWindow",(B=j("CraftWindow"),D=Y(u),v=Y(u),L=Y(u),P=Y(p),T=Y(u),V=Y(u),E=Y(b),z=Y(w),N=Y(h),k=Y(h),W=Y(h),B((_=t((M=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,n(t,"buildingView",_,l(t)),n(t,"placementView",S,l(t)),n(t,"placementContainer",G,l(t)),n(t,"scrollView",K,l(t)),n(t,"itemTemplate",U,l(t)),n(t,"content",F,l(t)),n(t,"coinDisplay",R,l(t)),n(t,"diamondDisplay",x,l(t)),n(t,"btnPlacement",O,l(t)),n(t,"btnCancel",H,l(t)),n(t,"btnClose",J,l(t)),t.viewType=Z.BUILDING,t.playerController=null,t.buildItems=[],t}i(t,e);var s=t.prototype;return s.initialize=function(){if(e.prototype.initialize.call(this),this.gameController){if(this.playerController=this.gameController.getPlayerController(),!this.playerController)return void console.error("PlayerController not found on CraftWindow node");this.coinDisplay&&this.coinDisplay.initialize(this.playerController.playerState),this.diamondDisplay&&this.diamondDisplay.initialize(this.playerController.playerState)}this.loadBuildItems(),this.setupEventListeners()},s.setupEventListeners=function(){this.playerController&&this.playerController.eventTarget.on(y.EVENT_PLAYER_PLACEMENT_BUILDING,this.onPlacementBuilding,this),this.btnClose?this.btnClose.node.on(h.EventType.CLICK,this.onCloseButtonClicked,this):console.warn("Close button not found in CraftWindow"),this.btnPlacement&&this.btnPlacement.node.on(h.EventType.CLICK,this.onBtnPlacementClicked,this),this.btnCancel&&this.btnCancel.node.on(h.EventType.CLICK,this.onBtnCancelClicked,this)},s.onCloseButtonClicked=function(){m.instance.hide(y.WINDOW_CRAFT_NAME)},s.loadBuildItems=function(){var e=r(a().mark((function e(){var t,i,n,l,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.content&&this.itemTemplate){e.next=3;break}return console.error("Content node or item prefab is missing"),e.abrupt("return");case 3:for(t=C.instance.getAllBuildData(),i=o(t);!(n=i()).done;)l=n.value,r=d(this.itemTemplate),(s=r.getComponent(I))?(s.initialize(l,this.onBuildItemClicked.bind(this)),this.content.addChild(r),this.buildItems.push(r)):console.error("CraftScrollViewItem component not found on item prefab");this.updateItemsVisibility(),this.itemTemplate.active=!1;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.updateItemsVisibility=function(){if(this.playerController)for(var e=this.playerController.playerState.level,t=0;t<this.buildItems.length;t++){var i=this.buildItems[t].getComponent(I);i&&i.updateVisibilityByLevel(e)}},s.show=function(){for(var t,i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];(t=e.prototype.show).call.apply(t,[this].concat(n)),this.switchView(Z.BUILDING)},s.refreshItems=function(){this.updateItemsVisibility()},s.switchView=function(e){this.viewType=e,this.viewType===Z.BUILDING?(this.buildingView.active=!0,this.placementView.active=!1,this.updateItemsVisibility(),this.coinDisplay&&this.coinDisplay.refreshDisplay(),this.diamondDisplay&&this.diamondDisplay.refreshDisplay()):(this.buildingView.active=!1,this.placementView.active=!0)},s.onBuildItemClicked=function(e){console.log("Build item clicked: "+e.name);g.instance;this.playerController.playerState.gold>=e.cost_coin?(this.switchView(Z.PLACEMENT),this.startBuildingPlacement(e)):console.log("Not enough coins")},s.startBuildingPlacement=function(e){this.playerController&&this.playerController.startBuildingPlacement(e,this.placementContainer)},s.onBtnPlacementClicked=function(){this.playerController&&this.playerController.tryPlacementBuilding()},s.onBtnCancelClicked=function(){this.playerController&&this.playerController.cancelBuildingPlacement()},s.onPlacementBuilding=function(e){e?m.instance.hide(y.WINDOW_CRAFT_NAME):this.switchView(Z.BUILDING)},s.onDestroy=function(){e.prototype.onDestroy.call(this),this.btnClose&&this.btnClose.node.off(h.EventType.CLICK,this.onCloseButtonClicked,this),this.btnPlacement&&this.btnPlacement.node.off(h.EventType.CLICK,this.onBtnPlacementClicked,this),this.btnCancel&&this.btnCancel.node.off(h.EventType.CLICK,this.onBtnCancelClicked,this);for(var t,i=o(this.buildItems);!(t=i()).done;){var n=t.value.getComponent(h);n&&n.node.off(h.EventType.CLICK)}},t}(f)).prototype,"buildingView",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(M.prototype,"placementView",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(M.prototype,"placementContainer",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(M.prototype,"scrollView",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(M.prototype,"itemTemplate",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(M.prototype,"content",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(M.prototype,"coinDisplay",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(M.prototype,"diamondDisplay",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(M.prototype,"btnPlacement",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(M.prototype,"btnCancel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(M.prototype,"btnClose",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=M))||A));s._RF.pop()}}}));

System.register("chunks:///_virtual/Crop.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts","./CropDataManager.ts","./NetworkManager.ts","./GrowthableEntity.ts"],(function(e){var t,r,n,a,s,i,o,c,u,l,h,p,d,f,C,m,T;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,a=e.assertThisInitialized,s=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){o=e.cclegacy,c=e._decorator,u=e.Enum,l=e.Node},function(e){h=e.CropType,p=e.SharedDefines,d=e.GrowState,f=e.SceneItemState},function(e){C=e.CropDataManager},function(e){m=e.NetworkManager},function(e){T=e.GrowthableEntity}],execute:function(){var v,_,b,w,y;o._RF.push({},"a03caDjiHhFnKW6O1UaGCiK","Crop",void 0);var g=c.ccclass,D=c.property;e("Crop",(v=g("Crop"),_=D({type:u(h)}),v((y=t((w=function(e){function t(){for(var t,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t=e.call.apply(e,[this].concat(s))||this,n(t,"cropType",y,a(t)),t.cropDatas=[],t.cropDataIndex=0,t}r(t,e);var o=t.prototype;return o.initialize=function(e){this.baseSpritePath=p.CROPS_TEXTURES,this.loadEntityData(e),this.growthStages.length>0?this.setupData(this.growthStages[0]):console.error("No growth stages found for crop with id: "+e)},o.initializeWithSceneItem=function(t,r){this.baseSpritePath=p.CROPS_TEXTURES,e.prototype.initializeWithSceneItem.call(this,t,r)},o.loadEntityData=function(e){var t=C.instance.findCropDataById(e);t?(this.cropType=parseInt(t.crop_type),this.growthStages=C.instance.filterCropDataByCropType(this.cropType.toString())):console.error("No crop data found for id: "+e)},o.setupData=function(e){this.id=e.id,this.growthTime=parseFloat(e.time_min)*p.TIME_MINUTE,this.harvestItemId=e.harvest_item_id,this.levelNeed=e.level_need},o.canHarvest=function(){return console.log("Crop "+this.node.name+" growState = "+this.growState+", sceneItem.state = "+this.sceneItem.state+", harvestItemId = "+this.harvestItemId),(this.growState==d.HARVESTING||this.sceneItem.state==f.Dead)&&""!=this.harvestItemId&&this.isPlayerOwner},o.harvest=function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Crop "+this.node.name+" harvest"),this.canHarvest()){e.next=4;break}return console.error("Crop "+this.node.name+" harvest failed"),e.abrupt("return");case 4:return e.next=6,m.instance.harvest(this.sceneItem.id,this.sceneItem.item_id,this.sceneItem.type);case 6:if(!e.sent){e.next=16;break}return this.growState=d.NONE,this.eventTarget.emit(p.EVENT_CROP_HARVEST,this),this.node.off(l.EventType.TOUCH_END,this.harvest,this),this.stopDiseaseStatusUpdates(),this.node.destroy(),e.abrupt("return");case 16:return console.error("Crop "+this.node.name+" harvest failed"),e.abrupt("return");case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.canCare=function(){return this.careCount>=0&&this.careCount<p.MAX_CROP_CARE_COUNT&&this.lastCareTime+p.CARE_COOLDOWN<Date.now()/1e3},o.canTreat=function(){return this.treatCount>=0&&this.treatCount<p.MAX_CROP_TREAT_COUNT&&this.lastTreatTime+p.TREAT_COOLDOWN<Date.now()/1e3},o.canCleanse=function(){return this.cleanseCount>=0&&this.cleanseCount<p.MAX_CROP_CLEANSE_COUNT&&this.lastCleanseTime+p.CLEANSE_COOLDOWN<Date.now()/1e3},o.care=function(){var e=s(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canCare()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,m.instance.care(this.sceneItem.id);case 4:if(!(t=e.sent).success){e.next=11;break}return this.CareCount=t.data.care_count,this.lastCareTime=Date.now()/1e3,e.abrupt("return",t);case 11:console.log("Care failed");case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.careByFriend=function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canCare()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,m.instance.careFriend(this.sceneItem.id,t);case 4:if(!(r=e.sent).success){e.next=12;break}return this.CareCount=r.data.care_count,this.lastCareTime=Date.now()/1e3,r.data.friend_id&&console.log("care friend , name = "+r.data.friend_id+" , friend_id = "+t+" , diamond_added = "+r.data.diamond_added),e.abrupt("return",r);case 12:console.log("Care failed");case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.treat=function(){var e=s(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canTreat()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,m.instance.treat(this.sceneItem.id);case 4:if(!(t=e.sent).success){e.next=11;break}return this.TreatCount=t.data.treat_count,this.lastTreatTime=Date.now()/1e3,e.abrupt("return",t);case 11:console.log("Treat failed");case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.treatByFriend=function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canTreat()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,m.instance.treatFriend(this.sceneItem.id,t);case 4:if(!(r=e.sent).success){e.next=12;break}return this.TreatCount=r.data.treat_count,this.lastTreatTime=Date.now()/1e3,r.data.friend_id&&console.log("treat friend , name = "+r.data.friend_id+" , friend_id = "+t+" , diamond_added = "+r.data.diamond_added),e.abrupt("return",r);case 12:console.log("Treat failed");case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.cleanse=function(){var e=s(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canCleanse()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,m.instance.cleanse(this.sceneItem.id);case 4:if(!(t=e.sent).success){e.next=11;break}return this.CleanseCount=t.data.cleanse_count,this.lastCleanseTime=Date.now()/1e3,e.abrupt("return",t);case 11:console.log("Cleanse failed");case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.cleanseByFriend=function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canCleanse()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,m.instance.cleanseFriend(this.sceneItem.id,t);case 4:if(!(r=e.sent).success){e.next=11;break}return this.CleanseCount=r.data.cleanse_count,this.lastCleanseTime=Date.now()/1e3,e.abrupt("return",r);case 11:console.log("Cleanse failed");case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(T)).prototype,"cropType",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return h.CORN}}),b=w))||b));o._RF.pop()}}}));

System.register("chunks:///_virtual/CropDataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts"],(function(t){var n,r,e,a,i,o,u;return{setters:[function(t){n=t.createClass,r=t.asyncToGenerator,e=t.regeneratorRuntime},function(t){a=t.cclegacy,i=t.resources,o=t.JsonAsset},function(t){u=t.SharedDefines}],execute:function(){a._RF.push({},"85c17ALda9ABLUWg1ILeD8C","CropDataManager",void 0),t("CropDataManager",function(){function t(){this.cropDataList=[]}var a=t.prototype;return a.loadCropData=function(){var t=r(e().mark((function t(){var n=this;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){i.load(u.JSON_CROP_DATA,o,(function(e,a){if(e)return console.error("Failed to load CropsData:",e),void r(e);n.cropDataList=a.json.list,t()}))})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a.findCropDataById=function(t){return this.cropDataList.find((function(n){return n.id===t}))},a.findCropDataByName=function(t){return this.cropDataList.find((function(n){return n.name===t}))},a.filterCropDataByCropType=function(t){return this.cropDataList.filter((function(n){return n.crop_type===t}))},a.filterCropDataByFarmType=function(t){return this.cropDataList.filter((function(n){return n.farm_type===t}))},a.filterCropDataByMaxLevel=function(t){return this.cropDataList.filter((function(n){return parseInt(n.level_need)<=t}))},a.getAllCropData=function(){return[].concat(this.cropDataList)},a.getCropDataCount=function(){return this.cropDataList.length},a.isCropDataLoaded=function(){return this.cropDataList.length>0},n(t,null,[{key:"instance",get:function(){return null===this._instance&&(this._instance=new t),this._instance}}]),t}())._instance=null,a._RF.pop()}}}));

System.register("chunks:///_virtual/CurrencyDisplayBase.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,i,n,a,s,l,o,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,s=e._decorator,l=e.Node,o=e.Label,u=e.Component}],execute:function(){var c,p,y,h,f,v,b;a._RF.push({},"28242QeQPNNC7yrXEy5FX7l","CurrencyDisplayBase",void 0);var D=s.ccclass,g=s.property;e("CurrencyDisplayBase",(c=D("CurrencyDisplayBase"),p=g(l),y=g(o),c((v=t((f=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return t=e.call.apply(e,[this].concat(a))||this,i(t,"currencySpriteNode",v,n(t)),i(t,"lblCurrency",b,n(t)),t.playerState=null,t}r(t,e);var a=t.prototype;return a.initialize=function(e){this.playerState=e,this.setupEventListeners(),this.refreshDisplay()},a.setupEventListeners=function(){this.playerState&&this.playerState.eventTarget.on(this.eventName,this.refreshDisplay,this)},a.refreshDisplay=function(){this.playerState&&this.lblCurrency&&(this.lblCurrency.string=this.getCurrencyValue().toString())},a.onDestroy=function(){this.playerState&&this.playerState.eventTarget.off(this.eventName,this.refreshDisplay,this)},t}(u)).prototype,"currencySpriteNode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(f.prototype,"lblCurrency",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=f))||h));a._RF.pop()}}}));

System.register("chunks:///_virtual/DashFunManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NetworkManager.ts"],(function(e){var t,n,a,s,o,r,i,u,c,d;return{setters:[function(e){t=e.inheritsLoose,n=e.createClass,a=e.assertThisInitialized,s=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){r=e.cclegacy,i=e._decorator,u=e.EventTarget,c=e.Component},function(e){d=e.NetworkManager}],execute:function(){r._RF.push({},"2ad713z18ZPnpiQ1N7pmLwg","DashFunManager",void 0);i.ccclass,i.property,e("UserProfile",(function(){this.id=void 0,this.channelId=void 0,this.displayName=void 0,this.userName=void 0,this.avatarUrl=void 0,this.from=void 0,this.createData=void 0,this.loginTime=void 0})),e("PayItemType",function(e){return e[e.Coin=0]="Coin",e[e.Diamond=1]="Diamond",e}({}));var l=e("DashFunManager",function(e){function r(){var t;return(t=e.call(this)||this)._gameId="ForTest",t.eventTarget=new u,console.log("DashFunManager constructor"),window.addEventListener("message",t.onMessage.bind(a(t))),t}t(r,e);var i=r.prototype;return i.start=function(){},i.updateLoadingProgress=function(e){var t={dashfun:{method:"loading",payload:{value:e}}};console.log("updateLoadingProgress "+e),window.parent.postMessage(t,"*")},i.getUserProfile=function(){console.log("getUserProfile start...");window.parent.postMessage({dashfun:{method:"getUserProfile"}},"*")},i.requestPayment=function(e,t,n,a){console.log("requestPayment title: "+e+" , desc: "+t+" , type: "+n+" , price: "+a+" , ceshi");var s={dashfun:{method:"requestPayment",payload:{title:e,desc:t,info:n.toString(),price:a}}};window.parent.postMessage(s,"*")},i.openInvoice=function(e,t){console.log("openInvoice "+e+" , paymentId: "+t);var n={dashfun:{method:"openInvoice",payload:{invoiceLink:e,paymentId:t}}};window.parent.postMessage(n,"*")},i.onMessage=function(){var e=s(o().mark((function e(t){var n,a,s,i,u,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onMessage start ..."),n=t.data,a=n.dashfun){e.next=5;break}return e.abrupt("return");case 5:if(a.method==r.EVENT_GET_USER_PROFILE_RESULT&&this.eventTarget.emit(r.EVENT_GET_USER_PROFILE_RESULT,a.result.data),a.method==r.EVENT_REQUEST_PAYMENT_RESULT&&this.openInvoice(a.result.data.invoiceLink,a.result.data.paymentId),a.method!=r.EVENT_OPEN_INVOICE_RESULT){e.next=16;break}if(s=a.result.data,i=s.paymentId,u=s.status,console.log("openInvoiceResult paymentId: "+i+" , status: "+u),"paid"!=u){e.next=16;break}return e.next=13,d.instance.queryPaymentResult("ForTest",i);case 13:c=e.sent,console.log("queryPaymentResult result: "+JSON.stringify(c)),c.success&&(l=parseInt(c.data.type),this.eventTarget.emit(r.EVENT_OPEN_INVOICE_RESULT,c.success,l,Number(c.data.amount)));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n(r,null,[{key:"instance",get:function(){return null==this._instance&&(this._instance=new r),this._instance}}]),r}(c));l.EVENT_GET_USER_PROFILE_RESULT="getUserProfileResult",l.EVENT_REQUEST_PAYMENT_RESULT="requestPaymentResult",l.EVENT_OPEN_INVOICE_RESULT="openInvoiceResult",l._instance=null,r._RF.pop()}}}));

System.register("chunks:///_virtual/DateHelper.ts",["cc"],(function(e){var t,n;return{setters:[function(e){t=e.cclegacy,n=e._decorator}],execute:function(){t._RF.push({},"df561+Z03BHOLmXe1gUTP+I","DateHelper",void 0);n.ccclass,n.property,e("DateHelper",function(){function e(){}return e.stringToDate=function(e){if("string"!=typeof e)return console.error("Input is not a string",e),new Date;var t=new Date(e);return isNaN(t.getTime())?(console.error("Invalid date string",e),null):t},e.getElapsedTime=function(e){var t;if("string"==typeof e)t=this.stringToDate(e);else{if(!(e instanceof Date))return console.error("Invalid input type for getElapsedTime",e),null;t=e}return t?Date.now()-t.getTime():null},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/DiamondDataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts"],(function(n){var t,a,e,i,r,o,s;return{setters:[function(n){t=n.createClass,a=n.asyncToGenerator,e=n.regeneratorRuntime},function(n){i=n.cclegacy,r=n.resources,o=n.JsonAsset},function(n){s=n.SharedDefines}],execute:function(){i._RF.push({},"32b04ys+TdC9b5CX/Sf2x/A","DiamondDataManager",void 0),n("DiamondDataManager",function(){function n(){this.diamondDataList=[]}var i=n.prototype;return i.loadDiamondData=function(){var n=a(e().mark((function n(){var t=this;return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,a){r.load(s.JSON_DIAMOND_DATA,o,(function(e,i){if(e)return console.error("Failed to load DiamondData:",e),void a(e);t.diamondDataList=i.json.list,n()}))})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),i.getDiamondById=function(n){return this.diamondDataList.find((function(t){return t.id===n}))},i.getDiamondByPayMoney=function(n){return this.diamondDataList.find((function(t){return t.pay_money===n}))},i.getDiamondsByPayMoneyRange=function(n,t){return this.diamondDataList.filter((function(a){var e=parseInt(a.pay_money);return e>=n&&e<=t}))},i.getDiamondsByGetMoneyRange=function(n,t){return this.diamondDataList.filter((function(a){var e=parseInt(a.get_money);return e>=n&&e<=t}))},i.getAllDiamonds=function(){return[].concat(this.diamondDataList)},i.getDiamondCount=function(){return this.diamondDataList.length},i.isDiamondDataLoaded=function(){return this.diamondDataList.length>0},t(n,null,[{key:"instance",get:function(){return null===this._instance&&(this._instance=new n),this._instance}}]),n}())._instance=null,i._RF.pop()}}}));

System.register("chunks:///_virtual/DiamondDisplay.ts",["./rollupPluginModLoBabelHelpers.js","cc","./CurrencyDisplayBase.ts","./SharedDefines.ts"],(function(e){var n,t,a,r,i;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,a=e._decorator},function(e){r=e.CurrencyDisplayBase},function(e){i=e.SharedDefines}],execute:function(){var s;t._RF.push({},"c6775xWko9OV5lSJa7hhwcO","DiamondDisplay",void 0);var c=a.ccclass;e("DiamondDisplay",c("DiamondDisplay")(s=function(e){function t(){for(var n,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(n=e.call.apply(e,[this].concat(a))||this).eventName=i.EVENT_PLAYER_DIAMOND_CHANGE,n}return n(t,e),t.prototype.getCurrencyValue=function(){return this.playerState?this.playerState.diamond:0},t}(r))||s);t._RF.pop()}}}));

System.register("chunks:///_virtual/DragDropComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIHelper.ts"],(function(e){var n,t,o,r,i,a,s,g,c,u,d,l,h,p,D,v;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized,i=e.createForOfIteratorHelperLoose,a=e.createClass},function(e){s=e.cclegacy,g=e._decorator,c=e.Node,u=e.Camera,d=e.Vec2,l=e.Vec3,h=e.director,p=e.UITransform,D=e.Component},function(e){v=e.UIHelper}],execute:function(){var f,y,C,m,N,S,b;s._RF.push({},"b7f9djSAs1Kj5g9TyHf4RNh","DragDropComponent",void 0);var O=g.ccclass,P=g.property;e("DragDropComponent",(f=O("DragDropComponent"),y=P({type:c}),C=P({type:u}),f((S=n((N=function(e){function n(){for(var n,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i))||this,o(n,"dragContainer",S,r(n)),o(n,"camera",b,r(n)),n.uiCanvasNode=null,n.gameplayCanvasNode=null,n.currentDraggingObject=null,n.dropZones=[],n.isDragging=!1,n.deltaSizeBetweenGroundAndScreen=new d(0,0),n.currentMousePos=new d,n.startDragPosition=new l,n.originDragNodeLayer=0,n}t(n,e);var s=n.prototype;return s.onLoad=function(){if(this.gameplayCanvasNode=h.getScene().getChildByName("GameplayCanvas"),this.gameplayCanvasNode){var e=this.gameplayCanvasNode.getComponent(p).contentSize;if(this.uiCanvasNode=h.getScene().getChildByName("Canvas"),this.uiCanvasNode){var n=this.uiCanvasNode.getComponent(p).contentSize;this.deltaSizeBetweenGroundAndScreen=new d((e.x-n.x)/2,(e.y-n.y)/2)}else console.error("Canvas not found")}else console.error("GameplayCanvas not found")},s.start=function(){this.dragContainer=this.node,this.node.on(c.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(c.EventType.MOUSE_MOVE,this.onMouseMove,this)},s.update=function(){if(this.isDragging&&this.currentDraggingObject){var e=this.getMousePosition();this.currentDraggingObject.onDragging(e)}},s.registerDropZone=function(e){-1===this.dropZones.indexOf(e)&&this.dropZones.push(e)},s.unregisterDropZone=function(e){var n=this.dropZones.indexOf(e);-1!==n&&this.dropZones.splice(n,1)},s.startDragging=function(e,n){var t=this;if(this.currentDraggingObject=e,this.isDragging=!0,this.originDragNodeLayer=n.layer,e.onDragStart(),this.dragContainer&&n.parent!==this.dragContainer){n.layer=this.dragContainer.layer,n.walk((function(e){e.layer=t.dragContainer.layer}));var o=n.getWorldPosition();n.removeFromParent(),this.dragContainer.addChild(n),n.setWorldPosition(o),console.log("Dragging object "+n.name+" to drag container")}var r=this.getMousePosition();e.onDragging(r),this.startDragPosition=n.getWorldPosition()},s.onTouchStart=function(e){var n=this;if(this.isDragging&&this.currentDraggingObject){var t=this.currentDraggingObject.getNode().getWorldPosition(),o=v.convertPositionBetweenCanvas(t,this.uiCanvasNode,this.gameplayCanvasNode),r=new d(o.x,o.y);console.log("endPosition = "+r);for(var a,s=null,g=i(this.dropZones);!(a=g()).done;){var c=a.value;if(c.isPointInside(r)&&c.canAcceptDrop(this.currentDraggingObject)){s=c;break}}if(s){var u=s.getNode().getWorldPosition();console.log("acceptedDropZone = "+s.getNode().name);var h=this.currentDraggingObject.getNode();h.layer=this.originDragNodeLayer,h.walk((function(e){e.layer=n.originDragNodeLayer})),this.currentDraggingObject.onDragEnd(u,!1),s.onDrop(this.currentDraggingObject)}else this.currentDraggingObject.onDragEnd(this.startDragPosition,!0);this.currentDraggingObject=null,this.isDragging=!1,this.startDragPosition=new l}},s.onMouseMove=function(e){this.currentMousePos=e.getUILocation()},s.getMousePosition=function(){var e=this.currentMousePos;new l(e.x+this.deltaSizeBetweenGroundAndScreen.x,e.y+this.deltaSizeBetweenGroundAndScreen.y,0);return this.node.getComponent(p).convertToNodeSpaceAR(new l(e.x,e.y,0))},s.onDestroy=function(){this.node.off(c.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(c.EventType.MOUSE_MOVE,this.onMouseMove,this)},a(n,[{key:"IsDragging",get:function(){return this.isDragging}}]),n}(D)).prototype,"dragContainer",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=n(N.prototype,"camera",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=N))||m));s._RF.pop()}}}));

System.register("chunks:///_virtual/FarmFactoryWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WindowBase.ts","./SyntheDataManager.ts","./InventoryComponent.ts","./ResourceManager.ts","./SharedDefines.ts","./WindowManager.ts","./ItemDataManager.ts","./NetworkManager.ts","./l10n.ts","./l10n-manager.ts"],(function(e){var t,n,r,i,a,o,s,c,u,l,p,m,h,d,f,g,y,v,C,S,I,w,B,b,T;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e._decorator,u=e.Label,l=e.Node,p=e.Button,m=e.ScrollView,h=e.Sprite,d=e.instantiate,f=e.SpriteFrame},function(e){g=e.WindowBase},function(e){y=e.SyntheDataManager},function(e){v=e.InventoryItem},function(e){C=e.ResourceManager},function(e){S=e.SyntheState,I=e.SharedDefines},function(e){w=e.WindowManager},function(e){B=e.ItemDataManager},function(e){b=e.NetworkManager},null,function(e){T=e.default}],execute:function(){var x,N,k,D,F,_,E,M,R,P,W,A,V;s._RF.push({},"e923eotFYFCGJaRI2kBuj3e","FarmFactoryWindow",void 0);var L=c.ccclass,z=c.property;e("FarmFactoryWindow",(x=L("FarmFactoryWindow"),N=z(u),k=z(l),D=z(p),F=z(p),_=z(m),x((R=t((M=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,r(t,"lbTitle",R,i(t)),r(t,"itemTemplate",P,i(t)),r(t,"btnClose",W,i(t)),r(t,"btnUpgrade",A,i(t)),r(t,"scrollView",V,i(t)),t.currentBuilding=null,t.inventoryComponent=null,t}n(t,e);var s=t.prototype;return s.initialize=function(){e.prototype.initialize.call(this),this.btnClose.node.on(p.EventType.CLICK,this.onBtnCloseClick,this),this.btnUpgrade.node.on(p.EventType.CLICK,this.onBtnUpgradeClick,this),this.itemTemplate.active=!1,this.inventoryComponent=this.gameController.getPlayerController().inventoryComponent},s.show=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.prototype.show).call.apply(t,[this].concat(r)),this.currentBuilding=r[0],this.lbTitle.string=T.t(this.currentBuilding.BuildingData.description),console.log("FarmFactoryWindow show buildingId: "+this.currentBuilding.id),this.getSceneSyntheDataListFromServer(this.currentBuilding.SceneItem.id,this.currentBuilding.id)},s.getSceneSyntheDataListFromServer=function(){var e=a(o().mark((function e(t,n){var r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.instance.querySceneSyntheList(t);case 2:(r=e.sent)&&r.success&&(i=r.data,a=y.instance.filterSyntheDataByBuild(n),this.updateScrollView(i,a));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),s.updateScrollView=function(e,t){var n=this;console.log("updateScrollView: start..."),this.clearScrollViewContent(),this.scheduleOnce((function(){n.populateInProgressItems(e),n.populateAvailableItems(t,e)}),.1)},s.clearScrollViewContent=function(){var e=this;console.log("clearScrollViewContent: start...");var t=this.scrollView.content;t&&t.children.forEach((function(t){t!==e.itemTemplate&&t.destroy()}))},s.populateInProgressItems=function(e){var t=this;console.log("populateInProgressItems: start..."),e.forEach(a(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createInProgressItemNode(n);case 2:r=e.sent,t.scrollView.content.addChild(r);case 4:case"end":return e.stop()}}),e)}))))},s.createInProgressItemNode=function(){var e=a(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=d(this.itemTemplate)).active=!0,r=y.instance.findSyntheDataById(t.syntheid)){e.next=6;break}return console.error("Synthe data not found for id: "+t.syntheid),e.abrupt("return",n);case 6:return e.next=8,this.setupTargetItem(n,r);case 8:return this.setupSourceItems(n,r),this.setupInProgressStatus(n,t),this.setupItemButtons(n,r,t.state),e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.setupInProgressStatus=function(e,t){e.name=t.id;var n=e.getChildByName("txtRemainingTime").getComponent(u),r=e.getChildByName("btnSynthesisEnd").getComponent(p);n.node.active=!0;var i=new Date(t.endTime),a=Math.max(0,(i.getTime()-Date.now())/1e3);console.log("setupInProgressStatus:remainingTime:"+a),this.updateRemainingTime(n,r,a)},s.populateAvailableItems=function(e,t){var n=this,r=this.filterAvailableSyntheDatas(e,t);console.log("availableSyntheDatas:",r),r.forEach(a(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.createAvailableItemNode(t);case 2:r=e.sent,n.scrollView.content.addChild(r);case 4:case"end":return e.stop()}}),e)}))))},s.filterAvailableSyntheDatas=function(e,t){var n=new Set(t.map((function(e){return e.syntheid})));return e.filter((function(e){return!n.has(e.id)}))},s.createAvailableItemNode=function(){var e=a(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=d(this.itemTemplate)).active=!0,e.next=4,this.setupTargetItem(n,t);case 4:return this.setupSourceItems(n,t),this.setupItemButtons(n,t),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.setupTargetItem=function(){var e=a(o().mark((function e(t,n){var r,i,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getChildByName("sprTarget").getComponent(h),i=t.getChildByName("txtTargetName").getComponent(u),a=t.getChildByName("txtRemainingTime").getComponent(u),s=B.instance.getItemById(n.synthe_item_id),a.node.active=!1,e.next=7,this.loadTargetSprite(r,s);case 7:i.string=T.t(n.description);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),s.loadTargetSprite=function(){var e=a(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return console.error("sprTarget is null"),e.abrupt("return");case 3:return e.next=5,C.instance.loadAsset(""+I.WINDOW_SHOP_TEXTURES+n.png+"/spriteFrame",f);case 5:(r=e.sent)&&t&&(t.spriteFrame=r);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),s.setupSourceItems=function(e,t){var n=this,r=t.formula_1,i=t.quality,s=[e.getChildByName("source"),e.getChildByName("source2"),e.getChildByName("source3")],c=[e.getChildByName("sprPlus").getComponent(h),e.getChildByName("sprPlus2").getComponent(h)];if(r&&0!=r.length){r.forEach(a(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r<s.length)){e.next=5;break}return e.next=3,n.setSourceData(s[r],t,i[r]);case 3:s[r].active=!0,r>0&&r-1<c.length&&(c[r-1].node.active=!0);case 5:case"end":return e.stop()}}),e)}))));for(var u=r.length;u<s.length;u++)s[u].active=!1,u>0&&u-1<c.length&&(c[u-1].node.active=!1)}else console.error("formulas is null or empty")},s.setSourceData=function(){var e=a(o().mark((function e(t,n,r){var i,a,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.getChildByName("txtName").getComponent(u),a=t.getComponent(h)){e.next=5;break}return console.error("sourceSprite is null , sourceNode name: "+t.name),e.abrupt("return");case 5:return s=B.instance.getItemById(n),i.string=T.t(s.description)+"x"+r,e.next=9,C.instance.loadAsset(""+I.WINDOW_SHOP_TEXTURES+s.png+"/spriteFrame",f);case 9:(c=e.sent)&&a&&(a.spriteFrame=c);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),s.setupItemButtons=function(e,t,n){var r=this;void 0===n&&(n=S.None);var i=e.getChildByName("btnStart").getComponent(p),a=e.getChildByName("btnSynthesisEnd").getComponent(p),o=this.checkInventory(t);i.node.active=o&&n!=S.Complete,i.node.on(p.EventType.CLICK,(function(){r.onBtnStartClick(t,e)})),a.node.active=n==S.InProgress,a.node.on(p.EventType.CLICK,(function(){r.onBtnSynthesisEndClick(t,e)}))},s.checkInventory=function(e){var t=this.inventoryComponent.getAllItems();console.log("inventoryItems:",t);var n=e.formula_1,r=e.quality;return n.every((function(e,n){var i=t.find((function(t){return t.id===e}));return i&&i.quantity>=parseInt(r[n])}))},s.startSynthesisTimer=function(e,t,n,r){var i=this,a=e,o=function e(){if(a>0){a-=1;var o=Math.floor(a/60);t.string=""+o+""}else i.unschedule(e),r(),t.node.active=!1,n.node.active=!0};o(),this.schedule(o,60)},s.onBtnStartClick=function(){var e=a(o().mark((function e(t,n){var r,i,a,s,c,l=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Crafting "+t.name+" with formula "+t.formula_1+" , itemNode name: "+n.name),r=n.getChildByName("txtRemainingTime").getComponent(u),i=n.getChildByName("btnSynthesisEnd").getComponent(p),a=n.getChildByName("btnStart").getComponent(p),console.log("data.time_min:",t.time_min),this.updateRemainingTime(r,a,parseFloat(t.time_min)*I.TIME_MINUTE),a.node.active=!1,i.node.active=!1,r.node.active=!0,r.string=""+t.time_min+"",e.next=12,b.instance.syntheStart(t.id,this.currentBuilding.SceneItem.id);case 12:(s=e.sent)&&s.success?(console.log("Synthesis start success"),c=s.data,n.name=c.id,t.formula_1.forEach((function(e,t){var n=l.inventoryComponent.getItem(e);n&&l.inventoryComponent.removeItem(n.id)}))):console.log("Synthesis start failed");case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),s.onBtnSynthesisEndClick=function(){var e=a(o().mark((function e(t,n){var r,i,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Synthesis completed after "+t.time_min+" minutes"),e.next=3,b.instance.syntheEnd(this.currentBuilding.SceneItem.id,n.name);case 3:(r=e.sent)&&r.success?(console.log("Synthesis end success"),i=y.instance.findSyntheDataById(r.data.syntheid),a=B.instance.getItemById(i.synthe_item_id),s=new v(a,1),this.inventoryComponent.addItem(s),this.refreshData()):console.log("Synthesis end failed");case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),s.onBtnUpgradeClick=function(e){console.log("Upgrade button clicked")},s.onBtnCloseClick=function(e){w.instance.hide(I.WINDOW_FARM_FACTORY_NAME)},s.updateRemainingTime=function(e,t,n){var r=this,i=Math.floor(n/60);e.string=""+i+"",n>0?this.scheduleOnce((function(){r.updateRemainingTime(e,t,n-60)}),60):(e.node.active=!1,t.node.active=!0)},s.refreshData=function(){this.getSceneSyntheDataListFromServer(this.currentBuilding.SceneItem.id,this.currentBuilding.id)},t}(g)).prototype,"lbTitle",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(M.prototype,"itemTemplate",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(M.prototype,"btnClose",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(M.prototype,"btnUpgrade",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(M.prototype,"scrollView",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=M))||E));s._RF.pop()}}}));

System.register("chunks:///_virtual/FarmSelectionWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WindowBase.ts","./InventoryComponent.ts","./SharedDefines.ts","./ResourceManager.ts","./Fence.ts","./WindowManager.ts","./UIHelper.ts","./UIEffectHelper.ts","./CoinCollectionEffectComponent.ts"],(function(e){var t,n,i,o,r,a,l,s,c,d,h,p,u,C,m,f,g,y,b,v,T,N,I,w,S,O,A,E,x;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){l=e.cclegacy,s=e._decorator,c=e.Node,d=e.ScrollView,h=e.Button,p=e.Prefab,u=e.Sprite,C=e.UITransform,m=e.Vec3,f=e.instantiate,g=e.SpriteFrame},function(e){y=e.WindowBase},function(e){b=e.ItemType},function(e){v=e.FarmSelectionType,T=e.SharedDefines,N=e.CommandType,I=e.InteractionMode},function(e){w=e.ResourceManager},function(e){S=e.Fence},function(e){O=e.WindowManager},function(e){A=e.UIHelper},function(e){E=e.UIEffectHelper},function(e){x=e.CoinType}],execute:function(){var k,D,P,F,_,H,M,U,L,V,W,R,z,B,K,G,X,j,Y,q,J,Q,Z,$,ee,te,ne;l._RF.push({},"9d06emflENHBp2H9wlYuOUX","FarmSelectionWindow",void 0);var ie=s.ccclass,oe=s.property,re=function(e){return e[e.None=0]="None",e[e.Crop=1]="Crop",e[e.Animal=2]="Animal",e}(re||{}),ae=function(){function e(e,t,n,i){this.targetType=re.None,this.operation=N.None,this.dragNode=null,this.targetNode=null,this.targetType=e,this.operation=t,this.dragNode=n,this.targetNode=i}return e.prototype.reset=function(){this.targetType=re.None,this.operation=N.None,this.dragNode=null,this.targetNode=null},e}();e("FarmSelectionWindow",(k=ie("FarmSelectionWindow"),D=oe(c),P=oe(d),F=oe(c),_=oe(c),H=oe(h),M=oe(h),U=oe(h),L=oe(h),V=oe(h),W=oe(h),R=oe(p),z=oe(u),k((G=t((K=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,i(t,"selectionNode",G,o(t)),i(t,"scrollView",X,o(t)),i(t,"plotCommandNode",j,o(t)),i(t,"animalCommandNode",Y,o(t)),i(t,"btnCropCare",q,o(t)),i(t,"btnCropTreat",J,o(t)),i(t,"btnCropCleanse",Q,o(t)),i(t,"btnAnimalCare",Z,o(t)),i(t,"btnAnimalTreat",$,o(t)),i(t,"btnAnimalCleanse",ee,o(t)),i(t,"itemPrefab",te,o(t)),i(t,"operationSprite",ne,o(t)),t.clickLocation=null,t.currentSelectionType=v.NONE,t.currentSelectionNode=null,t.dragOperation=null,t.fence=null,t.playerController=null,t.inventoryComponent=null,t.callback=null,t.collectingDiamondRefCount=0,t.canHide=!0,t}n(t,e);var l=t.prototype;return l.initialize=function(){e.prototype.initialize.call(this),this.playerController=this.gameController.getPlayerController(),this.inventoryComponent=this.playerController.inventoryComponent,this.btnCropTreat.node.on(h.EventType.CLICK,this.onTreat,this),this.btnCropCleanse.node.on(h.EventType.CLICK,this.onCleanse,this),this.btnAnimalCare.node.on(h.EventType.CLICK,this.onCare,this),this.btnAnimalTreat.node.on(h.EventType.CLICK,this.onTreat,this),this.btnAnimalCleanse.node.on(h.EventType.CLICK,this.onCleanse,this)},l.show=function(){for(var t,n=this,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];if((t=e.prototype.show).call.apply(t,[this].concat(o)),0!==o.length){if(this.currentSelectionType=o[0],this.currentSelectionNode=o[1],this.clickLocation=o[2],this.callback=o[3],this.collectingDiamondRefCount=0,this.canHide=!0,this.operationSprite.node.active=!1,this.selectionNode.active=!0,this.updateSelectionNodePosition(),this.updateFarmSelectionViewVisibilityByType(this.currentSelectionType),this.currentSelectionType===v.PLOT){var a=this.getItemsByType(b.CROPSEED);console.log("crop seed count: "+a.length),this.updateScrollView(a)}else if(this.currentSelectionType===v.FENCE){this.fence=this.currentSelectionNode.getComponent(S);var l=this.getItemsByType(b.ANIMALCUB);console.log("animation count: "+l.length),this.updateScrollView(l)}this.scheduleOnce((function(){n.setupEventListeners()}),.5)}else console.log("FarmSelectionWindow: no arguments passed")},l.setupEventListeners=function(){this.playerController.inputComponent.eventTarget.on(T.EVENT_CLICK,this.onClick,this),this.playerController.inputComponent.eventTarget.on(T.EVENT_TOUCH_MOVE,this.onTouchMove,this),this.playerController.inputComponent.eventTarget.on(T.EVENT_TOUCH_END,this.onTouchEnd,this)},l.removeEventListeners=function(){this.playerController.inputComponent.eventTarget.off(T.EVENT_CLICK,this.onClick,this),this.playerController.inputComponent.eventTarget.off(T.EVENT_TOUCH_MOVE,this.onTouchMove,this),this.playerController.inputComponent.eventTarget.off(T.EVENT_TOUCH_END,this.onTouchEnd,this)},l.hide=function(){!this.canHide||this.collectingDiamondRefCount>0||(console.log("hide FarmSelectionWindow"),e.prototype.hide.call(this),this.callback=null,this.removeEventListeners())},l.updateSelectionNodePosition=function(){var e=this.gameController.UICanvas.getComponent(C),t=e.width,n=e.height,i=this.selectionNode.getComponent(C),o=i.width,r=i.height,a=t-this.clickLocation.x>=o?this.clickLocation.x+o/2:this.clickLocation.x-o/2,l=this.clickLocation.y-r/2,s=l+r/2;l-r/2<0?l=r/2:s>n&&(l=n-r/2),this.selectionNode.setWorldPosition(new m(a,l,0))},l.updateFarmSelectionViewVisibilityByType=function(e){console.log("updateFarmSelectionViewVisibilityByType: "+e),e===v.PLOT||e===v.FENCE?(this.scrollView.node.active=!0,this.plotCommandNode.active=!1,this.animalCommandNode.active=!1,console.log("Show scroll view")):e===v.PLOT_COMMAND?(this.scrollView.node.active=!1,this.plotCommandNode.active=!0,this.animalCommandNode.active=!1,console.log("Show plot command")):e===v.ANIMAL_COMMAND&&(this.scrollView.node.active=!1,this.plotCommandNode.active=!1,this.animalCommandNode.active=!0,console.log("Show animal command"))},l.onClick=function(e){if(console.log("FarmSelectionWindow: onClick"),this.selectionNode.activeInHierarchy){var t=e.getUILocation();this.btnCropCare.node.activeInHierarchy&&A.isPointInUINode(t,this.btnCropCare.node)||this.btnAnimalCare.node.activeInHierarchy&&A.isPointInUINode(t,this.btnAnimalCare.node)?this.onCare():this.btnCropTreat.node.activeInHierarchy&&A.isPointInUINode(t,this.btnCropTreat.node)||this.btnAnimalTreat.node.activeInHierarchy&&A.isPointInUINode(t,this.btnAnimalTreat.node)?this.onTreat():(this.btnCropCleanse.node.activeInHierarchy&&A.isPointInUINode(t,this.btnCropCleanse.node)||this.btnAnimalCleanse.node.activeInHierarchy&&A.isPointInUINode(t,this.btnAnimalCleanse.node))&&this.onCleanse()}},l.onTouchMove=function(e){var t=e.getUILocation();this.dragOperation?this.dragOperation&&this.dragOperation.dragNode&&this.dragOperation.operation!==N.None&&(this.dragOperation.dragNode.setWorldPosition(new m(t.x,t.y,0)),this.selectionNode.active&&(this.selectionNode.active=!1),this.dragOperation.targetType===re.Crop?this.handleCropDragOperation():this.dragOperation.targetType===re.Animal&&this.handleAnimalDragOperation()):this.initializeDragOperation(t)},l.onTouchEnd=function(e){console.log("FarmSelectionWindow: onTouchEnd"),this.playerController.interactionMode=I.CameraDrag,this.canHide=!0,this.hide(),this.dragOperation=null},l.updateScrollView=function(e){var t=this;if(this.scrollView&&this.itemPrefab){this.scrollView.content.removeAllChildren();Math.min(e.length,5);this.scrollView.vertical=e.length>1,e.forEach((function(e){return t.createItem(e.iconName,e)}))}},l.getItemsByType=function(e){var t,n=e;return(null==(t=this.inventoryComponent)?void 0:t.getAllItems().filter((function(e){return e.itemType===n.toString()})))||[]},l.createItem=function(e,t){var n=this;void 0===t&&(t=null);var i=f(this.itemPrefab),o=i.getComponent(u),r=i.getComponent(h);o&&w.instance.loadAsset(""+T.WINDOW_SHOP_TEXTURES+e+"/spriteFrame",g).then((function(e){e&&(o.spriteFrame=e)})),r&&r.node.on(h.EventType.CLICK,(function(){return n.onItemSelected(t)}),this),this.scrollView.content.addChild(i)},l.onCare=function(){var e=r(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("onCare"),this.onItemSelected(N.Care);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.onTreat=function(){console.log("onTreat"),this.onItemSelected(N.Treat)},l.onCleanse=function(){console.log("onCleanse"),this.onItemSelected(N.Cleanse)},l.initializeDragOperation=function(e){this.btnCropCare.node.activeInHierarchy&&A.isPointInUINode(e,this.btnCropCare.node)?(console.log("initializeDragOperation: Crop Care active = "+this.btnCropCare.node.activeInHierarchy),this.operationSprite.spriteFrame=this.btnCropCare.node.getComponent(u).spriteFrame,this.dragOperation=new ae(re.Crop,N.Care,null,null)):this.btnAnimalCare.node.activeInHierarchy&&A.isPointInUINode(e,this.btnAnimalCare.node)?(this.operationSprite.spriteFrame=this.btnAnimalCare.node.getComponent(u).spriteFrame,this.dragOperation=new ae(re.Animal,N.Care,null,null)):this.btnCropTreat.node.activeInHierarchy&&A.isPointInUINode(e,this.btnCropTreat.node)?(this.operationSprite.spriteFrame=this.btnCropTreat.node.getComponent(u).spriteFrame,this.dragOperation=new ae(re.Crop,N.Treat,null,null)):this.btnAnimalTreat.node.activeInHierarchy&&A.isPointInUINode(e,this.btnAnimalTreat.node)?(this.operationSprite.spriteFrame=this.btnAnimalTreat.node.getComponent(u).spriteFrame,this.dragOperation=new ae(re.Animal,N.Treat,null,null)):this.btnCropCleanse.node.activeInHierarchy&&A.isPointInUINode(e,this.btnCropCleanse.node)?(this.operationSprite.spriteFrame=this.btnCropCleanse.node.getComponent(u).spriteFrame,this.dragOperation=new ae(re.Crop,N.Cleanse,null,null)):this.btnAnimalCleanse.node.activeInHierarchy&&A.isPointInUINode(e,this.btnAnimalCleanse.node)&&(this.operationSprite.spriteFrame=this.btnAnimalCleanse.node.getComponent(u).spriteFrame,this.dragOperation=new ae(re.Animal,N.Cleanse,null,null)),this.dragOperation&&(this.canHide=!1,this.collectingDiamondRefCount=0,this.operationSprite.node.active=!0,this.dragOperation.dragNode=this.operationSprite.node,this.playerController.interactionMode=I.Command)},l.handleCropDragOperation=function(){for(var e=this.playerController.visitMode?this.gameController.FriendPlotTiles:this.gameController.PlayerPlotTiles,t=0;t<e.length;t++){var n=e[t];if(this.dragOperation.targetNode!==n.node&&A.isPointInUINodeWorldPosition(this.dragOperation.dragNode.worldPosition,n.node)){this.dragOperation.operation===N.Care?this.handleCarePlot(n):this.dragOperation.operation===N.Treat?this.handleTreatPlot(n):this.dragOperation.operation===N.Cleanse&&this.handleCleansePlot(n),this.dragOperation.targetNode=n.node;break}}},l.handleAnimalDragOperation=function(){for(var e=this.gameController.getAvailableFence().getAnimals(),t=0;t<e.length;t++){var n=e[t];this.dragOperation.targetNode!==n.node&&A.isPointInUINodeWorldPosition(this.dragOperation.dragNode.worldPosition,n.node)&&(this.dragOperation.operation===N.Care?this.handleCareAnimal(n):this.dragOperation.operation===N.Treat?this.handleTreatAnimal(n):this.dragOperation.operation===N.Cleanse&&this.handleCleanseAnimal(n),this.dragOperation.targetNode=n.node)}},l.handleCarePlot=function(){var e=r(a().mark((function e(t){var n,i,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleCare plot = "+t.node.name+" , occupied = "+t.isOccupied),t.isOccupied){e.next=3;break}return e.abrupt("return");case 3:if(!(n=t.OcuippedCrop)){e.next=20;break}if(!n.canCare()){e.next=19;break}if(i=null,!this.playerController.visitMode){e.next=13;break}return e.next=10,n.careByFriend(this.playerController.friendState.id);case 10:i=e.sent,e.next=16;break;case 13:return e.next=15,n.care();case 15:i=e.sent;case 16:i&&i.success&&(console.log("care result: "+i.success),i.data.friend_id&&(console.log("care friend , name = "+i.data.friend_id+" , friend_id = "+this.playerController.friendState.id+" , diamond_added = "+i.data.diamond_added),this.collectingDiamondRefCount++,this.playDiamondCollectionEffect(t.node,i.data.diamond_added,(function(){o.collectingDiamondRefCount--,o.hide()})))),e.next=20;break;case 19:console.log("Crop cannot care");case 20:this.hide();case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.handleTreatPlot=function(){var e=r(a().mark((function e(t){var n,i,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleTreat"),t.isOccupied){e.next=3;break}return e.abrupt("return");case 3:if(!(n=t.OcuippedCrop)){e.next=20;break}if(!n.canTreat()){e.next=19;break}if(i=null,!this.playerController.visitMode){e.next=13;break}return e.next=10,n.treatByFriend(this.playerController.friendState.id);case 10:i=e.sent,e.next=16;break;case 13:return e.next=15,n.treat();case 15:i=e.sent;case 16:i&&i.success&&(console.log("treat result: "+i.success),this.collectingDiamondRefCount++,this.playDiamondCollectionEffect(t.node,i.data.diamond_added,(function(){o.collectingDiamondRefCount--,o.hide()}))),e.next=20;break;case 19:console.log("Crop cannot treat");case 20:this.hide();case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.handleCleansePlot=function(){var e=r(a().mark((function e(t){var n,i,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleCleanse"),t.isOccupied){e.next=3;break}return e.abrupt("return");case 3:if(!(n=t.OcuippedCrop)){e.next=20;break}if(!n.canCleanse()){e.next=19;break}if(i=null,!this.playerController.visitMode){e.next=13;break}return e.next=10,n.cleanseByFriend(this.playerController.friendState.id);case 10:i=e.sent,e.next=16;break;case 13:return e.next=15,n.cleanse();case 15:i=e.sent;case 16:i&&i.success&&(console.log("cleanse result: "+i.success),this.collectingDiamondRefCount++,this.playDiamondCollectionEffect(t.node,i.data.diamond_added,(function(){o.collectingDiamondRefCount--,o.hide()}))),e.next=20;break;case 19:console.log("Crop cannot cleanse");case 20:this.hide();case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.handleCareAnimal=function(){var e=r(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.canCare()){e.next=12;break}if(n=null,!this.playerController.visitMode){e.next=8;break}return e.next=5,t.careByFriend(this.playerController.friendState.id);case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,t.care();case 10:n=e.sent;case 11:n&&n.success&&(console.log("care result: "+n.success),this.collectingDiamondRefCount++,this.playDiamondCollectionEffect(t.node,n.data.diamond_added,(function(){i.collectingDiamondRefCount--,i.hide()})));case 12:this.hide();case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.handleTreatAnimal=function(){var e=r(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleTreatAnimal"),!t.canTreat()){e.next=13;break}if(n=null,!this.playerController.visitMode){e.next=9;break}return e.next=6,t.treatByFriend(this.playerController.friendState.id);case 6:n=e.sent,e.next=12;break;case 9:return e.next=11,t.treat();case 11:n=e.sent;case 12:n&&n.success&&(console.log("treat result: "+n.success),this.collectingDiamondRefCount++,this.playDiamondCollectionEffect(t.node,n.data.diamond_added,(function(){i.collectingDiamondRefCount--,i.hide()})));case 13:this.hide();case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.handleCleanseAnimal=function(){var e=r(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleCleanseAnimal"),!t.canCleanse()){e.next=13;break}if(n=null,!this.playerController.visitMode){e.next=9;break}return e.next=6,t.cleanseByFriend(this.playerController.friendState.id);case 6:n=e.sent,e.next=12;break;case 9:return e.next=11,t.cleanse();case 11:n=e.sent;case 12:n&&n.success&&(console.log("cleanse result: "+n.success),this.collectingDiamondRefCount++,this.playDiamondCollectionEffect(t.node,n.data.diamond_added,(function(){i.collectingDiamondRefCount--,i.hide()})));case 13:this.hide();case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),l.onItemSelected=function(e){void 0===e&&(e=null),this.callback(e),O.instance.hide(T.WINDOW_SELECTION_NAME)},l.playDiamondCollectionEffect=function(){var e=r(a().mark((function e(t,n,i){var o,r,l,s,c=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=O.instance.getWindow(T.WINDOW_GAME_NAME),r=o.diamondDisplay){e.next=5;break}return console.error("diamondDisplay not found"),e.abrupt("return");case 5:return l=r.currencySpriteNode.getWorldPosition(),e.next=8,E.playCoinCollectionEffect(x.DIAMOND,this.node,t.getWorldPosition(),l);case 8:(s=e.sent).node.on("effectComplete",(function(){c.playerController.playerState.addDiamond(n),c.playerController.friendState.addDiamond(n),i()}),s.node);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),t}(y)).prototype,"selectionNode",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(K.prototype,"scrollView",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(K.prototype,"plotCommandNode",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(K.prototype,"animalCommandNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(K.prototype,"btnCropCare",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(K.prototype,"btnCropTreat",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(K.prototype,"btnCropCleanse",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(K.prototype,"btnAnimalCare",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(K.prototype,"btnAnimalTreat",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(K.prototype,"btnAnimalCleanse",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(K.prototype,"itemPrefab",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t(K.prototype,"operationSprite",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=K))||B));l._RF.pop()}}}));

System.register("chunks:///_virtual/Fence.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Animal.ts","./ResourceManager.ts","./SharedDefines.ts","./WindowManager.ts","./CooldownComponent.ts","./NetworkManager.ts","./SceneEntity.ts","./UIEffectHelper.ts","./CoinCollectionEffectComponent.ts","./GameController.ts","./UIHelper.ts"],(function(e){var n,t,o,a,i,r,s,c,l,d,u,f,p,m,h,C,g,v,y,A,_,S,E,w,I,x,D,T,N,P,b;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,a=e.assertThisInitialized,i=e.createForOfIteratorHelperLoose,r=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){c=e.cclegacy,l=e._decorator,d=e.EventTarget,u=e.Director,f=e.UITransform,p=e.Vec3,m=e.Vec2,h=e.PolygonCollider2D,C=e.PhysicsSystem2D,g=e.instantiate},function(e){v=e.Animal},function(e){y=e.ResourceManager},function(e){A=e.SharedDefines,_=e.FarmSelectionType,S=e.CommandType,E=e.SceneItemType},function(e){w=e.WindowManager},function(e){I=e.CooldownComponent},function(e){x=e.NetworkManager},function(e){D=e.SceneEntity},function(e){T=e.UIEffectHelper},function(e){N=e.CoinType},function(e){P=e.GameController},function(e){b=e.UIHelper}],execute:function(){var W,k,M;c._RF.push({},"92a59YTgbVKEZqE5e/5WAji","Fence",void 0);var O=l.ccclass,L=l.property;e("Fence",O("Fence")((M=n((k=function(e){function n(){for(var n,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(n=e.call.apply(e,[this].concat(i))||this).gameController=null,o(n,"capacity",M,a(n)),n.occupiedSpace=0,n.animals=[],n.dragDropComponent=null,n.cooldownComponent=null,n.playerController=null,n.eventTarget=new d,n}t(n,e);var c=n.prototype;return c.onLoad=function(){this.cooldownComponent=this.addComponent(I)},c.start=function(){this.gameController=u.instance.getScene().getComponentInChildren(P),this.playerController=this.gameController.getPlayerController(),this.playerController||console.error("Fence: PlayerController not found!")},c.initialize=function(e){this.init("fence",e)},c.getAvailableSpace=function(){return this.capacity-this.occupiedSpace},c.canAcceptAnimal=function(e){return!0},c.getAnimalAtPosition=function(e){for(var n,t=i(this.animals);!(n=t()).done;){var o=n.value,a=o.node,r=a.getComponent(f);if(r){this.node.getComponent(f).convertToWorldSpaceAR(a.position);var s=this.node.getComponent(f).convertToNodeSpaceAR(new p(e.x,e.y,0));if(r.getBoundingBox().contains(new m(s.x,s.y)))return o}}return null},c.tryAddAnimal=function(){var e=r(s().mark((function e(n,t){var o,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=p.ZERO),e.next=3,y.instance.loadPrefab(A.PREFAB_ANIMAL);case 3:return o=e.sent,(a=g(o)).name=n,(i=a.getComponent(v)).initialize(n),this.node.addChild(i.node),a.setWorldPosition(t),e.abrupt("return",this.addAnimal(i));case 11:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}(),c.addAnimal=function(e){return console.log("addAnimal",e),!!this.canAcceptAnimal(e)&&(console.log("addAnimal canAcceptAnimal",e),this.node.addChild(e.node),e.eventTarget.once(A.EVENT_ANIMAL_HARVEST,this.onAnimalHarvest,this),e.startGrowing(),this.animals.push(e),this.occupiedSpace+=1,!0)},c.findAnimalBySceneId=function(e){for(var n,t=i(this.animals);!(n=t()).done;){var o=n.value;if(o.SceneItem&&o.SceneItem.id==e)return o}return null},c.removeAnimal=function(e){var n=this.animals.indexOf(e);-1!==n&&(this.animals.splice(n,1),this.occupiedSpace-=1)},c.getAnimals=function(){return this.animals},c.isPointInside=function(e){if(this.node.getComponent(h)){var n=C.instance.testPoint(e);console.log("result = "+n);for(var t,o=!1,a=i(n);!(t=a()).done;){if(t.value.node==this.node){o=!0;break}}return o}return!1},c.select=function(e,n,t){if(!this.cooldownComponent.isOnCooldown("select")){for(var o,a=i(this.animals);!(o=a()).done;){var r=o.value,s=r.node,c=s.getComponent(f);if(c){var l=this.node.getComponent(f).convertToWorldSpaceAR(s.position),d=this.node.getComponent(f).convertToNodeSpaceAR(new p(n.x,n.y,0));if(console.log("Animal "+r.id+" worldPos: "+l+", localPos: "+d+",touchPos = "+n),c.getBoundingBox().contains(new m(d.x,d.y)))return console.log("Animal "+r.id+" is selected"),r.canHarvest()?void r.harvest():void w.instance.show(A.WINDOW_SELECTION_NAME,_.ANIMAL_COMMAND,s,n,this.onAnimalCommandSelected.bind(this,r))}}var u=this.gameController.UICanvas,h=this.gameController.GameplayCanvas,C=b.convertPositionBetweenCanvas(new p(n.x,n.y,0),h.node,u.node);this.dragDropComponent=e,w.instance.show(A.WINDOW_SELECTION_NAME,_.FENCE,this.node,C,this.onSelectionWindowItemClicked.bind(this))}},c.onAnimalCommandSelected=function(){var e=r(s().mark((function e(n,t){var o,a,i,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Animal command selected: "+t+" for animal "+n.node.name),this.cooldownComponent.startCooldown("select",A.COOLDOWN_SELECTION_TIME,(function(){})),!(o=n.SceneItem)){e.next=44;break}if(t!=S.Care){e.next=18;break}if(a=null,!this.playerController.visitMode){e.next=12;break}return e.next=9,x.instance.careFriend(o.id,this.playerController.friendState.id);case 9:a=e.sent,e.next=15;break;case 12:return e.next=14,x.instance.care(o.id);case 14:a=e.sent;case 15:a.success?(n.CareCount=a.data.care_count,a.data.friend_id&&(console.log("care friend , name = "+a.data.friend_id+" , friend_id = "+this.playerController.friendState.id+" , diamond_added = "+a.data.diamond_added),this.playDiamondCollectionEffect(a.data.diamond_added))):console.log("Care failed"),e.next=44;break;case 18:if(t!=S.Treat){e.next=32;break}if(i=null,!this.playerController.visitMode){e.next=26;break}return e.next=23,x.instance.treatFriend(o.id,this.playerController.friendState.id);case 23:i=e.sent,e.next=29;break;case 26:return e.next=28,x.instance.treat(o.id);case 28:i=e.sent;case 29:i.success?(n.TreatCount=i.data.treat_count,i.data.friend_id&&(console.log("treat friend , name = "+i.data.friend_id+" , friend_id = "+this.playerController.friendState.id+" , diamond_added = "+i.data.diamond_added),this.playDiamondCollectionEffect(i.data.diamond_added))):console.log("Treat failed"),e.next=44;break;case 32:if(t!=S.Cleanse){e.next=44;break}if(r=null,!this.playerController.visitMode){e.next=40;break}return e.next=37,x.instance.cleanseFriend(o.id,this.playerController.friendState.id);case 37:r=e.sent,e.next=43;break;case 40:return e.next=42,x.instance.cleanse(o.id);case 42:r=e.sent;case 43:r.success?(n.setImmunityDuration(r.data.cleanse_count,new Date),r.data.friend_id&&(console.log("cleanse friend , name = "+r.data.friend_id+" , friend_id = "+this.playerController.friendState.id+" , diamond_added = "+r.data.diamond_added),this.playDiamondCollectionEffect(r.data.diamond_added))):console.log("Cleanse failed");case 44:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}(),c.onSelectionWindowItemClicked=function(){var e=r(s().mark((function e(n){var t,o,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.instance.loadPrefab(A.PREFAB_ANIMAL);case 2:t=e.sent,(o=g(t)).name=n.detailId,(a=o.getComponent(v)).initializeWithInventoryItem(n),a.updateSprite(""+A.WINDOW_SHOP_TEXTURES+n.iconName),u.instance.getScene().getChildByPath(A.PATH_GAMEPLAY).addChild(a.node),this.dragDropComponent.startDragging(a,o);case 11:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),c.getNode=function(){return this.node},c.canAcceptDrop=function(e){return e instanceof v&&this.canAcceptAnimal(e)},c.onDrop=function(){var e=r(s().mark((function e(n){var t,o,a,i=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cooldownComponent.startCooldown("select",A.COOLDOWN_SELECTION_TIME,(function(){})),!(n instanceof v)){e.next=9;break}return o=(t=n).node.getWorldPosition(),a=b.convertPositionBetweenCanvas(o,this.gameController.UICanvas.node,this.gameController.GameplayCanvas.node),t.node.setWorldPosition(a),x.instance.eventTarget.once(x.EVENT_PLANT,(function(e){e.success?(i.playerController.inventoryComponent.removeItem(t.SourceInventoryItem.id,1),t.initializeWithSceneItem(e.data,!0),i.addAnimal(t)&&(t.node.setWorldPosition(a),i.eventTarget.emit(A.EVENT_FENCE_ANIMAL_ADDED,t))):console.log("animal plant failed , name = "+t.node.name)})),e.next=9,x.instance.plant(t.id,E.Animal,a.x,a.y,this.node.name);case 9:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),c.onAnimalHarvest=function(e){console.log("onAnimalHarvest",e),this.removeAnimal(e)},c.playDiamondCollectionEffect=function(){var e=r(s().mark((function e(n){var t,o,a,i,r=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=w.instance.getWindow(A.WINDOW_GAME_NAME),o=t.diamondDisplay){e.next=5;break}return console.error("diamondDisplay not found"),e.abrupt("return");case 5:return a=o.currencySpriteNode.getWorldPosition(),e.next=8,T.playCoinCollectionEffect(N.DIAMOND,this.node,this.node.getWorldPosition(),a);case 8:(i=e.sent).node.on("effectComplete",(function(){r.playerController.playerState.addDiamond(n),r.playerController.friendState.addDiamond(n)}),i.node);case 10:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),n}(D)).prototype,"capacity",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),W=k))||W);c._RF.pop()}}}));

System.register("chunks:///_virtual/GameController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PlotTile.ts","./PlayerController.ts","./SharedDefines.ts","./CropDataManager.ts","./ItemDataManager.ts","./BuildDataManager.ts","./AnimalDataManager.ts","./Fence.ts","./Animal.ts","./NetworkManager.ts","./ResourceManager.ts","./Crop.ts","./Building.ts","./InventoryComponent.ts","./PlayerState.ts","./SyntheDataManager.ts","./GradeDataManager.ts","./CoinDataManager.ts","./DiamondDataManager.ts"],(function(e){var n,t,r,i,a,o,l,s,c,u,p,f,d,m,h,g,y,C,v,b,w,P,T,x,S,I,k,D,G,E,_,M,z,V,F,L,N,A,B,O,R,U;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.createClass,o=e.asyncToGenerator,l=e.regeneratorRuntime,s=e.createForOfIteratorHelperLoose},function(e){c=e.cclegacy,u=e._decorator,p=e.Canvas,f=e.Prefab,d=e.Node,m=e.Vec2,h=e.EventTarget,g=e.instantiate,y=e.Component,C=e.UITransform,v=e.view,b=e.macro,w=e.Vec3,P=e.Layers},function(e){T=e.PlotTile},function(e){x=e.PlayerController},function(e){S=e.SharedDefines,I=e.SceneItemType},function(e){k=e.CropDataManager},function(e){D=e.ItemDataManager},function(e){G=e.BuildDataManager},function(e){E=e.AnimalDataManager},function(e){_=e.Fence},function(e){M=e.Animal},function(e){z=e.NetworkManager},function(e){V=e.ResourceManager},function(e){F=e.Crop},function(e){L=e.Building},function(e){N=e.InventoryItem},function(e){A=e.PlayerState},function(e){B=e.SyntheDataManager},function(e){O=e.GradeDataManager},function(e){R=e.CoinDataManager},function(e){U=e.DiamondDataManager}],execute:function(){var H,W,j,q,J,Y,K,Q,X,Z,$,ee,ne,te,re,ie,ae;c._RF.push({},"b80a938WxlPbKQiuamqojv9","GameController",void 0);var oe=u.ccclass,le=u.property;e("GameController",(H=oe("GameController"),W=le(p),j=le(p),q=le(f),J=le(d),Y=le(d),K=le(d),Q=le(z),H(($=n((Z=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,r(n,"gameplayCanvas",$,i(n)),r(n,"uiCanvas",ee,i(n)),r(n,"playerControllerPrefab",ne,i(n)),r(n,"gameplayContainer",te,i(n)),r(n,"friendGameplayContainer",re,i(n)),r(n,"buildingContainer",ie,i(n)),r(n,"networkManager",ae,i(n)),n.playerFence=null,n.friendFence=null,n.playerPlotTiles=[],n.friendPlotTiles=[],n.playerController=null,n.screenScale=new m(1,1),n.eventTarget=new h,n}t(n,e);var c=n.prototype;return c.onLoad=function(){this.setGameViewVisibility(!1),this.setFriendGameViewVisibility(!1),this.initializePlayerController(),this.setupEventListeners()},c.start=function(){var e=o(l().mark((function e(){var n,t,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("start start ..."),v.setOrientation(b.ORIENTATION_PORTRAIT),e.next=4,this.preloadJsonDatas();case 4:(n=this.gameplayCanvas.node.getComponent(C))&&n.setContentSize(1920,1080),t=this.gameplayCanvas.node.getComponent(C).contentSize,console.log("screenSize:"+t),r=v.getDesignResolutionSize(),this.screenScale.x=t.width/r.width,this.screenScale.y=t.height/r.height,console.log("screenScale:"+this.screenScale);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c.update=function(e){},c.onDestroy=function(){this.eventTarget.removeAll(this),this.networkManager.eventTarget.removeAll(this)},c.preloadJsonDatas=function(){var e=o(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.instance.loadCropData();case 2:return e.next=4,D.instance.loadItemData();case 4:return e.next=6,G.instance.loadBuildData();case 6:return e.next=8,E.instance.loadAnimalData();case 8:return e.next=10,B.instance.loadSyntheData();case 10:return e.next=12,O.instance.initialize();case 12:return e.next=14,R.instance.loadCoinData();case 14:return e.next=16,U.instance.loadDiamondData();case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.getPlayerController=function(){return this.playerController?this.playerController:(console.warn("playerController is not set in GameController"),null)},c.AddToGameplayContainer=function(e){this.playerController.visitMode?this.friendGameplayContainer.addChild(e):this.gameplayContainer.addChild(e)},c.setFriendGameViewVisibility=function(e){this.friendGameplayContainer?this.friendGameplayContainer.active=e:console.warn("friendGameplayContainer is not set in GameController")},c.setGameViewVisibility=function(e){this.gameplayContainer?this.gameplayContainer.active=e:console.warn("gameplayContainer is not set in GameController")},c.getAvailableFence=function(){return this.playerFence&&!this.playerController.visitMode?this.playerFence:this.friendFence&&this.playerController.visitMode?this.friendFence:null},c.startGame=function(){this.setGameViewVisibility(!0),this.setFriendGameViewVisibility(!1)},c.setupEventListeners=function(){console.log("setupEventListeners start ..."),this.networkManager.eventTarget.on(z.EVENT_GET_USER_SCENE_ITEMS,this.onGetUserSceneItems.bind(this)),this.networkManager.eventTarget.on(z.EVENT_HARVEST,this.onHarvest.bind(this)),console.log("setupEventListeners end ...")},c.initializePlayerController=function(){if(console.log("initializePlayerController start ..."),this.playerControllerPrefab){var e=g(this.playerControllerPrefab);this.node.addChild(e),this.playerController=e.getComponent(x)}else console.error("playerControllerPrefab is not set in GameController")},c.initializePlotTiles=function(e,n,t){var r=this;if(console.log("initializePlotTiles:"+e),n)for(var i=0;i<n.length;i++){var a=n[i];a&&(a.initialize(t),a.node.active=i<e,a.eventTarget.on(S.EVENT_PLOT_OCCUPIED,this.onPlotOccupied.bind(this)),a.eventTarget.on(S.EVENT_PLOT_SELECTED,(function(e){r.eventTarget.emit(S.EVENT_PLOT_SELECTED,e)}),this))}else console.error("plotTiles is not set in GameController")},c.resetPlotTiles=function(){if(this.friendPlotTiles)for(var e=0;e<this.friendPlotTiles.length;e++){var n=this.friendPlotTiles[e];n&&(n.clear(),n.eventTarget.off(S.EVENT_PLOT_OCCUPIED,this.onPlotOccupied))}},c.onPlotOccupied=function(e){var n;if(null==(n=this.playerController)?void 0:n.inventoryComponent){var t=e.OcuippedCrop;t?console.log("onPlotOccupied crop 2, name = "+t.node.name):console.error("crop is not set in GameController")}else console.error("inventoryComponent is not set in GameController")},c.findPlotTileBySceneId=function(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(r.OcuippedCrop&&r.OcuippedCrop.SceneItem&&r.OcuippedCrop.SceneItem.id===n)return r}return null},c.login=function(){var e=o(l().mark((function e(n,t){var r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!z.instance.SimulateNetwork){e.next=2;break}return e.abrupt("return");case 2:return console.log("login start ..."),e.next=5,z.instance.login(n,t);case 5:if(!(r=e.sent).success){e.next=11;break}return this.onLoginSuccess(r.user,r.sessionToken),e.next=10,z.instance.requestSceneItemsByUserId(n);case 10:return e.abrupt("return",r);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}(),c.onLoginSuccess=function(e,n){console.log("onLoginSuccess: userData:",e),this.playerController.playerState.initialize(e,n);var t=e.inventory_items;console.log("onLoginSuccess: networkInventoryItems:",t),this.playerController.inventoryComponent.initialize(t),console.log("onLoginSuccess end ... ")},c.onGetUserSceneItems=function(){var e=o(l().mark((function e(n){var t,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("get user scene items",n),n.success){e.next=4;break}return console.error("get user scene items failed"),e.abrupt("return");case 4:r=n.data,n.userid==(null==(t=this.playerController)?void 0:t.playerState.id)?this.initializeSceneItems(this.gameplayContainer,r,this.playerController.playerState.level,!0):this.initializeSceneItems(this.friendGameplayContainer,r,1,!1);case 6:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),c.initializeSceneItems=function(){var e=o(l().mark((function e(n,t,r,i){var a,o,c,u,p,f,d,h=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return console.error("initializeGameplayContainer"),e.abrupt("return");case 3:if(a=n.getChildByName("Buildings"),o=i?this.playerFence:this.friendFence){e.next=11;break}if(o=n.getComponentInChildren(_)){e.next=10;break}return console.error("fence is not set in GameController"),e.abrupt("return");case 10:i?this.playerFence=o:this.friendFence=o;case 11:if(o.initialize(i),(c=i?this.playerPlotTiles:this.friendPlotTiles)&&0!=c.length){e.next=19;break}if(c=n.getComponentsInChildren(T)){e.next=18;break}return console.error("plotTiles is not set in GameController"),e.abrupt("return");case 18:i?this.playerPlotTiles=c:this.friendPlotTiles=c;case 19:c.sort((function(e,n){return e.node.name.localeCompare(n.node.name)})),u=S.INIT_PLOT_NUM+r-1,console.log("plotNum:"+u),this.initializePlotTiles(u,c,i),p=l().mark((function e(){var n,t,r,s,u,p,f,g,y;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=d.value,p=null,f=null,console.log("item:id"+u.id),e.t0=u.type,e.next=e.t0===I.Crop?7:e.t0===I.Animal?15:e.t0===I.Building?20:25;break;case 7:if(g=null==(n=c)?void 0:n.find((function(e){return e.node.name===u.parent_node_name}))){e.next=10;break}return e.abrupt("return",1);case 10:return e.next=12,h.createCropNode(g,u,i);case 12:return p=e.sent,f=null==(t=p)?void 0:t.getComponent(F),e.abrupt("break",25);case 15:return e.next=17,h.createAnimalNode(o,u,i);case 17:return p=e.sent,f=null==(r=p)?void 0:r.getComponent(M),e.abrupt("break",25);case 20:return e.next=22,h.createBuildingNode(a,u);case 22:return p=e.sent,f=null==(s=p)?void 0:s.getComponent(L),e.abrupt("break",25);case 25:p&&f&&(y=new m(u.x,u.y),p.setWorldPosition(new w(y.x,y.y,0)));case 26:case"end":return e.stop()}}),e)})),f=s(t);case 25:if((d=f()).done){e.next=31;break}return e.delegateYield(p(),"t0",27);case 27:if(!e.t0){e.next=29;break}return e.abrupt("continue",29);case 29:e.next=25;break;case 31:case"end":return e.stop()}}),e,this)})));return function(n,t,r,i){return e.apply(this,arguments)}}(),c.createCropNode=function(){var e=o(l().mark((function e(n,t,r){var i,a,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Creating crop node for item "+t.id),k.instance.findCropDataById(t.item_id)){e.next=5;break}return console.log("Crop data not found for item "+t.id),e.abrupt("return",null);case 5:return console.log("Loading prefab for item "+t.id),e.next=8,V.instance.loadPrefab(S.PREFAB_CROP_CORN);case 8:if(i=e.sent){e.next=12;break}return console.log("Prefab not found for item "+t.id),e.abrupt("return",null);case 12:return a=g(i),(o=a.getComponent(F))&&(console.log("Initializing crop for item "+t.id),o.initializeWithSceneItem(t,r)),n?(console.log("Planting crop for item "+t.id),n.plant(o,!1)):console.error("Plot tile "+t.parent_node_name+" not found"),console.log("Finished creating crop node for item "+t.id),e.abrupt("return",a);case 18:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),c.createAnimalNode=function(){var e=o(l().mark((function e(n,t,r){var i,a,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Creating animal node for item "+t.id),E.instance.findAnimalDataById(t.item_id)){e.next=4;break}return e.abrupt("return",null);case 4:return console.log("Loading prefab for item "+t.id),e.next=7,V.instance.loadPrefab(S.PREFAB_ANIMAL);case 7:if(i=e.sent){e.next=10;break}return e.abrupt("return",null);case 10:return console.log("Instantiating prefab for item "+t.id),a=g(i),(o=a.getComponent(M))?(console.log("Initializing animal for item "+t.id),o.initializeWithSceneItem(t,r),n.addAnimal(o)):console.error("Animal component not found for item "+t.id),e.abrupt("return",a);case 15:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),c.createBuildingNode=function(){var e=o(l().mark((function e(n,t){var r,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(G.instance.findBuildDataById(t.item_id)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,V.instance.loadPrefab(S.PREFAB_PLACEMENT_BUILDING);case 5:if(r=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return i=g(r),null==n||n.addChild(i),i.setWorldPosition(new w(t.x,t.y,0)),i.layer=P.nameToLayer(S.LAYER_BUILDING_NAME)+1,(a=i.addComponent(L))&&a.initializeFromSceneItem(t),e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),c.onHarvest=function(e){console.log("harvest result",e);var n=e;if(n.success){var t=n.data;console.log("networkHarvestResultData",t),this.playerController.playerState.addExperience(t.exp_gained),this.playerController.playerState.level=t.new_level;var r=D.instance.getItemById(t.item_id);if(r){var i=new N(r,1);this.playerController.inventoryComponent.addItem(i)}}},c.visitFriend=function(){var e=o(l().mark((function e(n){var t,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.instance.visit(n);case 2:(t=e.sent)&&t.success?(console.log("visit result",t),this.playerController.visitMode=!0,r=new A(t.data.userId,t.data.level,t.data.exp,0,0),this.playerController.friendState=r,this.setFriendGameViewVisibility(!0),this.setGameViewVisibility(!1),this.initializeSceneItems(this.friendGameplayContainer,t.data.sceneItems,t.data.level,!1)):(console.error("visit friend failed"),this.setFriendGameViewVisibility(!1),this.setGameViewVisibility(!0),this.playerController.visitMode=!1,this.playerController.friendState=null);case 4:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),c.backToHome=function(){this.setFriendGameViewVisibility(!1),this.setGameViewVisibility(!0),this.playerController.visitMode=!1,this.playerController.friendState=null},a(n,[{key:"GameplayCanvas",get:function(){return this.gameplayCanvas}},{key:"UICanvas",get:function(){return this.uiCanvas}},{key:"PlayerPlotTiles",get:function(){return this.playerPlotTiles}},{key:"FriendPlotTiles",get:function(){return this.friendPlotTiles}},{key:"ScreenScale",get:function(){return this.screenScale}}]),n}(y)).prototype,"gameplayCanvas",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=n(Z.prototype,"uiCanvas",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=n(Z.prototype,"playerControllerPrefab",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=n(Z.prototype,"gameplayContainer",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=n(Z.prototype,"friendGameplayContainer",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=n(Z.prototype,"buildingContainer",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=n(Z.prototype,"networkManager",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=Z))||X));c._RF.pop()}}}));

System.register("chunks:///_virtual/GameEntry.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WindowManager.ts"],(function(n){var e,t,r,i,o,a,s;return{setters:[function(n){e=n.inheritsLoose,t=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){i=n.cclegacy,o=n._decorator,a=n.Component},function(n){s=n.WindowManager}],execute:function(){var c;i._RF.push({},"89580Z1QMpPAp5GZCRAZYVa","GameEntry",void 0);var u=o.ccclass;o.property,n("GameEntry",u("GameEntry")(c=function(n){function i(){return n.apply(this,arguments)||this}e(i,n);var o=i.prototype;return o.start=function(){this.initializeManagers(),this.showMainWindow()},o.initializeManagers=function(){s.instance.initialize()},o.showMainWindow=function(){var n=t(r().mark((function n(){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,s.instance.show("MainWindow");case 3:console.log("MainWindow shown successfully"),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),console.error("Failed to show MainWindow:",n.t0);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(){return n.apply(this,arguments)}}(),i}(a))||c);i._RF.pop()}}}));

System.register("chunks:///_virtual/GameWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourceManager.ts","./SharedDefines.ts","./WindowBase.ts","./CropDataManager.ts","./SpriteHelper.ts","./WindowManager.ts","./CoinDisplay.ts","./DiamondDisplay.ts","./NetworkManager.ts","./GradeDataManager.ts"],(function(e){var t,n,r,i,o,l,a,s,p,c,u,d,h,f,C,y,b,m,v,g,E,B,S,w,D,T,_,A,L;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,o=e.asyncToGenerator,l=e.regeneratorRuntime},function(e){a=e.cclegacy,s=e._decorator,p=e.Label,c=e.ProgressBar,u=e.ScrollView,d=e.Node,h=e.Button,f=e.Sprite,C=e.Color,y=e.Layout,b=e.instantiate,m=e.SpriteFrame,v=e.Widget},function(e){g=e.ResourceManager},function(e){E=e.SharedDefines},function(e){B=e.WindowBase},function(e){S=e.CropDataManager},function(e){w=e.SpriteHelper},function(e){D=e.WindowManager},function(e){T=e.CoinDisplay},function(e){_=e.DiamondDisplay},function(e){A=e.NetworkManager},function(e){L=e.GradeDataManager}],execute:function(){var N,I,P,V,k,F,z,W,G,M,x,R,H,U,O,Y,K,X,j,Q,q,J,Z,$,ee,te,ne,re,ie,oe,le,ae,se,pe,ce,ue,de;a._RF.push({},"a28dabuEQNE9pj7Yu7oGB3z","GameWindow",void 0);var he=s.ccclass,fe=s.property;e("GameWindow",(N=he("GameWindow"),I=fe(p),P=fe(p),V=fe(p),k=fe(c),F=fe(T),z=fe(_),W=fe(u),G=fe(d),M=fe(d),x=fe(u),R=fe(d),H=fe(h),U=fe(h),O=fe(h),Y=fe(h),K=fe(h),X=fe(h),N((q=t((Q=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return t=e.call.apply(e,[this].concat(o))||this,r(t,"lbUserName",q,i(t)),r(t,"lbProsperity",J,i(t)),r(t,"lblLevel",Z,i(t)),r(t,"progressExp",$,i(t)),r(t,"coinDisplay",ee,i(t)),r(t,"diamondDisplay",te,i(t)),r(t,"scrollViewCrops",ne,i(t)),r(t,"cropContainer",re,i(t)),r(t,"cropButtonTemplate",ie,i(t)),r(t,"friendScrollView",oe,i(t)),r(t,"friendButtonTemplate",le,i(t)),r(t,"btnAddCoin",ae,i(t)),r(t,"btnAddDiamond",se,i(t)),r(t,"btnCraft",pe,i(t)),r(t,"btnShop",ce,i(t)),r(t,"btnFriend",ue,i(t)),r(t,"btnBack",de,i(t)),t.cropButtons=[],t.playerController=null,t.currentSelectedPlot=null,t}n(t,e);var a=t.prototype;return a.initialize=function(){var t;(e.prototype.initialize.call(this),this.gameController)&&(this.playerController=null==(t=this.gameController)?void 0:t.getPlayerController(),this.coinDisplay&&this.coinDisplay.initialize(this.playerController.playerState),this.diamondDisplay&&this.diamondDisplay.initialize(this.playerController.playerState));this.gameController.eventTarget.on(E.EVENT_PLOT_SELECTED,this.onPlotSelected,this),this.setupEventLisnters(),this.initializeCropButtons()},a.show=function(){for(var t,n,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(t=e.prototype.show).call.apply(t,[this].concat(i)),this.scrollViewCrops.node.active=!1,this.friendScrollView.node.active=!1,null==(n=this.gameController)||n.startGame(),this.coinDisplay&&this.coinDisplay.refreshDisplay(),this.diamondDisplay&&this.diamondDisplay.refreshDisplay(),this.refreshBasePlayerStateInfo(),this.updateButtonsVisibility(),this.updateRecommendedFriends()},a.hide=function(){e.prototype.hide.call(this)},a.onDestroy=function(){var t;if(e.prototype.onDestroy.call(this),this.playerController){this.playerController.eventTarget.off(E.EVENT_VISIT_MODE_CHANGE,this.updateButtonsVisibility,this);var n=this.playerController.playerState;n.eventTarget.off(E.EVENT_PLAYER_LEVEL_UP,this.onPlayerLeveUp,this),n.eventTarget.off(E.EVENT_PLAYER_EXP_CHANGE,this.refreshBasePlayerStateInfo,this)}var r=null==(t=this.friendScrollView)?void 0:t.content;r&&r.children.forEach((function(e){var t=e.getComponent(h);t&&t.node.off(h.EventType.CLICK)})),this.btnCraft&&this.btnCraft.node.off(h.EventType.CLICK,this.onBtnCraftClicked,this)},a.setupEventLisnters=function(){if(this.playerController){this.playerController.eventTarget.on(E.EVENT_VISIT_MODE_CHANGE,this.updateButtonsVisibility,this);var e=this.playerController.playerState;e.eventTarget.on(E.EVENT_PLAYER_LEVEL_UP,this.onPlayerLeveUp,this),e.eventTarget.on(E.EVENT_PLAYER_EXP_CHANGE,this.refreshBasePlayerStateInfo,this),e.eventTarget.on(E.EVENT_PLAYER_GOLD_CHANGE,this.refreshBasePlayerStateInfo,this),e.eventTarget.on(E.EVENT_PLAYER_DIAMOND_CHANGE,this.refreshBasePlayerStateInfo,this)}this.btnAddCoin&&this.btnAddCoin.node.on(h.EventType.CLICK,this.onBtnAddCoinClicked,this),this.btnAddDiamond&&this.btnAddDiamond.node.on(h.EventType.CLICK,this.onBtnAddDiamondClicked,this),this.btnCraft&&this.btnCraft.node.on(h.EventType.CLICK,this.onBtnCraftClicked,this),this.btnShop&&this.btnShop.node.on(h.EventType.CLICK,this.onBtnShopClicked,this),this.btnFriend&&this.btnFriend.node.on(h.EventType.CLICK,this.onBtnFriendClicked,this),this.btnBack&&this.btnBack.node.on(h.EventType.CLICK,this.onBtnBackClicked,this)},a.updateButtonsVisibility=function(){var e,t,n=null!=(e=null==(t=this.gameController)?void 0:t.getPlayerController().visitMode)&&e;console.log("updateButtonsVisibility "+n),this.btnFriend.enabled=!n,this.btnShop.enabled=!n,this.btnCraft.enabled=!n,this.btnBack.node.active=n,n?(w.setSpriteColor(this.btnShop.getComponent(f),C.GRAY),w.setSpriteColor(this.btnCraft.getComponent(f),C.GRAY),w.setSpriteColor(this.btnFriend.getComponent(f),C.GRAY)):(w.setSpriteColor(this.btnShop.getComponent(f),C.WHITE),w.setSpriteColor(this.btnCraft.getComponent(f),C.WHITE),w.setSpriteColor(this.btnFriend.getComponent(f),C.WHITE))},a.onPlayerLeveUp=function(){this.refreshBasePlayerStateInfo()},a.initializeCropButtons=function(){var e,t=this;if(this.cropButtonTemplate&&this.scrollViewCrops){for(var n=0;n<this.cropButtons.length;++n)this.cropButtons[n].destroy(),this.cropButtons[n]=null;this.cropButtons=[];for(var r=S.instance.getAllCropData(),i=(null==(e=this.playerController)?void 0:e.playerState.level)||1,o=-1,l=this.scrollViewCrops.content,a=function(){var e=r[s],n=parseInt(e.crop_type);if(-1!==o&&n===o)return 1;o=parseInt(e.crop_type);var a=b(t.cropButtonTemplate);if(a.name=e.id,a.active=parseInt(e.level_need)<=i,l.addChild(a),""!==e.icon){var p=a.getComponent(f);g.instance.loadAsset(""+E.WINDOW_GAME_TEXTURES+e.icon+"/spriteFrame",m).then((function(e){e&&(p.spriteFrame=e)}))}a.on(h.EventType.CLICK,(function(){return t.onCropButtonClicked(parseInt(e.crop_type))}),t),t.cropButtons.push(a)},s=0;s<r.length;++s)a();var p=l.getComponent(y);p&&p.updateLayout()}else console.error("Crop button template or scroll view content is not set")},a.refreshBasePlayerStateInfo=function(){if(this.gameController&&null!==this.playerController){var e=this.playerController.playerState;if(console.log("refreshBasePlayerStateInfo: level: "+e.level),this.lbUserName&&(this.lbUserName.string=e.nickname),this.lbProsperity&&(console.log("playerState.prosperity: "+e.prosperity),this.lbProsperity.string=e.prosperity.toString()),this.lblLevel&&(this.lblLevel.string=e.level.toString()),this.progressExp){var t=e.experience;console.log("currentExp: "+t);var n=this.getExpNeededForNextLevel(e.level);this.progressExp.progress=t/n}this.coinDisplay&&this.coinDisplay.refreshDisplay(),this.diamondDisplay&&this.diamondDisplay.refreshDisplay()}else console.error("GameController or playerController is not set")},a.getExpNeededForNextLevel=function(e){return L.instance.getExpNeededForLevel(e+1)},a.onCropButtonClicked=function(){var e=o(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("onCropButtonClicked: "+t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onPlotSelected=function(e){e.isOccupied||(this.scrollViewCrops.node.active=!0,this.currentSelectedPlot=e)},a.onBtnAddCoinClicked=function(){D.instance.show(E.WINDOW_COIN_NAME)},a.onBtnAddDiamondClicked=function(){D.instance.show(E.WINDOW_PAYMENT_NAME)},a.onBtnCraftClicked=function(){D.instance.show(E.WINDOW_CRAFT_NAME)},a.onBtnShopClicked=function(){D.instance.show(E.WINDOW_SHOP_NAME)},a.onBtnFriendClicked=function(){var e=o(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.friendScrollView.node.active=!this.friendScrollView.node.active,console.log("onBtnFriendClicked"),(t=this.friendScrollView.content.getComponent(v))&&t.updateAlignment();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.onBtnBackClicked=function(){var e;null==(e=this.gameController)||e.backToHome()},a.updateRecommendedFriends=function(){var e=o(l().mark((function e(){var t,n,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.friendScrollView&&this.friendButtonTemplate){e.next=3;break}return console.error("Friend ScrollView or button template is not set"),e.abrupt("return");case 3:if(n=null==(t=this.playerController)?void 0:t.playerState.id){e.next=7;break}return console.error("User ID is not available"),e.abrupt("return");case 7:return e.next=9,A.instance.recommendFriends(n,5);case 9:(r=e.sent)&&r.success?(console.log(r.data),this.populateFriendScrollView(r.data)):console.error("Failed to get recommended friends");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.populateFriendScrollView=function(e){var t=this,n=this.friendScrollView.content;n.children.forEach((function(e){e!==t.friendButtonTemplate&&e.destroy()})),e.forEach((function(e){var r=b(t.friendButtonTemplate);if(r.active=!0,n.addChild(r),r.name=e.id,e.avatarUrl){var i=r.getComponent(f);i&&e.avatarUrl&&g.instance.loadAsset(e.avatarUrl,m).then((function(e){e&&(i.spriteFrame=e)}))}var o=r.getComponent(h);o&&o.node.on(h.EventType.CLICK,(function(){return t.onFriendButtonClicked(e.id)}),t)}));var r=n.getComponent(y);r&&r.updateLayout()},a.onFriendButtonClicked=function(e){var t;null==(t=this.gameController)||t.visitFriend(e)},t}(B)).prototype,"lbUserName",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(Q.prototype,"lbProsperity",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(Q.prototype,"lblLevel",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(Q.prototype,"progressExp",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(Q.prototype,"coinDisplay",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(Q.prototype,"diamondDisplay",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t(Q.prototype,"scrollViewCrops",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=t(Q.prototype,"cropContainer",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=t(Q.prototype,"cropButtonTemplate",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=t(Q.prototype,"friendScrollView",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=t(Q.prototype,"friendButtonTemplate",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=t(Q.prototype,"btnAddCoin",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=t(Q.prototype,"btnAddDiamond",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=t(Q.prototype,"btnCraft",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=t(Q.prototype,"btnShop",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=t(Q.prototype,"btnFriend",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=t(Q.prototype,"btnBack",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=Q))||j));a._RF.pop()}}}));

System.register("chunks:///_virtual/GradeDataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourceManager.ts","./SharedDefines.ts"],(function(e){var n,t,a,r,s,i,c;return{setters:[function(e){n=e.createClass,t=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){r=e.cclegacy,s=e.JsonAsset},function(e){i=e.ResourceManager},function(e){c=e.SharedDefines}],execute:function(){r._RF.push({},"5f8d3+tVIFA4KcRsTNRgAV4","GradeDataManager",void 0),e("GradeDataManager",function(){function e(){this.gradeDataMap=new Map}var r=e.prototype;return r.initialize=function(){var e=t(a().mark((function e(){var n,t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.instance.loadAsset(c.JSON_GRADE_DATA,s);case 2:(n=e.sent)&&n.json&&n.json.list.forEach((function(e){t.gradeDataMap.set(e.level,e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r.getGradeData=function(e){return this.gradeDataMap.get(e)},r.getExpNeededForLevel=function(e){var n=this.getGradeData(e);return n?n.exp_need:0},n(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}())._instance=void 0,r._RF.pop()}}}));

System.register("chunks:///_virtual/GrowthableEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts","./CooldownComponent.ts","./ResourceManager.ts","./NetworkManager.ts","./DateHelper.ts","./SceneEntity.ts"],(function(t){var e,i,n,s,r,o,a,u,h,c,l,d,p,m,g,w,S,f,C,I,T,v,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,s=t.assertThisInitialized,r=t.createClass,o=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){u=t.cclegacy,h=t._decorator,c=t.Sprite,l=t.SpriteFrame,d=t.EventTarget,p=t.Node},function(t){m=t.GrowState,g=t.CommandType,w=t.CommandState,S=t.SceneItemState,f=t.SharedDefines},function(t){C=t.CooldownComponent},function(t){I=t.ResourceManager},function(t){T=t.NetworkManager},function(t){v=t.DateHelper},function(t){y=t.SceneEntity}],execute:function(){var b,G,D,k,x,_,E,N,P,R,F,z,O,M,U,A,q,L,H;u._RF.push({},"e2fa9bXJkVDdKpGexxIuq5a","GrowthableEntity",void 0);var W=h.ccclass,V=h.property;t("GrowthableEntity",(b=W("GrowthableEntity"),G=V(c),D=V(c),k=V(l),b(((H=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,n(e,"id",E,s(e)),n(e,"description",N,s(e)),n(e,"farmType",P,s(e)),n(e,"timeMin",R,s(e)),n(e,"growthTime",F,s(e)),n(e,"levelNeed",z,s(e)),n(e,"sprite",O,s(e)),n(e,"sickSprite",M,s(e)),n(e,"deadSpriteFrame",U,s(e)),e.growthStages=[],e.currentGrowthStageIndex=0,e.sourceInventoryItem=null,e.cooldownComponent=null,e.growState=m.NONE,e.harvestItemId="",e.baseSpritePath="",e.eventTarget=new d,e.sceneItem=null,e.totalGrowthTime=0,e.growthStartTime=0,e.isSick=!1,n(e,"careCount",A,s(e)),e.careCooldown=0,e.lastCareTime=0,n(e,"treatCount",q,s(e)),e.treatCooldown=0,e.lastTreatTime=0,n(e,"cleanseCount",L,s(e)),e.cleanseCooldown=0,e.lastCleanseTime=0,e}i(e,t);var u=e.prototype;return u.onLoad=function(){this.cooldownComponent=this.getComponent(C),this.cooldownComponent||(this.cooldownComponent=this.addComponent(C))},u.initializeWithInventoryItem=function(t){this.sickSprite.node.active=!1,this.sourceInventoryItem=t,this.init(t.detailId,!0),this.initialize(t.detailId)},u.initializeWithSceneItem=function(t,e){if(console.log("initializeWithSceneItem , id = "+t.id),this.init(t.id,e),this.sceneItem=t,this.growState=m.NONE,this.isPlayerOwner=e,this.loadEntityData(t.item_id),this.growthStages.length>0)if(this.setupDataFromSceneItem(t),console.log("current growth stage index: "+this.currentGrowthStageIndex),this.updateSprite(""+this.baseSpritePath+this.growthStages[this.currentGrowthStageIndex].png),this.isPlayerOwner){var i=v.stringToDate(t.last_updated_time)||new Date;if(t.commands){var n=t.commands.find((function(t){return t.type===g.Disease}));n&&(i=v.stringToDate(n.last_updated_time))}this.scheduleDiseaseStatusUpdate(i)}else{var s=t.commands.find((function(t){return t.type===g.Disease}));s?(this.isSick=s.state===w.InProgress&&1==s.count,console.log("Entity "+this.id+" has become sick"),this.updateEntityState()):this.isSick=!1}else console.error("No growth stages found for entity with id: "+t.item_id)},u.setupDataFromSceneItem=function(t){var e,i,n;this.id=t.item_id,this.careCount=t.commands&&(null==(e=t.commands.find((function(t){return t.type===g.Care})))?void 0:e.count)||0,this.treatCount=t.commands&&(null==(i=t.commands.find((function(t){return t.type===g.Treat})))?void 0:i.count)||0,this.cleanseCount=t.commands&&(null==(n=t.commands.find((function(t){return t.type===g.Cleanse})))?void 0:n.count)||0,console.log("careCount = "+this.careCount+" , treatCount = "+this.treatCount+" , cleanseCount = "+this.cleanseCount),this.updateTotalGrowthTime(),this.growthStartTime=v.stringToDate(t.last_updated_time).getTime()/1e3;var s=this.calculateRemainingTime();this.currentGrowthStageIndex=this.calculateCurrentStage(s),this.setupData(this.growthStages[this.currentGrowthStageIndex]),this.growthTime=s,console.log("growth time: "+this.growthTime),t.state===S.Dead?this.setDeadState():this.updateSickState()},u.updateTotalGrowthTime=function(){var t=this.growthStages.reduce((function(t,e){return t+parseFloat(e.time_min)*f.TIME_MINUTE}),0),e=f.CARE_TIME_RATIO_REDUCE*this.careCount,i=f.TREAT_TIME_RATIO_REDUCE*this.treatCount;this.totalGrowthTime=t*(1-(e+i)),console.log("[GrowthableEntity:updateTotalGrowthTime] totalGrowthTime = "+this.totalGrowthTime)},u.calculateRemainingTime=function(){var t=Date.now()/1e3-this.growthStartTime;return Math.max(0,this.totalGrowthTime-t)},u.calculateCurrentStage=function(t){var e=this.totalGrowthTime-t,i=0,n=0;if(e>=this.totalGrowthTime)n=this.growthStages.length-1;else for(var s=0;s<this.growthStages.length;s++)e>=(i+=parseFloat(this.growthStages[s].time_min)*f.TIME_MINUTE)&&(n=s);return n},u.updateSprite=function(){var t=o(a().mark((function t(e){var i,n=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.sprite){t.next=6;break}if((null==(i=this.sceneItem)?void 0:i.state)!==S.Dead){t.next=5;break}this.sprite.spriteFrame=this.deadSpriteFrame,t.next=6;break;case 5:return t.abrupt("return",I.instance.loadAsset(e+"/spriteFrame",l).then((function(t){t&&(n.sprite.spriteFrame=t)})));case 6:return t.abrupt("return",Promise.resolve());case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),u.startGrowing=function(){console.log("start growing "),this.sceneItem?this.sceneItem.state===S.Complete?this.onGrowthComplete():this.sceneItem.state===S.InProgress&&this.continueGrowing(this.sceneItem):(this.growState=m.GROWING,this.updateSprite(""+this.baseSpritePath+this.growthStages[this.currentGrowthStageIndex].png),this.requestNextGrowth())},u.continueGrowing=function(t){this.growState=m.GROWING,this.updateSprite(""+this.baseSpritePath+this.growthStages[this.currentGrowthStageIndex].png),this.scheduleNextGrowth()},u.scheduleNextGrowth=function(){var t=this;this.isGrowEnd()?this.onGrowthComplete():this.CooldownComponent.startCooldown("growth",this.growthTime,(function(){return t.grow()}))},u.requestNextGrowth=function(){var t=o(a().mark((function t(){var e,i,n,s,r=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("request next growth "),t.prev=1,t.next=4,this.getLatestCommandDuration();case 4:null!==(e=t.sent)&&this.updateGrowthTimes(e),this.updateTotalGrowthTime(),i=this.calculateRemainingTime(),console.log("remainingTime = "+i),i<=0&&this.isGrowEnd()?this.onGrowthComplete():null==(n=this.cooldownComponent)||n.startCooldown("growth",i,(function(){return r.grow()})),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.error("Failed to get latest command duration:",t.t0),null==(s=this.cooldownComponent)||s.startCooldown("growth",this.calculateRemainingTime(),(function(){return r.grow()}));case 16:case"end":return t.stop()}}),t,this,[[1,12]])})));return function(){return t.apply(this,arguments)}}(),u.updateGrowthTimes=function(t){var e=this.calculateRemainingTime();this.currentGrowthStageIndex=this.calculateCurrentStage(e),this.currentGrowthStageIndex>=this.growthStages.length&&(this.currentGrowthStageIndex=this.growthStages.length-1),this.setupData(this.growthStages[this.currentGrowthStageIndex]);var i=""+this.baseSpritePath+this.growthStages[this.currentGrowthStageIndex].png;this.updateSprite(i)},u.grow=function(){this.currentGrowthStageIndex++,this.setupData(this.growthStages[this.currentGrowthStageIndex]),this.updateSprite(""+this.baseSpritePath+this.growthStages[this.currentGrowthStageIndex].png),this.requestNextGrowth()},u.onGrowthComplete=function(){console.log("growth complete , current growth stage index: "+this.currentGrowthStageIndex),this.growState=m.HARVESTING,this.eventTarget.emit(e.growthCompleteEvent,this),this.isPlayerOwner&&this.node.on(p.EventType.TOUCH_END,this.harvest,this),console.log("growth complete , growState = "+this.growState)},u.getLatestCommandDuration=function(){var t=o(a().mark((function t(){var e,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(e=this.sceneItem)&&e.id){t.next=3;break}return console.warn("Scene item ID is not set"),t.abrupt("return",null);case 3:return t.prev=3,t.next=6,T.instance.getLatestCommandDuration(this.sceneItem.id,this.isPlayerOwner?null:this.sceneItem.userid);case 6:if(!(i=t.sent).success){t.next=11;break}return t.abrupt("return",i.duration);case 11:return console.warn("Failed to get latest command duration:",i.message),t.abrupt("return",null);case 13:t.next=19;break;case 15:return t.prev=15,t.t0=t.catch(3),console.error("Error getting latest command duration:",t.t0),t.abrupt("return",null);case 19:case"end":return t.stop()}}),t,this,[[3,15]])})));return function(){return t.apply(this,arguments)}}(),u.getNode=function(){return this.node},u.setPosition=function(t){this.node.position=t},u.onDragStart=function(){},u.onDragging=function(t){this.setPosition(t)},u.onDragEnd=function(t,e){return!e||(this.node.destroy(),!0)},u.stopGrowth=function(){var t;console.log("stop growth , growState = "+this.growState),null==(t=this.CooldownComponent)||t.removeCooldown("growth"),this.growState=m.NONE},u.isGrowEnd=function(){return 0==this.growthTime},u.updateDiseaseStatus=function(){var t=o(a().mark((function t(e){var i,n,s,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e=1),this.sceneItem&&this.sceneItem.id){t.next=4;break}return console.warn("Cannot update disease status: Scene item or ID is not set"),t.abrupt("return");case 4:return n=v.stringToDate(null==(i=this.sceneItem)?void 0:i.last_updated_time)||new Date,t.prev=5,t.next=8,T.instance.updateDiseaseStatus(this.sceneItem.id,e);case 8:(s=t.sent)&&s.success&&(s.is_sick&&(this.isSick=!0,this.updateSickState(),console.log("Entity "+this.id+" has become sick")),-1!==(r=this.sceneItem.commands.findIndex((function(t){return t.type===g.Disease})))&&s.last_updated_time?(this.sceneItem.commands[r].last_updated_time=s.last_updated_time,console.log("update disease status success, last_updated_time = "+s.last_updated_time)):console.warn("update disease status failed , diseaseCommandIndex = "+r+" , result.last_updated_time = "+s.last_updated_time),s.last_updated_time&&(n=v.stringToDate(s.last_updated_time))),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(5),console.error("Failed to update disease status:",t.t0);case 15:this.scheduleDiseaseStatusUpdate(n);case 16:case"end":return t.stop()}}),t,this,[[5,12]])})));return function(e){return t.apply(this,arguments)}}(),u.scheduleDiseaseStatusUpdate=function(t){var e,i;if((null==(e=this.sceneItem)?void 0:e.state)===S.Dead)return this.updateEntityState(),void this.stopDiseaseStatusUpdates();var n=Date.now()/1e3,s=f.DISEASE_STATUS_UPDATE_INTERVAL,r=null==(i=this.sceneItem)?void 0:i.commands.find((function(t){return t.type===g.Disease}));r&&r.state===w.InProgress?(this.isSick=!0,this.updateSickState(),console.log("Entity "+this.id+" has become sick")):(this.isSick=!1,this.updateSickState());var o=n-t.getTime()/1e3,a=Math.floor(o/s);a>0&&(console.log("Missed intervals: "+a),this.updateDiseaseStatus(a));var u=s-o%s;console.log("Next disease update time: "+u),this.unschedule(this.updateDiseaseStatus),this.scheduleOnce(this.updateDiseaseStatus,u)},u.stopDiseaseStatusUpdates=function(){this.unschedule(this.updateDiseaseStatus)},u.setImmunityDuration=function(t,e){var i=this;this.isSick=!1,this.updateSickState(),this.unschedule(this.updateDiseaseStatus),this.scheduleOnce((function(){i.scheduleDiseaseStatusUpdate(e)}),3600*t)},u.updateSickState=function(){console.log("updateSickState start..., isSick = "+this.isSick),this.sickSprite&&(this.sickSprite.node.active=this.isSick)},u.setDeadState=function(){console.log("setDeadState start ..."),this.sprite&&this.deadSpriteFrame&&(this.sprite.spriteFrame=this.deadSpriteFrame),this.isSick=!1,this.updateSickState(),this.growState=m.NONE,this.stopGrowth(),this.stopDiseaseStatusUpdates()},u.updateEntityState=function(){this.sceneItem&&(this.sceneItem.state===S.Dead?this.setDeadState():this.updateSickState())},u.onDestroy=function(){this.stopDiseaseStatusUpdates(),this.isPlayerOwner&&this.node.off(p.EventType.TOUCH_END,this.harvest,this)},r(e,[{key:"CareCount",get:function(){return this.careCount},set:function(t){this.careCount!==t&&(this.careCount=t,this.stopGrowth(),this.updateTotalGrowthTime(),this.requestNextGrowth())}},{key:"TreatCount",get:function(){return this.treatCount},set:function(t){this.treatCount!==t&&(this.treatCount=t,this.stopGrowth(),this.updateTotalGrowthTime(),this.requestNextGrowth())}},{key:"CleanseCount",get:function(){return this.cleanseCount},set:function(t){this.cleanseCount!==t&&(this.cleanseCount=t,this.stopGrowth(),this.updateTotalGrowthTime(),this.requestNextGrowth())}},{key:"SourceInventoryItem",get:function(){return this.sourceInventoryItem}},{key:"CooldownComponent",get:function(){return this.cooldownComponent||(this.cooldownComponent=this.getComponent(C),this.cooldownComponent||(this.cooldownComponent=this.addComponent(C))),this.cooldownComponent}},{key:"SceneItem",get:function(){return this.sceneItem}}]),e}(y)).growthCompleteEvent="growthComplete",E=e((_=H).prototype,"id",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),N=e(_.prototype,"description",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),P=e(_.prototype,"farmType",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),R=e(_.prototype,"timeMin",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),F=e(_.prototype,"growthTime",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=e(_.prototype,"levelNeed",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),O=e(_.prototype,"sprite",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(_.prototype,"sickSprite",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(_.prototype,"deadSpriteFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(_.prototype,"careCount",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),q=e(_.prototype,"treatCount",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),L=e(_.prototype,"cleanseCount",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),x=_))||x));u._RF.pop()}}}));

System.register("chunks:///_virtual/HttpHelper.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"76cd9p1xH1AWKTalRTajlQm","HttpHelper",void 0);e("HttpHelper",function(){function e(){}return e.openLink=function(e){window.open(e,"_blank")},e.get=function(e,t){if(t){var n=this.objectToQueryString(t);e+=(e.includes("?")?"&":"?")+n}return this.request(e,"GET")},e.post=function(e,t,n){return this.request(e,"POST",t,n)},e.request=function(e,t,n,r){return new Promise((function(o,u){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(i.status>=200&&i.status<300?o(i.responseText):u(new Error(i.statusText)))},i.onerror=function(){return u(new Error("Network error"))},i.ontimeout=function(){return u(new Error("Request timeout"))},i.open(t,e,!0),i.setRequestHeader("Content-Type","application/json"),r&&Object.keys(r).forEach((function(e){return i.setRequestHeader(e,r[e])})),i.send(n?JSON.stringify(n):null)}))},e.objectToQueryString=function(e){return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/icu-component.ts",["cc"],(function(){var e,c;return{setters:[function(t){e=t.cclegacy,c=t._decorator}],execute:function(){e._RF.push({},"7a9702ZfUJLAYlcof0GxBG1","icu-component",void 0);c.ccclass,c.property,c.requireComponent,c.executeInEditMode;e._RF.pop()}}}));

System.register("chunks:///_virtual/icu-options.ts",["cc"],(function(){var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"dc153GItvdCNIAlIBY8vQ+M","icu-options",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/icu-type.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"e5dc4ljkiFFpI9LqK8hBCPl","icu-type",void 0);var i=e("default",function(e){return e[e.DateTime=0]="DateTime",e[e.Number=1]="Number",e[e.List=2]="List",e[e.RelativeTime=3]="RelativeTime",e}(i||{}));t._RF.pop()}}}));

System.register("chunks:///_virtual/InputComonent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts"],(function(t){var n,o,e,i,h,c,s,a;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,i=t.Vec2,h=t.EventTarget,c=t.Node,s=t.Component},function(t){a=t.SharedDefines}],execute:function(){var u,r;o._RF.push({},"5b7aazEDI5GY7j6xy24c5aX","InputComonent",void 0);var T=e.ccclass;e.property,t("InputComponent",T("InputComponent")(((r=function(t){function o(){for(var n,o=arguments.length,e=new Array(o),c=0;c<o;c++)e[c]=arguments[c];return(n=t.call.apply(t,[this].concat(e))||this).touchStartTime=0,n.touchStartPosition=new i,n.onTouchStart=null,n.onTouchMove=null,n.onTouchEnd=null,n.onTouchCancel=null,n.onClick=null,n.eventTarget=new h,n}n(o,t);var e=o.prototype;return e.onLoad=function(){this.node.on(c.EventType.TOUCH_START,this.touchStartHandler,this),this.node.on(c.EventType.TOUCH_MOVE,this.touchMoveHandler,this),this.node.on(c.EventType.TOUCH_END,this.touchEndHandler,this),this.node.on(c.EventType.TOUCH_CANCEL,this.touchCancelHandler,this)},e.touchStartHandler=function(t){this.touchStartTime=Date.now(),this.touchStartPosition=t.getLocation(),this.onTouchStart&&this.onTouchStart(t),this.eventTarget.emit(a.EVENT_TOUCH_START,t)},e.touchMoveHandler=function(t){this.onTouchMove&&this.onTouchMove(t),this.eventTarget.emit(a.EVENT_TOUCH_MOVE,t)},e.touchEndHandler=function(t){var n=Date.now(),e=t.getLocation(),h=n-this.touchStartTime,c=i.distance(this.touchStartPosition,e);h<=1e3*o.CLICK_THRESHOLD&&c<10&&(console.log("InputComponent: onClick"),this.onClick&&this.onClick(t),this.eventTarget.emit(a.EVENT_CLICK,t)),this.onTouchEnd&&this.onTouchEnd(t),this.eventTarget.emit(a.EVENT_TOUCH_END,t)},e.touchCancelHandler=function(t){this.onTouchCancel&&this.onTouchCancel(t),this.eventTarget.emit(a.EVENT_TOUCH_CANCEL,t)},e.onDestroy=function(){this.node.off(c.EventType.TOUCH_START,this.touchStartHandler,this),this.node.off(c.EventType.TOUCH_MOVE,this.touchMoveHandler,this),this.node.off(c.EventType.TOUCH_END,this.touchEndHandler,this),this.node.off(c.EventType.TOUCH_CANCEL,this.touchCancelHandler,this)},o}(s)).CLICK_THRESHOLD=.25,u=r))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/Intl.PluralRules.ts",["cc","./polyfill.mjs_cjs=&original=.js"],(function(){var l;return{setters:[function(n){l=n.cclegacy},null],execute:function(){l._RF.push({},"c9594RdIOFIPIqnCMoH103U","Intl.PluralRules",void 0),l._RF.pop()}}}));

System.register("chunks:///_virtual/InventoryComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemDataManager.ts","./PlayerController.ts"],(function(t){var e,i,n,r,o,a,s,u,c,p,m,l,y;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.createForOfIteratorHelperLoose,r=t.extends,o=t.createClass,a=t.asyncToGenerator,s=t.regeneratorRuntime},function(t){u=t.cclegacy,c=t._decorator,p=t.EventTarget,m=t.Component},function(t){l=t.ItemDataManager},function(t){y=t.PlayerController}],execute:function(){var h,d,v;u._RF.push({},"7a91aGZd+lHCay7VRiJxdfF","InventoryComponent",void 0);var f=c.ccclass,E=c.property,I=(t("ItemType",function(t){return t[t.NONE=0]="NONE",t[t.CROP=1]="CROP",t[t.CROPSEED=2]="CROPSEED",t[t.ANIMAL=3]="ANIMAL",t[t.ANIMALCUB=4]="ANIMALCUB",t}({})),t("InventoryItem",(function(t,e){void 0===e&&(e=1),this.id=void 0,this.name=void 0,this.description=void 0,this.itemType=void 0,this.expGain=void 0,this.buyPrice=void 0,this.sellPrice=void 0,this.iconName=void 0,this.quantity=void 0,this.detailId=void 0,this.id=t.id,this.name=t.name,this.description=t.description,this.itemType=t.item_type,this.expGain=parseInt(t.exp_get),this.buyPrice=parseInt(t.buy_price),this.sellPrice=parseInt(t.sell_price),this.iconName=t.png,this.quantity=e,this.detailId=t.detail_id})));t("InventoryComponent",f("InventoryComponent")(((v=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).playerController=null,e.items=new Map,e.capacity=100,e.eventTarget=new p,e}i(e,t);var u=e.prototype;return u.onLoad=function(){this.playerController=this.node.getComponent(y)},u.initialize=function(t){this.items.clear();for(var e,i=n(t);!(e=i()).done;){var o=e.value,a=l.instance.getItemById(o.item_id),s=new I(a,o.num);this.items.set(s.id,r({},s))}},u.setCapacity=function(t){this.capacity=t},u.addItem=function(){var t=a(s().mark((function t(i){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=this.items.get(i.id))?(n.quantity+=i.quantity,this.eventTarget.emit(e.EVENT_ITEM_UPDATED,n)):(this.items.set(i.id,r({},i)),this.eventTarget.emit(e.EVENT_ITEM_ADDED,i)),console.log("Added "+i.quantity+" of item with id: "+i.id),t.abrupt("return",!0);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),u.removeItem=function(){var t=a(s().mark((function t(i,n){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===n&&(n=1),r=this.items.get(i)){t.next=5;break}return console.warn("Item with id "+i+" not found in inventory."),t.abrupt("return",!1);case 5:if(!(r.quantity<n)){t.next=8;break}return console.warn("Not enough quantity to remove. Requested: "+n+", Available: "+r.quantity),t.abrupt("return",!1);case 8:return r.quantity-=n,this.eventTarget.emit(e.EVENT_ITEM_UPDATED,r),0===r.quantity&&(this.items.delete(i),this.eventTarget.emit(e.EVENT_ITEM_REMOVED,i)),t.abrupt("return",!0);case 12:case"end":return t.stop()}}),t,this)})));return function(e,i){return t.apply(this,arguments)}}(),u.getItem=function(t){return this.items.get(t)},u.getItemsByType=function(t){return Array.from(this.items.values()).filter((function(e){return e.itemType===t}))},u.getAllItems=function(){return Array.from(this.items.values())},u.clear=function(){this.items.clear()},u.hasItem=function(t){return this.items.has(t)},u.getItemQuantity=function(t){var e=this.items.get(t);return e?e.quantity:0},o(e,[{key:"itemCount",get:function(){return this.items.size}},{key:"isFull",get:function(){return this.itemCount>=this.capacity}}]),e}(m)).EVENT_ITEM_ADDED="item-added",v.EVENT_ITEM_REMOVED="item-removed",v.EVENT_ITEM_UPDATED="item-updated",e((d=v).prototype,"itemCount",[E],Object.getOwnPropertyDescriptor(d.prototype,"itemCount"),d.prototype),e(d.prototype,"isFull",[E],Object.getOwnPropertyDescriptor(d.prototype,"isFull"),d.prototype),h=d))||h);u._RF.pop()}}}));

System.register("chunks:///_virtual/ItemDataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts"],(function(t){var e,n,i,r,a,s,u;return{setters:[function(t){e=t.createClass,n=t.asyncToGenerator,i=t.regeneratorRuntime},function(t){r=t.cclegacy,a=t.resources,s=t.JsonAsset},function(t){u=t.SharedDefines}],execute:function(){r._RF.push({},"9d19cFSh79OUpDLPUTZHAwZ","ItemDataManager",void 0),t("ItemDataManager",function(){function t(){this.itemDataList=[]}var r=t.prototype;return r.loadItemData=function(){var t=n(i().mark((function t(){var e=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){a.load(u.JSON_ITEM_DATA,s,(function(i,r){if(i)return console.error("Failed to load ItemData:",i),void n(i);e.itemDataList=r.json.list,t()}))})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r.getItemById=function(t){return this.itemDataList.find((function(e){return e.id===t}))},r.getItemByName=function(t){return this.itemDataList.find((function(e){return e.name===t}))},r.getItemsByType=function(t){return this.itemDataList.filter((function(e){return e.item_type===t}))},r.getItemsBySellPrice=function(t,e){return this.itemDataList.filter((function(n){var i=parseInt(n.sell_price);return i>=t&&i<=e}))},r.getItemsByExpGain=function(t,e){return this.itemDataList.filter((function(n){var i=parseInt(n.exp_get);return i>=t&&i<=e}))},r.getAllItems=function(){return[].concat(this.itemDataList)},r.getItemCount=function(){return this.itemDataList.length},r.isItemDataLoaded=function(){return this.itemDataList.length>0},e(t,null,[{key:"instance",get:function(){return null===this._instance&&(this._instance=new t),this._instance}}]),t}())._instance=null,r._RF.pop()}}}));

System.register("chunks:///_virtual/l10n-component.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env"],(function(t){var e,n,o,r,i,l,a,s;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.createClass},function(t){r=t.cclegacy,i=t._decorator,l=t.Label,a=t.Component},function(t){s=t.EDITOR}],execute:function(){var c,p,u,d,h,f,g;r._RF.push({},"64a56e3cKhJIYlOsrVQprpv","l10n-component",void 0);var v=i.ccclass,b=i.property,y=i.disallowMultiple,m=i.requireComponent,L=i.menu;t("default",(c=v("L10nComponent"),p=m(l),u=y(),d=L("hidden:LocalizationEditor/L10nComponent"),h=b({readonly:!0}),c(f=p(f=u(f=d((e((g=function(t){function e(){var e;return(e=t.call(this)||this).label=void 0,e}n(e,t);var r=e.prototype;return r.onLoad=function(){this.label=this.node.getComponent(l)},r.start=function(){this.render()},r.render=function(){},r.preview=function(t){if(this.label&&s){var e=this.label.string;this.label._string=t,this.label.updateRenderData(!0),cce.Engine.repaintInEditMode(),this.label._string=e}},o(e,[{key:"string",get:function(){var t;return(null==(t=this.label)?void 0:t.string)||""}}]),e}(a)).prototype,"string",[h],Object.getOwnPropertyDescriptor(g.prototype,"string"),g.prototype),f=g))||f)||f)||f)||f));r._RF.pop()}}}));

System.register("chunks:///_virtual/l10n-label.ts",["./rollupPluginModLoBabelHelpers.js","cc","./l10n-manager.ts","./l10n-component.ts"],(function(t){var e,n,o,r,i,c,l,u,a,s;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,r=t.assertThisInitialized,i=t.createClass},function(t){c=t.cclegacy,l=t._decorator,u=t.CCInteger},function(t){a=t.default},function(t){s=t.default}],execute:function(){var p,y,f,d,b,h,v,_,g,k,L;c._RF.push({},"30d83qzRfZHLYMFn4KA9PG4","l10n-label",void 0);var m=l.ccclass,z=l.property,w=l.executeInEditMode,D=l.menu;t("default",(p=m("L10nLabel"),y=w(!0),f=D("LocalizationEditor/L10nLabel"),d=z({visible:!1}),b=z({visible:!0}),h=z({visible:!1}),v=z({type:u,visible:!0}),p(_=y(_=f((k=e((g=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i))||this,o(e,"_key",k,r(e)),o(e,"_count",L,r(e)),e}n(e,t);var c=e.prototype;return c.onLoad=function(){"function"==typeof t.prototype.onLoad&&t.prototype.onLoad.call(this)},c.render=function(){var t=a.t(this._key,{count:this._count});void 0!==this.label&&void 0!==t&&(this.label.string=t)},i(e,[{key:"key",get:function(){return this._key},set:function(t){this._key=t,this.render()}},{key:"count",get:function(){return this._count},set:function(t){this._count=t,this.render()}}]),e}(s)).prototype,"_key",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),e(g.prototype,"key",[b],Object.getOwnPropertyDescriptor(g.prototype,"key"),g.prototype),L=e(g.prototype,"_count",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(g.prototype,"count",[v],Object.getOwnPropertyDescriptor(g.prototype,"count"),g.prototype),_=g))||_)||_)||_));c._RF.pop()}}}));

System.register("chunks:///_virtual/l10n-listen-event.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"34153BqzJ9LR4lhJDevpA4f","l10n-listen-event",void 0);var t=e("default",function(e){return e.languageChanged="languageChanged",e.onMissingKey="missingKey",e}(t||{}));n._RF.pop()}}}));

System.register("chunks:///_virtual/l10n-manager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./i18next.js","./resource-data-manager.ts","./localization-global.ts"],(function(e){var t,n,r,a,i,l,s,u,o,c,g;return{setters:[function(e){t=e.createClass,n=e.asyncToGenerator,r=e.regeneratorRuntime,a=e.extends},function(e){i=e.cclegacy,l=e.assetManager,s=e.game},function(e){u=e.createInstance},function(e){o=e.default},function(e){c=e.mainName,g=e.pluginName}],execute:function(){var h;i._RF.push({},"2856a7GSV9Fbb53nOimJ33J","l10n-manager",void 0);var f=e("L10nManager",function(){function e(){this._intl=void 0,this._options={},this.resourceList=void 0,this.resourceBundle={},this.resourceDataManager=void 0,this.resourceDataManager=new o}var i=e.prototype;return i.isInitialized=function(){var e,t;return null!=(e=null==(t=this._intl)?void 0:t.isInitialized)&&e},i.createIntl=function(){var t=n(r().mark((function t(n){var i,l,s,o,c,g,h,f,v,_;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.reloadResourceData();case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:return this._options=n,this._intl=u(),c=void 0,c=localStorage.getItem(null!=(g=d._options.localStorageLanguageKey)?g:e.LOCAL_STORAGE_LANGUAGE_KEY),c=this.checkLanguage(c),h=null!=(i=null!=(l=c)?l:n.language)?i:this.resourceList.defaultLanguage,f=null!=(s=n.fallbackLanguage)?s:this.resourceList.fallbackLanguage,v=null!=(o=n.resources)?o:this.resourceBundle,_={lng:h,fallbackLng:f,resources:a({},v),ns:e.ALLOW_NAMESPACE,defaultNS:e.DEFAULT_NAMESPACE,initImmediate:!1,load:"currentOnly"},t.next=15,this._intl.init(_);case 15:this.setAssetOverrideMap(v[h][e.ASSET_NAMESPACE]);case 16:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.checkLanguage=function(e){if(e&&0!==e.length&&"null"!==e&&null!==e&&"undefined"!==e&&void 0!==e)return this.resourceList&&this.resourceList.languages.length>0&&this.resourceList.languages.find((function(t){return t===e}))?e:void 0},i.cloneIntl=function(e){if(!this._intl)throw new Error("i18next not init, please use 'l10n.createIntl'");this._intl=this._intl.cloneInstance(e)},i.reloadResourceData=function(){var e=n(r().mark((function e(){var t,n,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resourceDataManager.readResourceList();case 2:if(this.resourceList=e.sent,this.resourceList){e.next=6;break}return console.log("["+g+"] not found translate language list, skip init l10n"),e.abrupt("return",!1);case 6:return e.next=8,this.resourceDataManager.readResourceBundle(null!=(t=null==(n=this.resourceList)?void 0:n.languages)?t:[]);case 8:if(this.resourceBundle=e.sent,null!=(a=this.resourceList)&&a.defaultLanguage){e.next=12;break}return console.log("["+g+"] not found translate language data, skip init l10n"),e.abrupt("return",!1);case 12:return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.config=function(e){this.cloneIntl(e)},i.changeLanguage=function(){var t=n(r().mark((function t(n){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=3;break}return console.warn("["+g+"] invalid language tag"),t.abrupt("return");case 3:if(console.log("["+g+"] will change language to",n),!this._intl){t.next=12;break}return this.currentLanguage&&this.releaseOverrideMap(this.resourceBundle[this.currentLanguage][e.ASSET_NAMESPACE]),t.next=8,this._intl.changeLanguage(n);case 8:this.setAssetOverrideMap(this.resourceBundle[n][e.ASSET_NAMESPACE]),localStorage.setItem(e.LOCAL_STORAGE_LANGUAGE_KEY,n),console.log("["+g+"] game will restart"),s.restart(),t.next=13;break;case 12:console.log("["+g+"] language data not load, please confirm whether the language data is included in the build");case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),i.t=function(e,t){var n,r;return null!=(n=null==(r=this._intl)?void 0:r.isInitialized)&&n?this._intl.t(e,t):e},i.tn=function(e,t){var n,r,a;if(null==(n=null==(r=this._intl)?void 0:r.isInitialized)||!n)return e.toString();var i={};Object.assign(i,t);for(var l=0,s=Object.keys(i);l<s.length;l++){var u=s[l];("string"==typeof i[u]&&0===i[u].length||"number"==typeof i[u]&&0===i[u])&&delete i[u]}return new Intl.NumberFormat(null==(a=this._intl)?void 0:a.language,i).format(e)},i.td=function(e,t){var n,r,a;if(null==(n=null==(r=this._intl)?void 0:r.isInitialized)||!n)return e.toString();var i={};Object.assign(i,t);for(var l=0,s=Object.keys(i);l<s.length;l++){var u=s[l];"string"==typeof i[u]&&0===i[u].length&&delete i[u]}return new Intl.DateTimeFormat(null==(a=this._intl)?void 0:a.language,i).format(e)},i.tt=function(e,t,n){var r,a,i;if(null==(r=null==(a=this._intl)?void 0:a.isInitialized)||!r)return e.toString();var l={};Object.assign(l,n);for(var s=0,u=Object.keys(l);s<u.length;s++){var o=u[s];"string"==typeof l[o]&&0===l[o].length&&delete l[o]}return new Intl.RelativeTimeFormat(null==(i=this._intl)?void 0:i.language,l).format(e,t)},i.tl=function(e){var t,n,r;return null!=(t=null==(n=this._intl)?void 0:n.isInitialized)&&t?new Intl.ListFormat(null==(r=this._intl)?void 0:r.language).format(e):e.toString()},i.exists=function(e){var t,n;return null!=(t=null==(n=this._intl)?void 0:n.exists(e))&&t},i.direction=function(e){return(e?new Intl.Locale(e):new Intl.Locale(this._intl.language)).textInfo().direction},i.on=function(e,t){var n;null==(n=this._intl)||n.on(e,t)},i.off=function(e,t){var n;null==(n=this._intl)||n.off(e,t)},i.getResourceBundle=function(e,t){var n;return null==(n=this._intl)?void 0:n.getResourceBundle(e,t)},i.setAssetOverrideMap=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];l.assetsOverrideMap.set(r,e[r])}},i.releaseOverrideMap=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];l.assetsOverrideMap.delete(r)}},t(e,[{key:"currentLanguage",get:function(){var e,t;return null!=(e=null==(t=this._intl)?void 0:t.language)?e:""}},{key:"languages",get:function(){var e,t;return null!=(e=null==(t=this.resourceList)?void 0:t.languages)?e:[]}}]),e}());h=f,f.LOCAL_STORAGE_LANGUAGE_KEY=c+"/language",f.DEFAULT_NAMESPACE="translation",f.ASSET_NAMESPACE="asset",f.ALLOW_NAMESPACE=[h.DEFAULT_NAMESPACE,h.ASSET_NAMESPACE],f.l10n=new h;var d=e("default",f.l10n);i._RF.pop()}}}));

System.register("chunks:///_virtual/l10n-options.ts",["cc"],(function(){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"b4618IbsRtLLbRp2dQrE3EI","l10n-options",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/l10n.ts",["cc","./l10n-manager.ts","./l10n-listen-event.ts","./l10n-label.ts"],(function(n){var t;return{setters:[function(n){t=n.cclegacy},function(t){var e={};e.L10nManager=t.L10nManager,e.l10n=t.default,n(e)},function(t){n("L10nListenEvent",t.default)},function(t){n("L10nLabel",t.default)}],execute:function(){t._RF.push({},"07b54nOFPVJZJ/ENmuVbfjY","l10n",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/LayoutAdapter.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,a,n,o,r,l,s,d,h,u,p,c,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,a=t.initializerDefineProperty,n=t.assertThisInitialized,o=t.createForOfIteratorHelperLoose,r=t.createClass},function(t){l=t.cclegacy,s=t._decorator,d=t.Layout,h=t.Vec3,u=t.UITransform,p=t.Widget,c=t.Node,g=t.Component}],execute:function(){var y,f,S,m,L,C,z,b,v,R,w,B,M;l._RF.push({},"16d0a7/LSBLNadwM1EPsT78","LayoutAdapter",void 0);var T=s.ccclass,_=s.property;t("LayoutAdapter",(y=T("LayoutAdapter"),f=_(Number),S=_(Number),m=_(Boolean),L=_(Boolean),C=_(d),y((v=e((b=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o))||this,a(e,"designWidth",v,n(e)),a(e,"designHeight",R,n(e)),a(e,"adapterWidth",w,n(e)),a(e,"adapterHeight",B,n(e)),a(e,"_layout",M,n(e)),e.paddingLeft=0,e.paddingRight=0,e.paddingTop=0,e.paddingBottom=0,e.spacingX=0,e.spacingY=0,e.originalContentSize=new h,e.currentContentSize=new h,e.realScale=new h,e}i(e,t);var l=e.prototype;return l.onLoad=function(){var t=this,e=this.node.getComponent(u);e&&(this.originalContentSize.set(this.designWidth,this.designHeight,0),this.currentContentSize.set(this.designWidth,e.height,0)),this.paddingLeft=this.layout.paddingLeft,this.paddingRight=this.layout.paddingRight,this.paddingTop=this.layout.paddingTop,this.paddingBottom=this.layout.paddingBottom,this.spacingX=this.layout.spacingX,this.spacingY=this.layout.spacingY,this.updateRealScale();var i=this.node.getComponent(p);i&&i.node.on(c.EventType.SIZE_CHANGED,(function(){t.onSizeChanged()}))},l.onSizeChanged=function(){var t=this.node.getComponent(u);t&&this.currentContentSize.set(t.width,t.height,0),this.updateRealScale()},l.updateRealScale=function(){console.log("updateRealScale start .. name = "+this.node.name+", originalContentSize: "+this.currentContentSize);var t=this.currentContentSize,e=this.originalContentSize,i=this.adapterWidth?Math.floor(t.x/e.x*100)/100:1,a=this.adapterHeight?Math.floor(t.y/e.y*100)/100:1;this.realScale.set(i,a,1),console.log("realScale: "+this.realScale),this.updateLayoutPaddingAndSpacing(),this.updateLayoutChildrenScale(),this.layout.updateLayout()},l.updateLayoutPaddingAndSpacing=function(){this.layout.paddingLeft=Math.floor(this.paddingLeft*this.realScale.x),this.layout.paddingRight=Math.floor(this.paddingRight*this.realScale.x),this.layout.paddingTop=Math.floor(this.paddingTop*this.realScale.y),this.layout.paddingBottom=Math.floor(this.paddingBottom*this.realScale.y),this.layout.spacingX=Math.floor(this.spacingX*this.realScale.x),this.layout.spacingY=Math.floor(this.spacingY*this.realScale.y),console.log("layout padding: "+this.layout.paddingLeft+", "+this.layout.paddingRight+", "+this.layout.paddingTop+", "+this.layout.paddingBottom),console.log("layout spacing: "+this.layout.spacingX+", "+this.layout.spacingY)},l.updateLayoutChildrenScale=function(){for(var t,e=this.node.children,i=o(e);!(t=i()).done;){var a=t.value.getComponent(u);a&&a.node.setScale(this.realScale.x,this.realScale.y,this.realScale.z)}},r(e,[{key:"layout",get:function(){return this._layout||(this._layout=this.node.getComponent(d)),this._layout}},{key:"RealScale",get:function(){return this.realScale}}]),e}(g)).prototype,"designWidth",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1920}}),R=e(b.prototype,"designHeight",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1080}}),w=e(b.prototype,"adapterWidth",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),B=e(b.prototype,"adapterHeight",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M=e(b.prototype,"_layout",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=b))||z));l._RF.pop()}}}));

System.register("chunks:///_virtual/localization-global.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"02d9etKgNBGqLPpvU7RX29o","localization-global",void 0);e("pluginName","Localization Editor"),e("mainName","localization-editor"),e("runtimeBundleName","l10n"),e("resourceListPath","resource-list"),e("resourceBundlePath","resource-bundle");t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./GameEntry.ts","./BuildingPlacementComponent.ts","./CooldownComponent.ts","./DragDropComponent.ts","./InputComonent.ts","./InventoryComponent.ts","./GameController.ts","./PlayerController.ts","./CoinCollectionEffectComponent.ts","./Animal.ts","./Building.ts","./Crop.ts","./Fence.ts","./GrowthableEntity.ts","./PlayerState.ts","./PlotTile.ts","./SceneEntity.ts","./DateHelper.ts","./HttpHelper.ts","./SpriteHelper.ts","./UIEffectHelper.ts","./UIHelper.ts","./AnimalDataManager.ts","./BuildDataManager.ts","./BuildingManager.ts","./CoinDataManager.ts","./CropDataManager.ts","./DashFunManager.ts","./DiamondDataManager.ts","./GradeDataManager.ts","./ItemDataManager.ts","./NetworkManager.ts","./ResourceManager.ts","./ScreenOrientationManager.ts","./SyntheDataManager.ts","./SharedDefines.ts","./NetworkPlayerState.ts","./UIAdaptComponent.ts","./WindowManager.ts","./WindowBase.ts","./CoinDisplay.ts","./CurrencyDisplayBase.ts","./DiamondDisplay.ts","./LayoutAdapter.ts","./CraftScrollViewItem.ts","./PaymentItem.ts","./ScrollViewItem.ts","./CraftWindow.ts","./FarmFactoryWindow.ts","./FarmSelectionWindow.ts","./GameWindow.ts","./MainWindow.ts","./PaymentWindow.ts","./ShopWindow.ts","./TipsWindow.ts","./ToastWindow.ts","./icu-component.ts","./l10n-component.ts","./l10n-label.ts","./auto-config-intl-manager.ts","./icu-options.ts","./icu-type.ts","./l10n-listen-event.ts","./l10n-manager.ts","./l10n-options.ts","./localization-global.ts","./resource-data-manager.ts","./l10n.ts","./Intl.PluralRules.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WindowBase.ts","./WindowManager.ts","./NetworkManager.ts","./DashFunManager.ts"],(function(e){var t,n,r,o,i,a,s,l,c,u,h,d,p,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized,i=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e._decorator,c=e.EditBox,u=e.Button},function(e){h=e.WindowBase},function(e){d=e.WindowManager},function(e){p=e.NetworkManager},function(e){f=e.DashFunManager}],execute:function(){var g,w,y,b,v,m,U,W,P;s._RF.push({},"ef3c6iVecZJZ52hhIp8pRIh","MainWindow",void 0);var S=l.ccclass,M=l.property;e("MainWindow",(g=S("MainWindow"),w=M(c),y=M(c),b=M(u),g((U=t((m=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,r(t,"ebUserId",U,o(t)),r(t,"ebPassword",W,o(t)),r(t,"btnStart",P,o(t)),t}n(t,e);var s=t.prototype;return s.initialize=function(){e.prototype.initialize.call(this),this.setupEventListeners(),globalThis.mainWindow=this,f.instance.updateLoadingProgress(10),f.instance.eventTarget.on(f.EVENT_GET_USER_PROFILE_RESULT,this.onGetUserProfileResult,this),console.log("MainWindow initialized")},s.show=function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];(t=e.prototype.show).call.apply(t,[this].concat(r)),console.log("MainWindow shown"),f.instance.getUserProfile()},s.hide=function(){e.prototype.hide.call(this),console.log("MainWindow hidden")},s.setupEventListeners=function(){this.btnStart?this.btnStart.node.on(u.EventType.CLICK,this.onStartButtonClicked,this):console.warn("Start button not found in MainWindow")},s.onGetUserProfileResult=function(){var e=i(a().mark((function e(t){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onGetUserProfileResult",t),null!=t){e.next=5;break}return console.log("onGetUserProfileResult data is null,retry get user profile 1 second later"),this.scheduleOnce((function(){console.log("retry get user profile"),f.instance.getUserProfile()}),1),e.abrupt("return");case 5:return f.instance.updateLoadingProgress(100),n=t,e.next=9,this.gameController.login(n.id,"");case 9:if(!(r=e.sent)||!r.success){e.next=21;break}if(this.gameController.getPlayerController().playerState.nickname=n.displayName,!n.avatarUrl||this.gameController.getPlayerController().playerState.headUrl==n.avatarUrl){e.next=16;break}return console.log("update avatar url: "+n.avatarUrl),e.next=16,p.instance.requestUpdateAvatarUrl(n.avatarUrl);case 16:return e.next=18,d.instance.show("GameWindow");case 18:this.hide(),e.next=23;break;case 21:console.log(r.message),d.instance.show("ToastWindow",r.message);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.onStartButtonClicked=function(){var e=i(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onStartButtonClicked start..."),e.next=3,this.gameController.login(this.ebUserId.string,this.ebPassword.string);case 3:(t=e.sent)&&t.success?(d.instance.show("GameWindow"),this.hide()):(console.log(t.message),d.instance.show("ToastWindow",t.message));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.onDestroy=function(){e.prototype.onDestroy.call(this),this.btnStart&&this.btnStart.node.off(u.EventType.CLICK,this.onStartButtonClicked,this)},t}(h)).prototype,"ebUserId",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(m.prototype,"ebPassword",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(m.prototype,"btnStart",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=m))||v));s._RF.pop()}}}));

System.register("chunks:///_virtual/NetworkManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./HttpHelper.ts"],(function(e){var t,r,n,a,s,i,u,o,c,p,h,l,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,a=e.assertThisInitialized,s=e.createClass,i=e.asyncToGenerator,u=e.regeneratorRuntime,o=e.extends},function(e){c=e.cclegacy,p=e._decorator,h=e.EventTarget,l=e.Component},function(e){d=e.HttpHelper}],execute:function(){var f,E,v,m,A,_,I,b,N,T,S,k,g;c._RF.push({},"c1c62QuDqxLY7YzBg+GDyvN","NetworkManager",void 0);var P=p.ccclass,x=p.property;e("NetworkManager",(f=P("NetworkManager"),E=x({multiline:!0,tooltip:"Enter default headers in JSON format"}),f(((g=function(e){function t(){for(var t,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t=e.call.apply(e,[this].concat(s))||this,n(t,"localBaseUrl",A,a(t)),n(t,"serverBaseUrl",_,a(t)),n(t,"loginPort",I,a(t)),n(t,"gameServerPort",b,a(t)),n(t,"paymentPort",N,a(t)),n(t,"maxLoginRetries",T,a(t)),n(t,"defaultHeadersJson",S,a(t)),t.token="",t.userId="",n(t,"simulateNetwork",k,a(t)),t.eventTarget=new h,t}r(t,e);var c=t.prototype;return c.onLoad=function(){null===t._instance?t._instance=this:this.node.destroy()},c.buildApiUrl=function(e,t){return""+this.baseUrl+e},c.login=function(){var e=i(u().mark((function e(r,n){var a,s,i,o,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this.buildApiUrl(t.API_LOGIN,this.loginPort),s={userid:r,password:n},i=1;case 3:if(!(i<=this.maxLoginRetries)){e.next=36;break}return e.prev=4,console.log(a),e.next=8,d.post(a,s,this.defaultHeaders);case 8:if(o=e.sent,!(c=JSON.parse(o)).success){e.next=17;break}return console.log("Login successful",c),this.token=c.sessionToken,this.userId=c.user.id,e.abrupt("return",c);case 17:if(console.warn("Login attempt "+i+" failed: "+c.message),i!==this.maxLoginRetries){e.next=21;break}return console.error("Max login attempts reached"),e.abrupt("return",c);case 21:return e.next=23,this.delay(1e3*i);case 23:e.next=33;break;case 25:if(e.prev=25,e.t0=e.catch(4),console.error("Login attempt "+i+" error:",e.t0),i!==this.maxLoginRetries){e.next=31;break}return this.handleError(e.t0),e.abrupt("return",null);case 31:return e.next=33,this.delay(1e3*i);case 33:i++,e.next=3;break;case 36:case"end":return e.stop()}}),e,this,[[4,25]])})));return function(t,r){return e.apply(this,arguments)}}(),c.requestSceneItemsByUserId=function(){var e=i(u().mark((function e(r){var n,a,s,i,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.buildApiUrl(t.API_GET_USER_SCENE_ITEMS,this.gameServerPort),console.log(n),a={Authorization:this.token},s={userid:r},e.prev=4,e.next=7,d.post(n,s,a);case 7:i=e.sent,console.log(i),o=JSON.parse(i),this.eventTarget.emit(t.EVENT_GET_USER_SCENE_ITEMS,o),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),this.handleError(e.t0);case 16:case"end":return e.stop()}}),e,this,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),c.requestUpdateAvatarUrl=function(){var e=i(u().mark((function e(r){var n,a,s,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.buildApiUrl(t.API_UPDATE_AVATAR_URL,this.gameServerPort),a=o({Authorization:this.token},this.defaultHeaders),s={userid:this.userId,avatarUrl:r},e.prev=3,e.next=6,d.post(n,s,a);case 6:return i=e.sent,c=JSON.parse(i),e.abrupt("return",c.success);case 11:return e.prev=11,e.t0=e.catch(3),this.handleError(e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this,[[3,11]])})));return function(t){return e.apply(this,arguments)}}(),c.getLatestCommandDuration=function(){var e=i(u().mark((function e(r,n){var a,s,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=null),!this.simulateNetwork){e.next=3;break}return e.abrupt("return",{success:!0,duration:0});case 3:return a=this.buildApiUrl(t.API_GET_LATEST_COMMAND_DURATION,this.gameServerPort),s=o({Authorization:this.token},this.defaultHeaders),i={userid:n||this.userId,sceneItemId:r},e.prev=6,e.next=9,d.post(a,i,s);case 9:return c=e.sent,e.abrupt("return",JSON.parse(c));case 13:throw e.prev=13,e.t0=e.catch(6),this.handleError(e.t0),e.t0;case 17:case"end":return e.stop()}}),e,this,[[6,13]])})));return function(t,r){return e.apply(this,arguments)}}(),c.plant=function(){var e=i(u().mark((function e(r,n,a,s,i){var c,p,h,l,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=3;break}return this.eventTarget.emit(t.EVENT_PLANT,{success:!0}),e.abrupt("return",!0);case 3:return c=this.buildApiUrl(t.API_PLANT,this.gameServerPort),p=o({Authorization:this.token},this.defaultHeaders),h={userid:this.userId,itemid:r,type:n,x:a,y:s,parent_node_name:i},e.prev=6,e.next=9,d.post(c,h,p);case 9:return l=e.sent,f=JSON.parse(l),this.eventTarget.emit(t.EVENT_PLANT,f),e.abrupt("return",f.success);case 15:return e.prev=15,e.t0=e.catch(6),this.handleError(e.t0),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,this,[[6,15]])})));return function(t,r,n,a,s){return e.apply(this,arguments)}}(),c.harvest=function(){var e=i(u().mark((function e(r,n,a){var s,i,c,p,h;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=3;break}return this.eventTarget.emit(t.EVENT_HARVEST,{success:!0}),e.abrupt("return",!0);case 3:return s=this.buildApiUrl(t.API_HARVEST,this.gameServerPort),i=o({Authorization:this.token},this.defaultHeaders),c={userid:this.userId,sceneid:r,itemid:n,itemtype:a},e.prev=6,e.next=9,d.post(s,c,i);case 9:return p=e.sent,h=JSON.parse(p),this.eventTarget.emit(t.EVENT_HARVEST,h),e.abrupt("return",h.success);case 15:return e.prev=15,e.t0=e.catch(6),this.handleError(e.t0),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,this,[[6,15]])})));return function(t,r,n){return e.apply(this,arguments)}}(),c.addInventoryItem=function(){var e=i(u().mark((function e(r,n,a,s,i){var c,p,h,l,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",!0);case 2:return c=this.buildApiUrl(t.API_ADD_INVENTORY_ITEM,this.gameServerPort),p=o({Authorization:r},this.defaultHeaders),h={userId:n,itemId:a,type:s,quantity:i},e.prev=5,e.next=8,d.post(c,h,p);case 8:return l=e.sent,f=JSON.parse(l),e.abrupt("return",f.success);case 13:return e.prev=13,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t,r,n,a,s){return e.apply(this,arguments)}}(),c.removeInventoryItem=function(){var e=i(u().mark((function e(r,n,a,s,i){var c,p,h,l,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",!0);case 2:return c=this.buildApiUrl(t.API_REMOVE_INVENTORY_ITEM,this.gameServerPort),p=o({Authorization:r},this.defaultHeaders),h={userId:n,itemId:a,type:s,quantity:i},e.prev=5,e.next=8,d.post(c,h,p);case 8:return l=e.sent,f=JSON.parse(l),e.abrupt("return",f.success);case 13:return e.prev=13,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t,r,n,a,s){return e.apply(this,arguments)}}(),c.buyItem=function(){var e=i(u().mark((function e(r,n){var a,s,i,c,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",!0);case 2:return a=this.buildApiUrl(t.API_BUY_ITEM,this.gameServerPort),s=o({Authorization:this.token},this.defaultHeaders),i={userid:this.userId,itemid:r,num:n},e.prev=5,e.next=8,d.post(a,i,s);case 8:return c=e.sent,p=JSON.parse(c),this.eventTarget.emit(t.EVENT_BUY_ITEM,p),e.abrupt("return",p.success);case 14:return e.prev=14,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t,r){return e.apply(this,arguments)}}(),c.sellItem=function(){var e=i(u().mark((function e(r,n){var a,s,i,c,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",!0);case 2:return a=this.buildApiUrl(t.API_SELL_ITEM,this.gameServerPort),s=o({Authorization:this.token},this.defaultHeaders),i={userid:this.userId,itemid:r,num:n},e.prev=5,e.next=8,d.post(a,i,s);case 8:return c=e.sent,p=JSON.parse(c),this.eventTarget.emit(t.EVENT_SELL_ITEM,p),e.abrupt("return",p);case 14:return e.prev=14,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t,r){return e.apply(this,arguments)}}(),c.care=function(){var e=i(u().mark((function e(r){var n,a,s,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return n=this.buildApiUrl(t.API_CARE,this.gameServerPort),a=o({Authorization:this.token},this.defaultHeaders),s={userid:this.userId,sceneid:r},e.prev=5,e.next=8,d.post(n,s,a);case 8:return i=e.sent,c=JSON.parse(i),this.eventTarget.emit(t.EVENT_CARE,c),e.abrupt("return",c);case 14:return e.prev=14,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t){return e.apply(this,arguments)}}(),c.careFriend=function(){var e=i(u().mark((function e(r,n){var a,s,i,c,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return a=this.buildApiUrl(t.API_CARE_FRIEND,this.gameServerPort),s=o({Authorization:this.token},this.defaultHeaders),i={userid:this.userId,sceneid:r,friendId:n},e.prev=5,e.next=8,d.post(a,i,s);case 8:return c=e.sent,p=JSON.parse(c),this.eventTarget.emit(t.EVENT_CARE_FRIEND,p),e.abrupt("return",p);case 14:return e.prev=14,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t,r){return e.apply(this,arguments)}}(),c.treat=function(){var e=i(u().mark((function e(r){var n,a,s,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return n=this.buildApiUrl(t.API_TREAT,this.gameServerPort),a=o({Authorization:this.token},this.defaultHeaders),s={userid:this.userId,sceneid:r},e.prev=5,e.next=8,d.post(n,s,a);case 8:return i=e.sent,c=JSON.parse(i),this.eventTarget.emit(t.EVENT_TREAT,c),e.abrupt("return",c);case 14:return e.prev=14,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t){return e.apply(this,arguments)}}(),c.treatFriend=function(){var e=i(u().mark((function e(r,n){var a,s,i,c,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return a=this.buildApiUrl(t.API_TREAT_FRIEND,this.gameServerPort),s=o({Authorization:this.token},this.defaultHeaders),i={userid:this.userId,sceneid:r,friendId:n},e.prev=5,e.next=8,d.post(a,i,s);case 8:return c=e.sent,p=JSON.parse(c),this.eventTarget.emit(t.EVENT_TREAT_FRIEND,p),e.abrupt("return",p);case 14:return e.prev=14,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t,r){return e.apply(this,arguments)}}(),c.cleanse=function(){var e=i(u().mark((function e(r){var n,a,s,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return n=this.buildApiUrl(t.API_CLEANSE,this.gameServerPort),a=o({Authorization:this.token},this.defaultHeaders),s={userid:this.userId,sceneid:r},e.prev=5,e.next=8,d.post(n,s,a);case 8:return i=e.sent,c=JSON.parse(i),this.eventTarget.emit(t.EVENT_CLEANSE,c),e.abrupt("return",c);case 14:return e.prev=14,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t){return e.apply(this,arguments)}}(),c.cleanseFriend=function(){var e=i(u().mark((function e(r,n){var a,s,i,c,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return a=this.buildApiUrl(t.API_CLEANSE_FRIEND,this.gameServerPort),s=o({Authorization:this.token},this.defaultHeaders),i={userid:this.userId,sceneid:r,friendId:n},e.prev=5,e.next=8,d.post(a,i,s);case 8:return c=e.sent,p=JSON.parse(c),e.abrupt("return",p);case 13:return e.prev=13,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t,r){return e.apply(this,arguments)}}(),c.updateDiseaseStatus=function(){var e=i(u().mark((function e(r,n){var a,s,i,c,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return a=this.buildApiUrl(t.API_UPDATE_DISEASE_STATUS,this.gameServerPort),s=o({Authorization:this.token},this.defaultHeaders),i={userid:this.userId,sceneid:r,updateDiseaseTimes:n},e.prev=5,e.next=8,d.post(a,i,s);case 8:return c=e.sent,p=JSON.parse(c),this.eventTarget.emit(t.EVENT_UPDATE_DISEASE_STATUS,p),e.abrupt("return",p);case 14:return e.prev=14,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t,r){return e.apply(this,arguments)}}(),c.addBuilding=function(){var e=i(u().mark((function e(r,n,a,s){var i,c,p,h,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return i=this.buildApiUrl(t.API_ADD_BUILDING,this.gameServerPort),c=o({Authorization:this.token},this.defaultHeaders),p={userid:this.userId,buildingId:r,x:n,y:a,parent_node_name:s},e.prev=5,e.next=8,d.post(i,p,c);case 8:return h=e.sent,l=JSON.parse(h),e.abrupt("return",l);case 13:return e.prev=13,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t,r,n,a){return e.apply(this,arguments)}}(),c.querySceneSyntheList=function(){var e=i(u().mark((function e(r){var n,a,s,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return n=this.buildApiUrl(t.API_QUERY_SYNTHE_LIST,this.gameServerPort),a=o({Authorization:this.token},this.defaultHeaders),s={sceneId:r},e.prev=5,e.next=8,d.post(n,s,a);case 8:return i=e.sent,c=JSON.parse(i),e.abrupt("return",c);case 13:return e.prev=13,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}(),c.syntheStart=function(){var e=i(u().mark((function e(r,n){var a,s,i,c,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return a=this.buildApiUrl(t.API_START_SYNTHE,this.gameServerPort),s=o({Authorization:this.token},this.defaultHeaders),i={userId:this.userId,sceneId:n,syntheId:r},e.prev=5,e.next=8,d.post(a,i,s);case 8:return c=e.sent,p=JSON.parse(c),e.abrupt("return",p);case 13:return e.prev=13,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t,r){return e.apply(this,arguments)}}(),c.syntheEnd=function(){var e=i(u().mark((function e(r,n){var a,s,i,c,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return a=this.buildApiUrl(t.API_SYNTHE_END,this.gameServerPort),s=o({Authorization:this.token},this.defaultHeaders),i={userId:this.userId,sceneId:r,syntheId:n},e.prev=5,e.next=8,d.post(a,i,s);case 8:return c=e.sent,p=JSON.parse(c),e.abrupt("return",p);case 13:return e.prev=13,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t,r){return e.apply(this,arguments)}}(),c.visit=function(){var e=i(u().mark((function e(r){var n,a,s,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return n=this.buildApiUrl(t.API_VISIT,this.gameServerPort),a=o({Authorization:this.token},this.defaultHeaders),s={userid:r},e.prev=5,e.next=8,d.post(n,s,a);case 8:return i=e.sent,c=JSON.parse(i),console.log("visit result: "+JSON.stringify(c)),e.abrupt("return",c);case 14:return e.prev=14,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t){return e.apply(this,arguments)}}(),c.recommendFriends=function(){var e=i(u().mark((function e(r,n){var a,s,i,c,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return a=this.buildApiUrl(t.API_RECOMMEND_FRIENDS,this.gameServerPort),s=o({Authorization:this.token},this.defaultHeaders),i={userid:r,recommendNum:n},e.prev=5,e.next=8,d.post(a,i,s);case 8:return c=e.sent,p=JSON.parse(c),e.abrupt("return",p);case 13:return e.prev=13,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t,r){return e.apply(this,arguments)}}(),c.queryPaymentResult=function(){var e=i(u().mark((function e(r,n){var a,s,i,c,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return a=this.buildApiUrl(t.API_QUERY_PAYMENT_RESULT,this.paymentPort),s=o({Authorization:this.token},this.defaultHeaders),i={user_id:this.userId,game_id:r,payment_id:n},e.prev=5,e.next=8,d.post(a,i,s);case 8:return c=e.sent,p=JSON.parse(c),e.abrupt("return",p);case 13:return e.prev=13,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t,r){return e.apply(this,arguments)}}(),c.requestExchangeCoin=function(){var e=i(u().mark((function e(r){var n,a,s,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.simulateNetwork){e.next=2;break}return e.abrupt("return",null);case 2:return n=this.buildApiUrl(t.API_EXCHANGE_COIN,this.paymentPort),a=o({Authorization:this.token},this.defaultHeaders),s={user_id:this.userId,exchange_index:r},e.prev=5,e.next=8,d.post(n,s,a);case 8:return i=e.sent,c=JSON.parse(i),e.abrupt("return",c);case 13:return e.prev=13,e.t0=e.catch(5),this.handleError(e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}(),c.handleError=function(e){console.error("Network error:",e)},c.delay=function(e){return new Promise((function(t){return setTimeout(t,e)}))},s(t,[{key:"baseUrl",get:function(){return"https://farmlinker-tma-test.dashfun.games"}},{key:"SimulateNetwork",get:function(){return this.simulateNetwork}},{key:"defaultHeaders",get:function(){try{return JSON.parse(this.defaultHeadersJson)}catch(e){return console.error("Invalid default headers JSON:",e),{}}}}],[{key:"instance",get:function(){return this._instance}}]),t}(l)).API_LOGIN="/login",g.API_GET_LATEST_COMMAND_DURATION="/game/getLatestCommandDuration",g.API_GET_USER_SCENE_ITEMS="/game/getUserSceneItems",g.API_UPDATE_AVATAR_URL="/user/updateAvatarUrl",g.API_PLANT="/game/plant",g.API_ADD_INVENTORY_ITEM="/inventory/add",g.API_REMOVE_INVENTORY_ITEM="/inventory/remove",g.API_HARVEST="/game/harvest",g.API_BUY_ITEM="/game/buyItem",g.API_SELL_ITEM="/game/sellItem",g.API_CARE="/game/care",g.API_CARE_FRIEND="/game/careFriend",g.API_TREAT="/game/treat",g.API_TREAT_FRIEND="/game/treatFriend",g.API_CLEANSE="/game/cleanse",g.API_CLEANSE_FRIEND="/game/cleanseFriend",g.API_QUERY_DISEASE_STATUS="/game/queryDiseaseStatus",g.API_UPDATE_DISEASE_STATUS="/game/updateDiseaseStatus",g.API_QUERY_SYNTHE_LIST="/game/getSyntheList",g.API_START_SYNTHE="/game/startSynthe",g.API_SYNTHE_END="/game/syntheEnd",g.API_VISIT="/game/visit",g.API_ADD_BUILDING="/scene/addBuilding",g.API_RECOMMEND_FRIENDS="/friend/recommend",g.API_QUERY_PAYMENT_RESULT="/payment/queryPaymentResult",g.API_EXCHANGE_COIN="/payment/exchangeCoin",g.EVENT_LOGIN_SUCCESS="login-success",g.EVENT_LOGIN_FAILED="login-failed",g.EVENT_GET_USER_SCENE_ITEMS="get-user-scene-items",g.EVENT_PLANT="plant",g.EVENT_HARVEST="harvest",g.EVENT_BUY_ITEM="buy-item",g.EVENT_SELL_ITEM="sell-item",g.EVENT_CARE="care",g.EVENT_CARE_FRIEND="care-friend",g.EVENT_TREAT="treat",g.EVENT_TREAT_FRIEND="treat-friend",g.EVENT_CLEANSE="cleanse",g.EVENT_UPDATE_DISEASE_STATUS="update-disease-status",g.EVENT_QUERY_DISEASE_STATUS="query-disease-status",g._instance=null,A=t((m=g).prototype,"localBaseUrl",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"http://localhost"}}),_=t(m.prototype,"serverBaseUrl",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"https://your-server-domain.com"}}),I=t(m.prototype,"loginPort",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3e3}}),b=t(m.prototype,"gameServerPort",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3001}}),N=t(m.prototype,"paymentPort",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3003}}),T=t(m.prototype,"maxLoginRetries",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),S=t(m.prototype,"defaultHeadersJson",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"{}"}}),k=t(m.prototype,"simulateNetwork",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v=m))||v));c._RF.pop()}}}));

System.register("chunks:///_virtual/NetworkPlayerState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PlayerState.ts"],(function(e){var t,i,n,r,a;return{setters:[function(e){t=e.inheritsLoose,i=e.createClass},function(e){n=e.cclegacy,r=e._decorator},function(e){a=e.PlayerState}],execute:function(){var o;n._RF.push({},"e5169bD9fRIEpz/vWDeOzaP","NetworkPlayerState",void 0);var s=r.ccclass;r.property,e("NetworkPlayerState",s("NetworkPlayerState")(o=function(e){function n(t,i){var n;return(n=e.call(this,t.level,t.exp,t.coin,t.diamond)||this)._id="",n._nickname="",n._registerTime=new Date,n._lastLoginTime=new Date,n._token="",n.initialize(t,i),n}return t(n,e),n.prototype.initialize=function(e,t){this._id=e.id,this._nickname=e.nickname,this.level=e.level,this.experience=e.exp,this.gold=e.coin,this.diamond=e.diamond,this._registerTime=new Date(e.register_time),this._lastLoginTime=new Date(e.last_login_time),this._token=t,this.eventTarget.emit("player-state-updated")},i(n,[{key:"Id",get:function(){return this._id}},{key:"Nickname",get:function(){return this._nickname}},{key:"RegisterTime",get:function(){return this._registerTime}},{key:"LastLoginTime",get:function(){return this._lastLoginTime}},{key:"Token",get:function(){return this._token}}]),n}(a))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/PaymentItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ScrollViewItem.ts","./DashFunManager.ts","./NetworkManager.ts","./WindowManager.ts","./SharedDefines.ts","./l10n.ts","./l10n-manager.ts"],(function(t){var n,e,o,i,a,r,s,c,l,u,m,p,y,h,d,f,g,b;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized,a=t.createClass,r=t.asyncToGenerator,s=t.regeneratorRuntime},function(t){c=t.cclegacy,l=t._decorator,u=t.Label,m=t.Button},function(t){p=t.ScrollViewItem},function(t){y=t.DashFunManager,h=t.PayItemType},function(t){d=t.NetworkManager},function(t){f=t.WindowManager},function(t){g=t.SharedDefines},null,function(t){b=t.default}],execute:function(){var I,D,S,v,C,P,T,_,w,x,N,k,M;c._RF.push({},"e5eb8cm1fhKm5+f2+XYGNIm","PaymentItem",void 0);var O=l.ccclass,R=l.property;t("PaymentItem",(I=O("PaymentItem"),D=R(u),S=R(u),v=R(m),C=R(Number),P=R(Number),I((w=n((_=function(t){function n(){for(var n,e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return n=t.call.apply(t,[this].concat(a))||this,o(n,"lblCost",w,i(n)),o(n,"lblAmount",x,i(n)),o(n,"btnPayment",N,i(n)),o(n,"_costDiamond",k,i(n)),o(n,"_amount",M,i(n)),n.payIndex=0,n.paymentType=void 0,n.playerState=void 0,n}e(n,t);var c=n.prototype;return c.initialize=function(t,n,e){this.payIndex=t,this.playerState=n,this.paymentType=e,this.btnPayment.node.on(m.EventType.CLICK,this.onPaymentButtonClick,this),y.instance.eventTarget.on(y.EVENT_OPEN_INVOICE_RESULT,this.onOpenInvoiceResult,this)},c.refresh=function(){this.lblCost.string=this.costDiamond.toString(),this.lblAmount.string=this.amount.toString()},c.onPaymentButtonClick=function(){var t=this;console.log("onPaymentButtonClick",this.paymentType);var n="";this.paymentType==h.Diamond?n=(n=(n=b.t("87chjY045IWbBFtnt0+c8t")).replace("{0}",this.amount.toString())).replace("{1}",this.amount.toString()):this.paymentType==h.Coin&&(n=(n=(n=b.t("944AcGN0hNaKYlY0FlgMhb")).replace("{0}",this.costDiamond.toString())).replace("{1}",this.amount.toString())),f.instance.show(g.WINDOW_TIPS_NAME,n,(function(){t.paymentType==h.Diamond?y.instance.requestPayment("Test","Payment test",t.paymentType,t.amount):t.paymentType==h.Coin&&t.exchangeCoin(t.payIndex,t.costDiamond)}),null)},c.onOpenInvoiceResult=function(t,n,e){this.payIndex==n&&(console.log("onOpenInvoiceResult",t,n,e),t&&(console.log("onOpenInvoiceResult current diamond: "+this.playerState.diamond),this.playerState.addDiamond(e),console.log("onOpenInvoiceResult after add diamond: "+this.playerState.diamond)))},c.exchangeCoin=function(){var t=r(s().mark((function t(n,e){var o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("exchangeCoin payIndex: "+n+", costDiamond: "+e),!(this.playerState.diamond<e)){t.next=4;break}return console.log("PaymentItem::buyCoin not enough diamond"),t.abrupt("return");case 4:return t.next=6,d.instance.requestExchangeCoin(n);case 6:o=t.sent,console.log("exchangeCoin result: "+JSON.stringify(o)),o&&o.success&&(this.playerState.addDiamond(-o.data.costDiamond),this.playerState.addGold(o.data.coinAmount));case 9:case"end":return t.stop()}}),t,this)})));return function(n,e){return t.apply(this,arguments)}}(),a(n,[{key:"costDiamond",get:function(){return this._costDiamond},set:function(t){this._costDiamond=t}},{key:"amount",get:function(){return this._amount},set:function(t){this._amount=t}}]),n}(p)).prototype,"lblCost",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=n(_.prototype,"lblAmount",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=n(_.prototype,"btnPayment",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=n(_.prototype,"_costDiamond",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),M=n(_.prototype,"_amount",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),T=_))||T));c._RF.pop()}}}));

System.register("chunks:///_virtual/PaymentWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WindowBase.ts","./DashFunManager.ts","./CoinDataManager.ts","./DiamondDataManager.ts","./PaymentItem.ts"],(function(t){var e,n,a,i,o,r,l,s,p,m,y,c,u,h,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,a=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,r=t._decorator,l=t.Enum,s=t.Node,p=t.Button,m=t.instantiate},function(t){y=t.WindowBase},function(t){c=t.PayItemType},function(t){u=t.CoinDataManager},function(t){h=t.DiamondDataManager},function(t){f=t.PaymentItem}],execute:function(){var g,d,v,C,I,P,T,D,w;o._RF.push({},"64356gAW5JAibYvWrCE1K3n","PaymentWindow",void 0);var b=r.ccclass,z=r.property;t("PaymentWindow",(g=b("PaymentWindow"),d=z({type:l(c)}),v=z(s),C=z(p),g((T=e((P=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o))||this,a(e,"paymentType",T,i(e)),a(e,"payItemTemplate",D,i(e)),a(e,"closeButton",w,i(e)),e}n(e,t);var o=e.prototype;return o.initialize=function(e){t.prototype.initialize.call(this,e),this.paymentType==c.Coin?this.setupCoinPaymentItems():this.setupDiamondPaymentItems(),this.closeButton.node.on(p.EventType.CLICK,this.onCloseButtonClick,this)},o.show=function(){for(var e,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];(e=t.prototype.show).call.apply(e,[this].concat(a))},o.onCloseButtonClick=function(){this.hide()},o.setupCoinPaymentItems=function(){this.payItemTemplate.active=!1;for(var t=u.instance.getAllCoins(),e=0;e<t.length;e++){var n=t[e],a=m(this.payItemTemplate);a.setParent(this.payItemTemplate.parent),a.active=!0;var i=a.getComponent(f);i.initialize(e,this.gameController.getPlayerController().playerState,this.paymentType),i.amount=parseFloat(n.get_money),i.costDiamond=parseFloat(n.pay_money),i.refresh()}},o.setupDiamondPaymentItems=function(){this.payItemTemplate.active=!1;for(var t=h.instance.getAllDiamonds(),e=0;e<t.length;e++){var n=t[e],a=m(this.payItemTemplate);a.setParent(this.payItemTemplate.parent),a.active=!0;var i=a.getComponent(f);i.initialize(e,this.gameController.getPlayerController().playerState,this.paymentType),i.amount=parseFloat(n.get_money),i.costDiamond=parseFloat(n.pay_money),i.refresh()}},e}(y)).prototype,"paymentType",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return c.Coin}}),D=e(P.prototype,"payItemTemplate",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=e(P.prototype,"closeButton",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=P))||I));o._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PlayerState.ts","./InventoryComponent.ts","./InputComonent.ts","./BuildingManager.ts","./BuildingPlacementComponent.ts","./SharedDefines.ts","./DragDropComponent.ts","./Fence.ts","./PlotTile.ts","./ItemDataManager.ts","./NetworkManager.ts","./WindowManager.ts","./Building.ts"],(function(e){var t,n,i,o,r,a,c,s,l,u,d,h,p,m,g,C,f,y,_,v,P,b,M,T,k,B,S,I,D,w,E,x,N,L,A,z,H,O,F,G;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized,r=e.createForOfIteratorHelperLoose,a=e.createClass,c=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){l=e.cclegacy,u=e._decorator,d=e.CCInteger,h=e.CCString,p=e.Prefab,m=e.Size,g=e.EventTarget,C=e.Vec3,f=e.PhysicsSystem2D,y=e.Vec2,_=e.instantiate,v=e.Director,P=e.Component,b=e.director,M=e.UITransform,T=e.Camera,k=e.Layers},function(e){B=e.PlayerState},function(e){S=e.InventoryItem,I=e.InventoryComponent},function(e){D=e.InputComponent},function(e){w=e.BuildingManager},function(e){E=e.BuildingPlacementComponent},function(e){x=e.InteractionMode,N=e.SharedDefines},function(e){L=e.DragDropComponent},function(e){A=e.Fence},function(e){z=e.PlotTile},function(e){H=e.ItemDataManager},function(e){O=e.NetworkManager},function(e){F=e.WindowManager},function(e){G=e.Building}],execute:function(){var R,V,Y,W,U,j,Z,Q,q,J,K;l._RF.push({},"a9bf4Nd29tBnIxnzrQhHcwm","PlayerController",void 0);var X=u.ccclass,$=u.property;e("PlayerController",(R=X("PlayerController"),V=$(d),Y=$(d),W=$(h),U=$(p),R((Q=t((Z=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).backgroundNode=null,t.backgroundSize=new m(0,0),i(t,"initialMoney",Q,o(t)),i(t,"initialLevel",q,o(t)),i(t,"initialItemIds",J,o(t)),i(t,"placementBuildingPrefab",K,o(t)),t._visitMode=!1,t._inputComponent=null,t._inventoryComponent=void 0,t._camera=void 0,t.currentBuildingPlacement=null,t.dragDropComponent=null,t._playerState=void 0,t._friendState=void 0,t.eventTarget=new g,t._interactionMode=x.CameraDrag,t._isHandlingClick=!1,t}n(t,e);var l=t.prototype;return l.onLoad=function(){var e=c(s().mark((function e(){var t,n,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._playerState=new B("0",1,0,this.initialMoney,0),this._inventoryComponent=this.node.getComponent(I),this._camera||(this._camera=b.getScene().getComponentInChildren(T)),!(t=v.instance.getScene().getChildByPath(N.PATH_INPUT_NODE))){e.next=12;break}this._inputComponent=t.getComponent(D),this._inputComponent.onClick=this.handleClick.bind(this),this._inputComponent.onTouchStart=this.handleTouchStart.bind(this),this._inputComponent.onTouchMove=this.handleTouchMove.bind(this),this._inputComponent.onTouchEnd=this.handleTouchEnd.bind(this),e.next=14;break;case 12:return console.error("No InputNode found"),e.abrupt("return");case 14:this.dragDropComponent=t.addComponent(L),n=v.instance.getScene().getComponentInChildren(A),this.dragDropComponent.registerDropZone(n),i=b.getScene().getChildByPath(N.PATH_GAMEPLAY_CANVAS),this.backgroundNode=null==i?void 0:i.getChildByPath("Gameplay/BG"),this.backgroundNode&&(o=this.backgroundNode.getComponent(M))&&(this.backgroundSize=o.contentSize);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.start=function(){if(O.instance.SimulateNetwork){this._playerState.addGold(this.initialMoney),this._playerState.level=this.initialLevel;for(var e,t=r(this.initialItemIds);!(e=t()).done;){var n=e.value,i=H.instance.getItemById(n);if(i){var o=new S(i);this._inventoryComponent.addItem(o)}}}},l.update=function(e){},l.handleTouchStart=function(e){this.interactionMode===x.CameraDrag&&(this.interactionMode=x.CameraDrag)},l.handleTouchMove=function(e){this.interactionMode===x.CameraDrag&&this.moveCamera(e.getDelta())},l.handleTouchEnd=function(e){this.interactionMode===x.CameraDrag&&(this.interactionMode=x.CameraDrag)},l.moveCamera=function(e){if(this._camera&&this.backgroundNode){var t=this._camera.node.position,n=this._camera.orthoHeight,i=n*this._camera.camera.aspect,o=0-this.backgroundSize.width/2+i,r=0+this.backgroundSize.width/2-i,a=0-this.backgroundSize.height/2+n,c=0+this.backgroundSize.height/2-n,s=Math.max(o,Math.min(r,t.x-e.x)),l=Math.max(a,Math.min(c,t.y-e.y)),u=new C(s,l,t.z);this._camera.node.setPosition(u)}},l.handleClick=function(){var e=c(s().mark((function e(t){var n,i,o,a,c,l,u,d,h,p,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isHandlingClick){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,this._isHandlingClick=!0,!this.dragDropComponent||!this.dragDropComponent.IsDragging){e.next=6;break}return e.abrupt("return");case 6:if(!(n=this.getCollidersByClickPosition(t.getLocation()))){e.next=42;break}i=1<<k.nameToLayer(N.LAYER_FENCE_NAME),o=1<<k.nameToLayer(N.LAYER_PLOTTILE_NAME),a=1<<k.nameToLayer(N.LAYER_BUILDING_NAME),c=r(n);case 12:if((l=c()).done){e.next=42;break}if(!((u=l.value).node.layer&i)){e.next=24;break}if(!(d=u.node.getComponent(A))){e.next=20;break}(!this.visitMode&&d.IsPlayerOwner||this.visitMode&&!d.IsPlayerOwner)&&(h=this._camera.screenToWorld(new C(t.getLocation().x,t.getLocation().y,0)),d.select(this.dragDropComponent,new y(h.x,h.y))),e.next=22;break;case 20:return console.error("Fence node does not have Fence component"),e.abrupt("return");case 22:e.next=40;break;case 24:if(!(u.node.layer&o)){e.next=35;break}if(!(p=u.node.getComponent(z))){e.next=31;break}console.log("visitMode:"+this.visitMode+", plotTile.IsPlayerOwner:"+p.IsPlayerOwner),(!this.visitMode&&p.IsPlayerOwner||this.visitMode&&!p.IsPlayerOwner)&&(this.dragDropComponent.registerDropZone(p),p.select(this.dragDropComponent)),e.next=33;break;case 31:return console.error("PlotTile node does not have PlotTile component"),e.abrupt("return");case 33:e.next=40;break;case 35:if(!(u.node.layer&a)||this.visitMode){e.next=40;break}if(!(m=u.node.getComponent(G))||!m.isFactory){e.next=40;break}return e.next=40,F.instance.show(N.WINDOW_FARM_FACTORY_NAME,m);case 40:e.next=12;break;case 42:return e.prev=42,this._isHandlingClick=!1,e.finish(42);case 45:case"end":return e.stop()}}),e,this,[[2,,42,45]])})));return function(t){return e.apply(this,arguments)}}(),l.getCollidersByClickPosition=function(e){if(this._camera){var t=e,n=this._camera.screenToWorld(new C(t.x,t.y,0)),i=f.instance.testPoint(new y(n.x,n.y));return i.length>0?console.log("Hit object:",i[0].node.name):console.log("Did not hit any object"),i}console.error("Camera not set. Cannot perform touch detection.")},l.startBuildingPlacement=function(e,t){if(this.interactionMode===x.CameraDrag){this.interactionMode=x.BuildingPlacement;var n=_(this.placementBuildingPrefab);if(t)t.addChild(n);else v.instance.getScene().getChildByName("Canvas").addChild(n);this.currentBuildingPlacement=n.addComponent(E),this.currentBuildingPlacement.initialize(e,w.instance),this._inputComponent&&(this._inputComponent.onTouchStart=this.currentBuildingPlacement.onTouchStart.bind(this.currentBuildingPlacement),this._inputComponent.onTouchMove=this.currentBuildingPlacement.onTouchMove.bind(this.currentBuildingPlacement))}},l.tryPlacementBuilding=function(){var e=this;return!!this.currentBuildingPlacement&&(!!this.currentBuildingPlacement.canPlaceBuilding()&&(this.currentBuildingPlacement.placeBuilding((function(t){t.success&&(e._playerState.gold=t.data.coin,e._playerState.diamond=t.data.diamond,e._playerState.prosperity=t.data.prosperity),e.endBuildingPlacement(),e.eventTarget.emit(N.EVENT_PLAYER_PLACEMENT_BUILDING,!0)})),!0))},l.cancelBuildingPlacement=function(){this.currentBuildingPlacement&&(this.currentBuildingPlacement.cancelPlacement(),this.eventTarget.emit(N.EVENT_PLAYER_PLACEMENT_BUILDING,!1),this.endBuildingPlacement())},l.endBuildingPlacement=function(){this.currentBuildingPlacement&&(this.currentBuildingPlacement=null),this._inputComponent&&(this._inputComponent.onTouchStart=this.handleTouchStart.bind(this),this._inputComponent.onTouchMove=this.handleTouchMove.bind(this),this._inputComponent.onTouchEnd=this.handleTouchEnd.bind(this),this._inputComponent.onTouchCancel=null),this.interactionMode=x.CameraDrag},l.harvestCrop=function(e){this._playerState.addGold(e),this._playerState.addExperience(10)},a(t,[{key:"inputComponent",get:function(){return this._inputComponent}},{key:"visitMode",get:function(){return this._visitMode},set:function(e){this._visitMode=e,this.eventTarget.emit(N.EVENT_VISIT_MODE_CHANGE,e)}},{key:"playerState",get:function(){return this._playerState}},{key:"friendState",get:function(){return this._friendState},set:function(e){this._friendState=e}},{key:"inventoryComponent",get:function(){return this._inventoryComponent}},{key:"interactionMode",get:function(){return this._interactionMode},set:function(e){this._interactionMode=e}}]),t}(P)).prototype,"initialMoney",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),q=t(Z.prototype,"initialLevel",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),J=t(Z.prototype,"initialItemIds",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),K=t(Z.prototype,"placementBuildingPrefab",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=Z))||j));l._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts"],(function(e){var t,i,n,r;return{setters:[function(e){t=e.createClass},function(e){i=e.cclegacy,n=e.EventTarget},function(e){r=e.SharedDefines}],execute:function(){i._RF.push({},"915bfk2uhNHXqVxOgQAiJwb","PlayerState",void 0);e("PlayerState",function(){function e(e,t,i,r,s){void 0===t&&(t=1),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=0),this._id="",this._nickname="",this._registerTime=new Date,this._lastLoginTime=new Date,this._token="",this._level=void 0,this._experience=void 0,this._gold=void 0,this._diamond=void 0,this._prosperity=void 0,this._headUrl="",this.eventTarget=void 0,this._id=e,this._level=t,this._experience=i,this._gold=r,this._diamond=s,this._prosperity=0,this.eventTarget=new n}var i=e.prototype;return i.initialize=function(e,t){this._id=e.id,this._nickname=e.nickname,this.level=parseInt(e.level),this.experience=parseInt(e.exp),this.gold=parseInt(e.coin),this.diamond=parseInt(null==e.diamond?"0":e.diamond),this.prosperity=parseInt(null==e.prosperity?"0":e.prosperity),this.headUrl=e.avatarUrl,this._registerTime=new Date(e.register_time),this._lastLoginTime=new Date(e.last_login_time),this._token=t,this.eventTarget.emit(r.EVENT_PLAYER_STATE_INIT,this)},i.addExperience=function(e){this.experience+=Number(e)},i.addGold=function(e){this.gold+=Number(e)},i.addDiamond=function(e){this.diamond+=Number(e)},i.addProsperity=function(e){this.prosperity+=Number(e)},i.spendGold=function(e){return this._gold>=Number(e)&&(this.gold-=Number(e),!0)},i.spendDiamond=function(e){return this._diamond>=Number(e)&&(this.diamond-=Number(e),!0)},i.checkLevelUp=function(){console.log("PlayerState: checkLevelUp  level: "+this.level+" experience: "+this.experience);var e=this.getExpNeededForNextLevel();this.experience>=e&&(this.experience-=e,this.level+=1,console.log("PlayerState: checkLevelUp  levelup: "+this.level+" experience: "+this.experience),this.checkLevelUp())},i.getExpNeededForNextLevel=function(){return Math.floor(100*Math.pow(1.5,this._level-1))},t(e,[{key:"id",get:function(){return this._id}},{key:"nickname",get:function(){return this._nickname},set:function(e){this._nickname=e}},{key:"registerTime",get:function(){return this._registerTime}},{key:"lastLoginTime",get:function(){return this._lastLoginTime}},{key:"token",get:function(){return this._token}},{key:"level",get:function(){return this._level},set:function(e){if(this._level!==e){console.log("set level: "+e);var t=this._level;this._level=e,this.eventTarget.emit(r.EVENT_PLAYER_LEVEL_UP,{oldLevel:t,newLevel:e})}}},{key:"experience",get:function(){return this._experience},set:function(e){if(this._experience!==e){var t=this._experience;this._experience=e,this.eventTarget.emit(r.EVENT_PLAYER_EXP_CHANGE,{oldExp:t,newExp:e}),this.checkLevelUp()}}},{key:"gold",get:function(){return this._gold},set:function(e){if(this._gold!==e){var t=this._gold;this._gold=e,this.eventTarget.emit(r.EVENT_PLAYER_GOLD_CHANGE,{oldGold:t,newGold:e})}}},{key:"diamond",get:function(){return this._diamond},set:function(e){if(this._diamond!==e){var t=this._diamond;this._diamond=e,this.eventTarget.emit(r.EVENT_PLAYER_DIAMOND_CHANGE,{oldDiamond:t,newDiamond:e})}}},{key:"prosperity",get:function(){return this._prosperity},set:function(e){if(this._prosperity!==e){var t=this._prosperity;this._prosperity=e,this.eventTarget.emit(r.EVENT_PLAYER_PROSPERITY_CHANGE,{oldProsperity:t,newProsperity:e})}}},{key:"headUrl",get:function(){return this._headUrl},set:function(e){this._headUrl=e}}]),e}());i._RF.pop()}}}));

System.register("chunks:///_virtual/PlotTile.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Crop.ts","./SharedDefines.ts","./ResourceManager.ts","./WindowManager.ts","./PlayerController.ts","./CooldownComponent.ts","./NetworkManager.ts","./GameController.ts","./SceneEntity.ts","./UIEffectHelper.ts","./CoinCollectionEffectComponent.ts","./UIHelper.ts"],(function(e){var n,t,o,r,i,a,s,c,d,l,u,p,C,h,f,m,g,y,_,T,E,O,v,x,w,P,D,b,N,S;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized,i=e.createClass,a=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){c=e.cclegacy,d=e._decorator,l=e.Vec2,u=e.EventTarget,p=e.PolygonCollider2D,C=e.Director,h=e.Vec3,f=e.instantiate},function(e){m=e.Crop},function(e){g=e.SharedDefines,y=e.FarmSelectionType,_=e.CommandType,T=e.SceneItemType},function(e){E=e.ResourceManager},function(e){O=e.WindowManager},function(e){v=e.PlayerController},function(e){x=e.CooldownComponent},function(e){w=e.NetworkManager},function(e){P=e.GameController},function(e){D=e.SceneEntity},function(e){b=e.UIEffectHelper},function(e){N=e.CoinType},function(e){S=e.UIHelper}],execute:function(){var I,k,W,A,M,L,R;c._RF.push({},"2c396/vGR1Kgb0Gz80PBWGw","PlotTile",void 0);var U=d.ccclass,H=d.property;e("PlotTile",(I=U("PlotTile"),k=H(l),I(((R=function(e){function n(){for(var n,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i))||this,o(n,"isOccupied",M,r(n)),o(n,"gridPosition",L,r(n)),n.polygonCollider=null,n.cooldownComponent=null,n.gameController=null,n.node=void 0,n.occupiedCrop=null,n.careCooldown=0,n.currentDraggable=null,n.dragDropComponent=null,n.playerController=null,n.eventTarget=new u,n}t(n,e);var c=n.prototype;return c.onLoad=function(){this.polygonCollider=this.getComponent(p),this.polygonCollider||console.error("PlotTile: PolygonCollider2D component is missing!"),this.gameController=C.instance.getScene().getComponentInChildren(P),this.gameController||console.error("PlotTile: GameController not found!"),this.cooldownComponent=this.addComponent(x)},c.start=function(){this.playerController=C.instance.getScene().getComponentInChildren(v),this.playerController||console.error("PlotTile: PlayerController not found!"),console.log("start , name = "+this.node.name+" pos = "+this.node.getWorldPosition())},c.initialize=function(e){this.init(this.node.name,e)},c.onDestroy=function(){},c.getWorldPosition=function(){var e=this.node.getWorldPosition();return new l(e.x,e.y)},c.occupy=function(e){e&&!this.isOccupied&&(console.log("occupy crop , name = "+e.node.name),this.occupiedCrop=e,this.node.addChild(e.node),this.isOccupied=!0,console.log("occupy crop 3, name = "+e.node.name),this.eventTarget.emit(g.EVENT_PLOT_OCCUPIED,this),e.eventTarget.on(g.EVENT_CROP_HARVEST,this.onCropHarvest,this),console.log("occupy crop 4, name = "+e.node.name))},c.clear=function(){this.occupiedCrop&&this.occupiedCrop.eventTarget.off(g.EVENT_CROP_HARVEST,this.onCropHarvest,this),this.node.removeAllChildren(),this.occupiedCrop=null,this.isOccupied=!1},c.canCare=function(){return this.occupiedCrop&&this.occupiedCrop.CareCount>=0&&this.occupiedCrop.CareCount<n.MAX_CARE_COUNT&&!this.cooldownComponent.isOnCooldown(g.COOLDOWN_KEY_CARE)},c.canTreat=function(){return this.occupiedCrop&&this.occupiedCrop.TreatCount>=0&&this.occupiedCrop.TreatCount<n.MAX_TREAT_COUNT&&!this.cooldownComponent.isOnCooldown(g.COOLDOWN_KEY_TREAT)},c.canCleanse=function(){return this.occupiedCrop&&this.occupiedCrop.CleanseCount>=0&&this.occupiedCrop.CleanseCount<n.MAX_CLEANSE_COUNT&&!this.cooldownComponent.isOnCooldown(g.COOLDOWN_KEY_CLEANSE)},c.getNode=function(){return this.node},c.onTouchStart=function(e){this.isOccupied||this.eventTarget.emit(g.EVENT_PLOT_SELECTED,this)},c.select=function(e){var n=this;if(!this.cooldownComponent.isOnCooldown("select")){var t=this.gameController.UICanvas,o=this.gameController.GameplayCanvas;if(console.log("select plot tile , name = "+this.node.name+" , occupied = "+this.isOccupied),this.isOccupied){if(this.occupiedCrop.canHarvest())return void this.occupiedCrop.harvest();var r=S.convertPositionBetweenCanvas(this.node.getWorldPosition(),o.node,t.node);O.instance.show(g.WINDOW_SELECTION_NAME,y.PLOT_COMMAND,this.node,r,this.onSelectionWindowItemClicked.bind(this)),console.log("select plot command , name = "+this.node.name)}else{if(!this.isPlayerOwner)return;this.dragDropComponent=e;var i=S.convertPositionBetweenCanvas(this.node.getWorldPosition(),o.node,t.node);O.instance.show(g.WINDOW_SELECTION_NAME,y.PLOT,this.node,i,this.onSelectionWindowItemClicked.bind(this)),console.log("select plot , name = "+this.node.name)}this.cooldownComponent.startCooldown("select",g.COOLDOWN_SELECTION_TIME,(function(){console.log("select cooldown end , name = "+n.node.name)}))}},c.onSelectionWindowItemClicked=function(){var e=a(s().mark((function e(n){var t,o,r,i,a,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onSelectionWindowItemClicked start..."),this.cooldownComponent.startCooldown("select",g.COOLDOWN_SELECTION_TIME,(function(){})),!this.isOccupied){e.next=72;break}if(!(t=this.occupiedCrop.SceneItem)){e.next=70;break}if(n!=_.Care){e.next=27;break}if(o=null,!this.playerController.visitMode){e.next=13;break}return e.next=10,w.instance.careFriend(t.id,this.playerController.friendState.id);case 10:o=e.sent,e.next=16;break;case 13:return e.next=15,w.instance.care(t.id);case 15:o=e.sent;case 16:if(!o.success){e.next=24;break}if(this.occupiedCrop.CareCount=o.data.care_count,!o.data.friend_id){e.next=22;break}return console.log("care friend , name = "+o.data.friend_id+" , friend_id = "+this.playerController.friendState.id+" , diamond_added = "+o.data.diamond_added),e.next=22,this.playDiamondCollectionEffect(o.data.diamond_added);case 22:e.next=25;break;case 24:console.log("Care failed");case 25:e.next=70;break;case 27:if(n!=_.Treat){e.next=49;break}if(r=null,!this.playerController.visitMode){e.next=35;break}return e.next=32,w.instance.treatFriend(t.id,this.playerController.friendState.id);case 32:r=e.sent,e.next=38;break;case 35:return e.next=37,w.instance.treat(t.id);case 37:r=e.sent;case 38:if(!r.success){e.next=46;break}if(this.occupiedCrop.TreatCount=r.data.treat_count,!r.data.friend_id){e.next=44;break}return console.log("treat friend , name = "+r.data.friend_id+" , friend_id = "+this.playerController.friendState.id+" , diamond_added = "+r.data.diamond_added),e.next=44,this.playDiamondCollectionEffect(r.data.diamond_added);case 44:e.next=47;break;case 46:console.log("Treat failed");case 47:e.next=70;break;case 49:if(n!=_.Cleanse){e.next=70;break}if(i=null,!this.playerController.visitMode){e.next=57;break}return e.next=54,w.instance.cleanseFriend(t.id,this.playerController.friendState.id);case 54:i=e.sent,e.next=60;break;case 57:return e.next=59,w.instance.cleanse(t.id);case 59:i=e.sent;case 60:if(!i.success){e.next=69;break}if(a=i.data.cleanse_count,this.occupiedCrop.setImmunityDuration(a,new Date),!i.data.friend_id){e.next=67;break}return console.log("cleanse friend , name = "+i.data.friend_id+" , friend_id = "+this.playerController.friendState.id+" , diamond_added = "+i.data.diamond_added),e.next=67,this.playDiamondCollectionEffect(i.data.diamond_added);case 67:e.next=70;break;case 69:console.log("Cleanse failed");case 70:e.next=75;break;case 72:return c=n,e.next=75,this.createAndStartDraggingCrop(c);case 75:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),c.createAndStartDraggingCrop=function(){var e=a(s().mark((function e(n){var t,o,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.instance.loadPrefab(g.PREFAB_CROP_CORN);case 2:t=e.sent,(o=f(t)).name=n.detailId,(r=o.getComponent(m)).initializeWithInventoryItem(n),r.updateSprite(""+g.WINDOW_SHOP_TEXTURES+n.iconName),C.instance.getScene().getChildByPath(g.PATH_GAMEPLAY).addChild(r.node),this.dragDropComponent.startDragging(r,o);case 11:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),c.isPointInPolygon=function(e,n){for(var t=!1,o=0,r=n.length-1;o<n.length;r=o++){var i=n[o].x,a=n[o].y,s=n[r].x,c=n[r].y;a>e.y!=c>e.y&&e.x<(s-i)*(e.y-a)/(c-a)+i&&(t=!t)}return t},c.getWorldPoints=function(){var e=this.node.getWorldPosition();this.node.getWorldScale(),this.node.angle;return this.polygonCollider.points.map((function(n){return new l(n.x+e.x,n.y+e.y)}))},c.isPointInside=function(e){if(this.polygonCollider){var n=this.getWorldPoints();return this.isPointInPolygon(e,n)}var t=this.node.getWorldPosition(),o=this.node.getContentSize(),r=o.width/2,i=o.height/2;return e.x>=t.x-r&&e.x<=t.x+r&&e.y>=t.y-i&&e.y<=t.y+i},c.canAcceptDrop=function(e){return!this.isOccupied&&e instanceof m},c.onDrop=function(){var e=a(s().mark((function e(n){var t,o,r,i,a=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cooldownComponent.startCooldown("select",g.COOLDOWN_SELECTION_TIME,(function(){})),!(n instanceof m)){e.next=11;break}return console.log("drop crop , name = "+this.node.name),t=n,w.instance.eventTarget.once(w.EVENT_PLANT,(function(e){if(e.success&&null!==a.currentDraggable){var n=a.currentDraggable;n.initializeWithSceneItem(e.data,a.isPlayerOwner),a.plant(n),a.currentDraggable=null}else console.log("crop plant failed , name = "+a.node.name)})),o=this.node.getWorldPosition(),r=this.node.getWorldScale(),i=new l(o.x/r.x,o.y/r.y),this.currentDraggable=n,e.next=11,w.instance.plant(t.id,T.Crop,i.x,i.y,this.node.name);case 11:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),c.plant=function(e,n){void 0===n&&(n=!0),e.node.parent&&e.node.removeFromParent(),this.node.addChild(e.node),e.node.position=h.ZERO,console.log("plant crop 1, name = "+e.node.name),this.occupy(e),console.log("plant crop 2, name = "+e.node.name),e.startGrowing(),n&&this.playerController.inventoryComponent.removeItem(e.SourceInventoryItem.id,1),w.instance.eventTarget.off(w.EVENT_PLANT,this.plant)},c.onCropHarvest=function(e){console.log("crop harvest , name = "+this.node.name),this.clear()},c.onCare=function(e){console.log("onCare , name = "+this.node.name+" , careCount = "+e+" , isPlayer = "+this.isPlayerOwner),this.occupiedCrop.CareCount=e},c.canPerformOperation=function(e){if(!this.occupiedCrop)return!1;switch(e){case _.Care:return this.canCare();case _.Treat:return this.canTreat();case _.Cleanse:return this.canCleanse();default:return!1}},c.performOperation=function(){var e=a(s().mark((function e(n){var t,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.occupiedCrop){e.next=2;break}return e.abrupt("return");case 2:if(t=this.occupiedCrop.SceneItem){e.next=5;break}return e.abrupt("return");case 5:o=null,e.t0=n,e.next=e.t0===_.Care?9:e.t0===_.Treat?14:e.t0===_.Cleanse?19:24;break;case 9:return e.next=11,w.instance.care(t.id);case 11:return(o=e.sent)&&o.success&&(this.occupiedCrop.CareCount=o.data.care_count),e.abrupt("break",24);case 14:return e.next=16,w.instance.treat(t.id);case 16:return(o=e.sent)&&o.success&&(this.occupiedCrop.TreatCount=o.data.treat_count),e.abrupt("break",24);case 19:return e.next=21,w.instance.cleanse(t.id);case 21:return(o=e.sent)&&o.success&&this.occupiedCrop.setImmunityDuration(o.data.cleanse_count,new Date),e.abrupt("break",24);case 24:o&&o.success&&o.data.friend_id&&(console.log("Operation "+n+" on friend's crop, friend_id = "+o.data.friend_id+", diamond_added = "+o.data.diamond_added),this.playerController.playerState.addDiamond(o.data.diamond_added),this.playerController.friendState.addDiamond(o.data.diamond_added));case 25:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),c.playDiamondCollectionEffect=function(){var e=a(s().mark((function e(n){var t,o,r,i,a=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=O.instance.getWindow(g.WINDOW_GAME_NAME),o=t.diamondDisplay){e.next=5;break}return console.error("diamondDisplay not found"),e.abrupt("return");case 5:return r=o.currencySpriteNode.getWorldPosition(),e.next=8,b.playCoinCollectionEffect(N.DIAMOND,this.node,this.node.getWorldPosition(),r);case 8:(i=e.sent).node.on("effectComplete",(function(){a.playerController.playerState.addDiamond(n),a.playerController.friendState.addDiamond(n)}),i.node);case 10:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),i(n,[{key:"OcuippedCrop",get:function(){return this.occupiedCrop}}]),n}(D)).MAX_CARE_COUNT=4,R.MAX_TREAT_COUNT=4,R.MAX_CLEANSE_COUNT=4,R.CARE_COOLDOWN=5*g.TIME_MINUTE,R.TREAT_COOLDOWN=5*g.TIME_MINUTE,R.CLEANSE_COOLDOWN=5*g.TIME_MINUTE,M=n((A=R).prototype,"isOccupied",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),L=n(A.prototype,"gridPosition",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new l(0,0)}}),W=A))||W));c._RF.pop()}}}));

System.register("chunks:///_virtual/resource-data-manager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./localization-global.ts"],(function(r){var e,n,t,u,a,s,c,o,i,p,f;return{setters:[function(r){e=r.asyncToGenerator,n=r.regeneratorRuntime},function(r){t=r.cclegacy,u=r.settings,a=r.Settings,s=r.assetManager},function(r){c=r.resourceListPath,o=r.pluginName,i=r.resourceBundlePath,p=r.mainName,f=r.runtimeBundleName}],execute:function(){t._RF.push({},"0a95a0kirtJnJnMnZWSRaFn","resource-data-manager",void 0);r("default",function(){function r(){}var t=r.prototype;return t.readResourceList=function(){var r=e(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.next=4;break;case 4:return console.log("["+o+"] this is build env"),r.abrupt("return",this.runtimeLoad(c));case 9:return r.abrupt("return",this.previewLoad(c));case 10:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}(),t.readResourceBundle=function(){var r=e(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.next=4;break;case 4:return r.abrupt("return",this.runtimeLoad(i));case 8:return r.abrupt("return",this.previewLoad(i));case 9:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),t.editorLoad=function(){var r=e(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Editor.Message.request(p,"get-resource-bundle",e));case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),t.runtimeLoad=function(){var r=e(n().mark((function r(e){var t,u;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.getBundle(f);case 2:if(t=r.sent){r.next=5;break}return r.abrupt("return",void 0);case 5:return r.next=7,this.getResource(t,e);case 7:if((u=r.sent)&&u.json){r.next=10;break}return r.abrupt("return",void 0);case 10:return r.abrupt("return",u.json);case 11:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}(),t.previewLoad=function(){var r=e(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,fetch(p+"/"+e);case 3:return r.next=5,r.sent.json();case 5:return r.abrupt("return",r.sent);case 8:return r.prev=8,r.t0=r.catch(0),r.abrupt("return",void 0);case 11:case"end":return r.stop()}}),r,null,[[0,8]])})));return function(e){return r.apply(this,arguments)}}(),t.checkBundle=function(){var r=e(n().mark((function r(e){var t,s;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=u.querySettings(a.Category.ASSETS,"preloadBundles"),s=null==t?void 0:t.find((function(r){return r.bundle===e})),r.abrupt("return",!!s);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),t.getBundle=function(){var r=e(n().mark((function r(e){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r){s.loadBundle(e,(function(e,n){r(e?void 0:n)}))})));case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),t.getResource=function(){var r=e(n().mark((function r(e,t){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r){e.load(t,(function(e,n){r(e?void 0:n)}))})));case 1:case"end":return r.stop()}}),r)})));return function(e,n){return r.apply(this,arguments)}}(),r}());t._RF.pop()}}}));

System.register("chunks:///_virtual/ResourceManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n,t,a,c,s,o;return{setters:[function(e){r=e.createClass,n=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){a=e.cclegacy,c=e._decorator,s=e.resources,o=e.Prefab}],execute:function(){var u,i;a._RF.push({},"6ac05Z/rwBKk5Gxv5aLyc2m","ResourceManager",void 0);var l=c.ccclass;c.property,e("ResourceManager",l("ResourceManager")(((i=function(){function e(){this.cache=new Map}var a=e.prototype;return a.loadPrefab=function(){var e=n(t().mark((function e(r){var n,a=this;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=this.cache.get(r))instanceof o)){e.next=3;break}return e.abrupt("return",n);case 3:return e.abrupt("return",new Promise((function(e){s.load(r,o,(function(n,t){n?(console.error("Failed to load prefab "+r+":",n),e(null)):(a.cache.set(r,t),e(t))}))})));case 4:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}(),a.loadAsset=function(){var e=n(t().mark((function e(r,n){var a,c=this;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((a=this.cache.get(r))instanceof n)){e.next=3;break}return e.abrupt("return",a);case 3:return e.abrupt("return",new Promise((function(e){s.load(r,n,(function(n,t){n?(console.error("Failed to load asset "+r+":",n),e(null)):(c.cache.set(r,t),e(t))}))})));case 4:case"end":return e.stop()}}),e,this)})));return function(r,n){return e.apply(this,arguments)}}(),a.releaseAsset=function(e){this.cache.get(e)&&(s.release(e),this.cache.delete(e))},a.clearCache=function(){this.cache.forEach((function(e,r){s.release(r)})),this.cache.clear()},r(e,null,[{key:"instance",get:function(){return null===this._instance&&(this._instance=new e),this._instance}}]),e}())._instance=null,u=i))||u);a._RF.pop()}}}));

System.register("chunks:///_virtual/SceneEntity.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,i,c;return{setters:[function(e){t=e.inheritsLoose,n=e.createClass},function(e){r=e.cclegacy,i=e._decorator,c=e.Component}],execute:function(){var o;r._RF.push({},"5fa4d5/lTdAd6OM+kIBGAyR","SceneEntity",void 0);var s=i.ccclass;i.property,e("SceneEntity",s("SceneEntity")(o=function(e){function r(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).id="",t.isPlayerOwner=!1,t}return t(r,e),r.prototype.init=function(e,t){this.id=e,this.isPlayerOwner=t},n(r,[{key:"Id",get:function(){return this.id}},{key:"IsPlayerOwner",get:function(){return this.isPlayerOwner}}]),r}(c))||o);r._RF.pop()}}}));

System.register("chunks:///_virtual/ScreenOrientationManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts","./WindowManager.ts"],(function(e){var n,i,t,a,o,r,s,c,u,l,p,h,g,S,d,f;return{setters:[function(e){n=e.applyDecoratedDescriptor,i=e.inheritsLoose,t=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){o=e.cclegacy,r=e._decorator,s=e.Canvas,c=e.Camera,u=e.view,l=e.Node,p=e.UITransform,h=e.screen,g=e.ResolutionPolicy,S=e.Component},function(e){d=e.SharedDefines},function(e){f=e.WindowManager}],execute:function(){var v,z,y,I,m,w,D,E,C,H,_;o._RF.push({},"edc1b3IC6hIxaunsPEb/PoY","ScreenOrientationManager",void 0);var O=r.ccclass,T=r.property;e("ScreenOrientationManager",(v=O("ScreenOrientationManager"),z=T(s),y=T(c),I=T(s),m=T(c),v((E=n((D=function(e){function n(){for(var n,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return n=e.call.apply(e,[this].concat(o))||this,t(n,"canvas",E,a(n)),t(n,"camera",C,a(n)),t(n,"gameplayCanvas",H,a(n)),t(n,"gameplayCamera",_,a(n)),n.isLandscape=!1,n}i(n,e);var o=n.prototype;return o.start=function(){var e=this;u.getDesignResolutionSize();this.updateScreenSize(),this.canvas.node.on(l.EventType.SIZE_CHANGED,(function(){var n=e.canvas.getComponent(p);n&&(console.log("canvas size changed y pos = "+n.contentSize.y),e.camera.orthoHeight=n.contentSize.y/2);var i=e.gameplayCanvas.getComponent(p);i&&(console.log("gameplay canvas size changed y pos = "+i.contentSize.y),e.gameplayCamera.orthoHeight=i.contentSize.y/2)}),this),h.on("window-resize",(function(n,i){return e.updateScreenSize()}),this)},o.onDestroy=function(){h.off("window-resize",this.updateScreenSize,this)},o.onScreenResize=function(){this.updateScreenSize()},o.updateScreenSize=function(){console.log("updateScreenSize");var e=h.windowSize.width/h.windowSize.height,n=d.DESIGN_RESOLUTION_WIDTH/d.DESIGN_RESOLUTION_HEIGHT;e<=1?(console.log(""),e<=n?this.updateFitWidth():this.updateFitHeight()):(console.log(""),this.updateFitHeight())},o.updateFitWidth=function(){u.setDesignResolutionSize(d.DESIGN_RESOLUTION_HEIGHT,d.DESIGN_RESOLUTION_WIDTH,g.FIXED_WIDTH),this.isLandscape=!1,this.switchCanvas()},o.updateFitHeight=function(){u.setDesignResolutionSize(d.DESIGN_RESOLUTION_WIDTH,d.DESIGN_RESOLUTION_HEIGHT,g.FIXED_HEIGHT),this.isLandscape=!0,this.switchCanvas()},o.updateOrientation=function(){var e=u.getVisibleSize(),n=e.width>e.height;this.isLandscape!==n&&(this.isLandscape=n,this.switchCanvas())},o.switchCanvas=function(){f.instance.changeWindowOrientation(this.isLandscape)},o.adjustCanvasSize=function(e,n,i){e.getComponent(p)&&console.log("adjustCanvasSize",n,i)},n}(S)).prototype,"canvas",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=n(D.prototype,"camera",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=n(D.prototype,"gameplayCanvas",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=n(D.prototype,"gameplayCamera",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=D))||w));o._RF.pop()}}}));

System.register("chunks:///_virtual/ScrollViewItem.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,o,r,c;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,r=e._decorator,c=e.Component}],execute:function(){var n;o._RF.push({},"e236dr8Cq1EAqC05lcYb4tf","ScrollViewItem",void 0);var i=r.ccclass;r.property,e("ScrollViewItem",i("ScrollViewItem")(n=function(e){function o(){return e.apply(this,arguments)||this}return t(o,e),o.prototype.setScale=function(e){this.node.setScale(e)},o}(c))||n);o._RF.pop()}}}));

System.register("chunks:///_virtual/SharedDefines.ts",["cc"],(function(i){var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"8af2aQ0ArlEeK7Dl0RcVyib","SharedDefines",void 0);i("InteractionMode",function(i){return i[i.CameraDrag=0]="CameraDrag",i[i.BuildingPlacement=1]="BuildingPlacement",i[i.Command=2]="Command",i[i.Plant=3]="Plant",i}({})),i("CropType",function(i){return i[i.WHEAT=1]="WHEAT",i[i.CABBAGE=2]="CABBAGE",i[i.CARROT=3]="CARROT",i[i.TOMATO=4]="TOMATO",i[i.CORN=5]="CORN",i[i.POTATO=6]="POTATO",i[i.STRAWBERRY=7]="STRAWBERRY",i[i.PUMPKIN=8]="PUMPKIN",i[i.GRAPE=9]="GRAPE",i}({})),i("GrowState",function(i){return i[i.NONE=0]="NONE",i[i.GROWING=1]="GROWING",i[i.HARVESTING=2]="HARVESTING",i}({})),i("FarmSelectionType",function(i){return i[i.NONE=0]="NONE",i[i.BUILDING=1]="BUILDING",i[i.PLOT=2]="PLOT",i[i.PLOT_COMMAND=3]="PLOT_COMMAND",i[i.FENCE=4]="FENCE",i[i.ANIMAL_COMMAND=5]="ANIMAL_COMMAND",i}({})),i("SceneItemType",function(i){return i[i.None=0]="None",i[i.Crop=1]="Crop",i[i.Animal=2]="Animal",i[i.Building=3]="Building",i}({})),i("BuildingType",function(i){return i[i.None=0]="None",i[i.Factory=1]="Factory",i[i.Decoration=2]="Decoration",i}({})),i("SceneItemState",function(i){return i[i.None=0]="None",i[i.InProgress=1]="InProgress",i[i.Complete=2]="Complete",i[i.Dead=3]="Dead",i}({})),i("CommandType",function(i){return i[i.None=0]="None",i[i.Care=1]="Care",i[i.Treat=2]="Treat",i[i.Cleanse=3]="Cleanse",i[i.Disease=4]="Disease",i}({})),i("CommandState",function(i){return i[i.None=0]="None",i[i.InProgress=1]="InProgress",i[i.Complete=2]="Complete",i}({})),i("GameState",function(i){return i.LOADING="loading",i.MAIN_MENU="main_menu",i.PLAYING="playing",i.PAUSED="paused",i.GAME_OVER="game_over",i}({})),i("DiseaseState",function(i){return i[i.None=0]="None",i[i.Disease=1]="Disease",i}({})),i("SyntheState",function(i){return i[i.None=0]="None",i[i.InProgress=1]="InProgress",i[i.Complete=2]="Complete",i}({})),i("NetworkLoginResult",(function(){this.success=void 0,this.message=void 0,this.sessionToken=void 0,this.user=void 0})),i("NetworkUser",(function(){this.id=void 0,this.nickname=void 0,this.level=void 0,this.exp=void 0,this.coin=void 0,this.diamond=void 0,this.register_time=void 0,this.last_login_time=void 0,this.inventory_items=void 0})),i("NetworkInventoryItem",(function(){this.id=void 0,this.num=void 0,this.type=void 0,this.item_id=void 0})),i("NetworkHarvestResultData",(function(){this.userid=void 0,this.item_id=void 0,this.exp_gained=void 0,this.new_exp=void 0,this.new_level=void 0,this.current_coin=void 0})),i("NetworkHarvestResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkBuyItemResultData",(function(){this.item_id=void 0,this.current_coin=void 0,this.num=void 0})),i("NetworkBuyItemResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkSellItemResultData",(function(){this.item_id=void 0,this.current_coin=void 0,this.num=void 0})),i("NetworkSellItemResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkCareResultData",(function(){this.sceneid=void 0,this.scene_item_type=void 0,this.command_id=void 0,this.care_count=void 0,this.friend_id=void 0,this.diamond_added=void 0})),i("NetworkCareResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkTreatResultData",(function(){this.sceneid=void 0,this.command_id=void 0,this.treat_count=void 0,this.friend_id=void 0,this.diamond_added=void 0})),i("NetworkTreatResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkCleanseResultData",(function(){this.sceneid=void 0,this.command_id=void 0,this.cleanse_count=void 0,this.friend_id=void 0,this.diamond_added=void 0})),i("NetworkCleanseResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkDiseaseStatusResult",(function(){this.success=void 0,this.message=void 0,this.is_sick=void 0,this.count=void 0,this.last_updated_time=void 0})),i("NetworkSyntheListResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkSyntheResultData",(function(){this.id=void 0,this.sceneid=void 0,this.syntheid=void 0,this.startTime=void 0,this.endTime=void 0,this.count=void 0,this.state=void 0})),i("NetworkSyntheResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkVisitResultData",(function(){this.userId=void 0,this.level=void 0,this.exp=void 0,this.coin=void 0,this.diamond=void 0,this.sceneItems=void 0})),i("NetworkVisitResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkCommand",(function(){this.id=void 0,this.userid=void 0,this.customid=void 0,this.state=void 0,this.last_updated_time=void 0,this.type=void 0,this.sceneid=void 0,this.count=void 0})),i("NetworkAddBuildingResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkAddBuildingResultData",(function(){this.sceneItem=void 0,this.coin=void 0,this.diamond=void 0,this.prosperity=void 0})),i("NetworkRecommendFriendsResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkRecommendFriendsResultData",(function(){this.id=void 0,this.nickname=void 0,this.level=void 0,this.avatarUrl=void 0})),i("NetworkQueryPaymentResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkQueryPaymentResultData",(function(){this.type=void 0,this.amount=void 0})),i("NetworkExchangeCoinResult",(function(){this.success=void 0,this.message=void 0,this.data=void 0})),i("NetworkExchangeCoinResultData",(function(){this.coin=void 0,this.diamond=void 0,this.costDiamond=void 0,this.coinAmount=void 0})),i("SceneItem",(function(){this.id=void 0,this.item_id=void 0,this.type=void 0,this.x=void 0,this.y=void 0,this.state=void 0,this.userid=void 0,this.parent_node_name=void 0,this.last_updated_time=void 0,this.elapsed_time=void 0,this.commands=void 0}));var e=i("SharedDefines",(function(){}));e.CURRENT_USER_ID="123",e.DESIGN_RESOLUTION_WIDTH=1920,e.DESIGN_RESOLUTION_HEIGHT=1080,e.CARE_TIME_RATIO_REDUCE=.05,e.TREAT_TIME_RATIO_REDUCE=.1,e.MAX_CROP_CARE_COUNT=4,e.MAX_CROP_TREAT_COUNT=4,e.MAX_CROP_CLEANSE_COUNT=4,e.MAX_ANIMAL_CARE_COUNT=2,e.MAX_ANIMAL_TREAT_COUNT=2,e.MAX_ANIMAL_CLEANSE_COUNT=2,e.CARE_COOLDOWN=300,e.TREAT_COOLDOWN=300,e.CLEANSE_COOLDOWN=300,e.DISEASE_STATUS_UPDATE_INTERVAL=3600,e.TIME_MINUTE=60,e.INIT_PLOT_NUM=5,e.COOLDOWN_SELECTION_TIME=1,e.COOLDOWN_KEY_CARE="care",e.COOLDOWN_KEY_TREAT="treat",e.COOLDOWN_KEY_CLEANSE="cleanse",e.EVENT_ORIENTATION_CHANGED="orientation-changed",e.EVENT_TOUCH_START="touch-start",e.EVENT_TOUCH_MOVE="touch-move",e.EVENT_TOUCH_END="touch-end",e.EVENT_TOUCH_CANCEL="touch-cancel",e.EVENT_CLICK="click",e.PATH_CAMERA="Canvas/Camera",e.PATH_GAMEPLAY_CANVAS="GameplayCanvas",e.PATH_GAMEPLAY="GameplayCanvas/Gameplay",e.PATH_INPUT_NODE="Canvas/InputNode",e.PATH_BUILDINGS="GameplayCanvas/Gameplay/Buildings",e.EVENT_PLOT_SELECTED="plotSelected",e.EVENT_PLOT_OCCUPIED="plotOccupied",e.EVENT_FENCE_ANIMAL_ADDED="fence-animal-added",e.EVENT_PLAYER_LEVEL_UP="player-level-up",e.EVENT_PLAYER_EXP_CHANGE="player-exp-change",e.EVENT_PLAYER_GOLD_CHANGE="player-gold-change",e.EVENT_PLAYER_DIAMOND_CHANGE="player-diamond-change",e.EVENT_PLAYER_PROSPERITY_CHANGE="player-prosperity-change",e.EVENT_PLAYER_PLACEMENT_BUILDING="player-placement-building",e.EVENT_PLAYER_STATE_INIT="player-state-init",e.EVENT_VISIT_MODE_CHANGE="visit-mode-change",e.EVENT_CROP_HARVEST="crop-harvest",e.EVENT_ANIMAL_HARVEST="animal-harvest",e.WINDOW_CRAFT_NAME="CraftWindow",e.WINDOW_SHOP_NAME="ShopWindow",e.WINDOW_SELECTION_NAME="FarmSelectionWindow",e.WINDOW_FARM_FACTORY_NAME="FarmFactoryWindow",e.WINDOW_GAME_NAME="GameWindow",e.WINDOW_TOAST_NAME="ToastWindow",e.WINDOW_PAYMENT_NAME="PaymentWindow",e.WINDOW_COIN_NAME="CoinWindow",e.WINDOW_TIPS_NAME="TipsWindow",e.WINDOW_CRAFT_TEXTURES="textures/craftWindow/",e.WINDOW_BUILDING_TEXTURES="textures/buildings/",e.WINDOW_GAME_TEXTURES="textures/gameWindow/",e.WINDOW_SHOP_TEXTURES="textures/shopWindow/",e.CROPS_TEXTURES="textures/crops/",e.ANIMALS_TEXTURES="textures/animals/",e.LAYER_GROUND_NAME="Ground",e.LAYER_BUILDING_NAME="Building",e.LAYER_OBSTACLE_NAME="Obstacle",e.LAYER_FENCE_NAME="Fence",e.LAYER_PLOTTILE_NAME="PlotTile",e.CROP_GROWTH_STAGES=4,e.CROP_GROWTH_TIME=10,e.JSON_CROP_DATA="data/CropsData",e.JSON_ITEM_DATA="data/ItemData",e.JSON_BUILD_DATA="data/BuildData",e.JSON_ANIMAL_DATA="data/AnimalData",e.JSON_SYNTHE_DATA="data/SyntheData",e.JSON_GRADE_DATA="data/GradeData",e.JSON_COIN_DATA="data/CoinData",e.JSON_DIAMOND_DATA="data/DiamondData",e.PREFAB_CROP_CORN="entities/crops/Corn",e.PREFAB_CROP_CARROT="entities/crops/Carrot",e.PREFAB_CROP_GRAPE="entities/crops/Grape",e.PREFAB_CROP_CABBAGE="entities/crops/Cabbage",e.PREFAB_ANIMAL="entities/animal/Animal",e.PREFAB_COIN_COLLECTION_EFFECT="ui/effects/CoinCollectEffect",e.PREFAB_PLACEMENT_BUILDING="entities/buildings/placementBuilding",t._RF.pop()}}}));

System.register("chunks:///_virtual/ShopWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WindowBase.ts","./InventoryComponent.ts","./ItemDataManager.ts","./ResourceManager.ts","./SharedDefines.ts","./CoinDisplay.ts","./DiamondDisplay.ts","./WindowManager.ts","./NetworkManager.ts","./CoinCollectionEffectComponent.ts","./UIEffectHelper.ts","./l10n.ts","./l10n-manager.ts"],(function(e){var t,n,o,i,l,r,s,a,c,u,h,p,d,m,f,y,C,I,g,w,v,B,b,E,S,D,L,T,N,P,M,_;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized,l=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){s=e.cclegacy,a=e._decorator,c=e.Node,u=e.ScrollView,h=e.Prefab,p=e.Button,d=e.Label,m=e.Color,f=e.Tween,y=e.Vec3,C=e.Sprite,I=e.instantiate,g=e.SpriteFrame},function(e){w=e.WindowBase},function(e){v=e.InventoryComponent,B=e.InventoryItem},function(e){b=e.ItemDataManager},function(e){E=e.ResourceManager},function(e){S=e.SharedDefines},function(e){D=e.CoinDisplay},function(e){L=e.DiamondDisplay},function(e){T=e.WindowManager},function(e){N=e.NetworkManager},function(e){P=e.CoinType},function(e){M=e.UIEffectHelper},null,function(e){_=e.default}],execute:function(){var z,k,W,U,V,R,Y,A,H,x,F,K,O,X,q,j,G,J,Q,Z,$,ee,te;s._RF.push({},"5d315L1iLpPEJcwuY05Lr5R","ShopWindow",void 0);var ne=a.ccclass,oe=a.property,ie=function(e){return e[e.BUY=0]="BUY",e[e.SELL=1]="SELL",e}(ie||{});e("ShopWindow",(z=ne("ShopWindow"),k=oe(c),W=oe(c),U=oe(u),V=oe(u),R=oe(h),Y=oe(D),A=oe(L),H=oe(p),x=oe(p),F=oe(p),z((X=t((O=function(e){function t(){for(var t,n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return t=e.call.apply(e,[this].concat(l))||this,o(t,"purchaseNode",X,i(t)),o(t,"sellNode",q,i(t)),o(t,"purchaseScrollView",j,i(t)),o(t,"sellScrollView",G,i(t)),o(t,"itemPrefab",J,i(t)),o(t,"coinDisplay",Q,i(t)),o(t,"diamondDisplay",Z,i(t)),o(t,"buyButton",$,i(t)),o(t,"sellButton",ee,i(t)),o(t,"closeButton",te,i(t)),t.playerController=null,t.inventoryComponent=null,t.currentMode=ie.BUY,t.purchaseItemPool=[],t.sellItemPool=[],t}n(t,e);var s=t.prototype;return s.initialize=function(){e.prototype.initialize.call(this),this.initializeComponents(),this.setupEventListeners(),this.showBuyItems()},s.show=function(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];(t=e.prototype.show).call.apply(t,[this].concat(o)),this.setupNetworkEventListeners(),this.switchToMode(this.currentMode),this.coinDisplay&&this.coinDisplay.refreshDisplay(),this.diamondDisplay&&this.diamondDisplay.refreshDisplay(),this.currentMode===ie.BUY?this.showBuyItems():this.showSellItems()},s.hide=function(){e.prototype.hide.call(this),N.instance.eventTarget.off(N.EVENT_BUY_ITEM,this.onBuyItemResult,this)},s.initializeComponents=function(){var e;this.gameController&&(this.playerController=this.gameController.getPlayerController(),this.inventoryComponent=null==(e=this.playerController)?void 0:e.getComponent(v),this.coinDisplay&&this.coinDisplay.initialize(this.playerController.playerState),this.diamondDisplay&&this.diamondDisplay.initialize(this.playerController.playerState))},s.setupEventListeners=function(){var e,t,n;null==(e=this.buyButton)||e.node.on(p.EventType.CLICK,this.onBuyButtonClicked,this),null==(t=this.sellButton)||t.node.on(p.EventType.CLICK,this.onSellButtonClicked,this),null==(n=this.closeButton)||n.node.on(p.EventType.CLICK,this.hide,this)},s.setupNetworkEventListeners=function(){N.instance.eventTarget.on(N.EVENT_BUY_ITEM,this.onBuyItemResult,this)},s.onBuyItemResult=function(e){if(console.log("onBuyItemResult",e),e.success){var t=b.instance.getItemById(e.data.item_id);if(t){var n;this.playerController.playerState.gold=e.data.current_coin;var o=new B(t);null==(n=this.inventoryComponent)||n.addItem(o),console.log("Bought item: "+t.name),this.showBuyItems()}}},s.onBuyButtonClicked=function(){this.animateButton(this.buyButton.node),this.currentMode=ie.BUY,this.switchToMode(ie.BUY),this.showBuyItems()},s.onSellButtonClicked=function(){this.animateButton(this.sellButton.node),this.currentMode=ie.SELL,this.switchToMode(ie.SELL),this.showSellItems()},s.onBtnCloseClicked=function(){T.instance.hide(S.WINDOW_SHOP_NAME)},s.switchToMode=function(e){this.purchaseNode.active=e===ie.BUY,this.sellNode.active=e===ie.SELL;var t=this.buyButton.node.getComponentInChildren(d),n=this.sellButton.node.getComponentInChildren(d);e===ie.BUY?(t.color=m.fromHEX(new m,"#88563F"),n.color=m.fromHEX(new m,"#C4A47E")):(n.color=m.fromHEX(new m,"#88563F"),t.color=m.fromHEX(new m,"#C4A47E"))},s.animateButton=function(e){f.stopAllByTarget(e),e.scale=y.ONE;var t=new f(e).to(.1,{scale:new y(1.25,1.25,1.25)}).to(.1,{scale:y.ONE}),n=new f(e.getComponent(C)).to(.1,{color:new m(180,180,180,255)}).to(.1,{color:m.WHITE});t.start(),n.start()},s.showBuyItems=function(){var e=this;this.clearItems(this.purchaseItemPool,this.purchaseScrollView),b.instance.getAllItems().forEach((function(t){parseInt(t.buy_price)>0&&e.createItemNode(t,t.png,!0,e.purchaseScrollView,e.purchaseItemPool)}))},s.showSellItems=function(){var e,t=this;this.clearItems(this.sellItemPool,this.sellScrollView);var n=(null==(e=this.inventoryComponent)?void 0:e.getAllItems())||[];console.log("Showing sell items: "+n.length),n.forEach((function(e){e.sellPrice>0?t.createItemNode(e,e.iconName,!1,t.sellScrollView,t.sellItemPool):console.log("Item "+e.name+" has no sell price , sell price = "+e.sellPrice)}))},s.clearItems=function(e,t){e.forEach((function(e){e.removeFromParent(),e.active=!1})),t.content.removeAllChildren()},s.createItemNode=function(e,t,n,o,i){var l,r,s,a=this;i.length>0?(s=i.pop()).active=!0:s=I(this.itemPrefab);var c=s.getComponentInChildren(C),u=c.getComponentInChildren(d),h=s.getComponentInChildren(d),m=s.getComponentInChildren(p),f=m.node.getComponentInChildren(d);E.instance.loadAsset(""+S.WINDOW_SHOP_TEXTURES+t+"/spriteFrame",g).then((function(e){e&&(c.spriteFrame=e)})),h.string=_.t(e.description),f.string=n?""+e.buy_price:""+e.sellPrice;var y=(null==(l=this.inventoryComponent)?void 0:l.getItem(e.id))||null;!n&&y&&y.quantity>1?(u.node.active=!0,u.string="x"+y.quantity):u.node.active=!1,m.node.off(p.EventType.CLICK),m.node.on(p.EventType.CLICK,(function(){n?a.buyItem(e):a.sellItem(m,e)}),this),null==(r=o.content)||r.addChild(s)},s.buyItem=function(e){var t,n=parseInt(e.buy_price);(null==(t=this.playerController)?void 0:t.playerState.gold)>=n?N.instance.buyItem(e.id,1):console.log("Not enough gold to buy this item!")},s.sellItem=function(){var e=l(r().mark((function e(t,n){var o,i,l,s,a=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.instance.sellItem(n.id,1);case 2:if(o=e.sent,!(i=b.instance.getItemById(o.data.item_id))){e.next=19;break}if(s=parseInt(i.sell_price),null==(l=this.inventoryComponent)||!l.removeItem(i.id)){e.next=16;break}return console.log("sellItem success"),e.next=10,M.playCoinCollectionEffect(P.COIN,this.node,t.node.getWorldPosition(),this.coinDisplay.node.getWorldPosition());case 10:e.sent.node.on("effectComplete",(function(){a.playerController.playerState.gold+=s,console.log("Sold item: "+i.name+" for "+s+" gold")})),console.log("Sold item: "+i.name+" for "+s+" gold"),this.showSellItems(),e.next=17;break;case 16:console.log("Failed to sell item!");case 17:e.next=20;break;case 19:console.log("The item is not found!");case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),s.onDestroy=function(){var t,n;e.prototype.onDestroy.call(this),null==(t=this.buyButton)||t.node.off(p.EventType.CLICK,this.onBuyButtonClicked,this),null==(n=this.sellButton)||n.node.off(p.EventType.CLICK,this.onSellButtonClicked,this)},t}(w)).prototype,"purchaseNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(O.prototype,"sellNode",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(O.prototype,"purchaseScrollView",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(O.prototype,"sellScrollView",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(O.prototype,"itemPrefab",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(O.prototype,"coinDisplay",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(O.prototype,"diamondDisplay",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(O.prototype,"buyButton",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(O.prototype,"sellButton",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(O.prototype,"closeButton",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=O))||K));s._RF.pop()}}}));

System.register("chunks:///_virtual/SpriteHelper.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var e,t,n,o,i,u;return{setters:[function(r){e=r.asyncToGenerator,t=r.regeneratorRuntime},function(r){n=r.cclegacy,o=r.Color,i=r.resources,u=r.SpriteAtlas}],execute:function(){n._RF.push({},"a8994+B2RdDKbg5UKOrhAWP","SpriteHelper",void 0);r("SpriteHelper",function(){function r(){}return r.getSpriteFrameFromAtlas=function(r,e){if(!r)return console.error("SpriteHelper: Atlas is null or undefined"),null;var t=r.getSpriteFrame(e);return t||console.warn("SpriteHelper: SpriteFrame '"+e+"' not found in atlas"),t},r.getSpriteFrameFromPath=function(){var r=e(t().mark((function r(e,n){var o=this;return t().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r){i.load(e,u,(function(t,i){if(t)return console.error("SpriteHelper: Failed to load atlas at path '"+e+"'",t),void r(null);var u=o.getSpriteFrameFromAtlas(i,n);r(u)}))})));case 1:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),r.setSpriteeOpacity=function(r,e){if(r){e=Math.max(0,Math.min(255,e));var t=r.color;r.color=new o(t.r,t.g,t.b,e)}else console.error("SpriteHelper: Sprite is null or undefined")},r.getSpriteColor=function(r){return r?r.color:(console.error("SpriteHelper: Sprite is null or undefined"),new o(0,0,0,0))},r.setSpriteColor=function(r,e){r?r.color=e:console.error("SpriteHelper: Sprite is null or undefined")},r.setSpriteFrameFromAtlas=function(r,e,t){if(!r)return console.error("SpriteHelper: Sprite is null or undefined"),!1;if(!e)return console.error("SpriteHelper: Atlas is null or undefined"),!1;var n=this.getSpriteFrameFromAtlas(e,t);return n?(r.spriteFrame=n,!0):(console.log("SpriteHelper: SpriteFrame '"+t+"' not found in atlas"),!1)},r.setSpriteFrameFromPath=function(){var r=e(t().mark((function r(e,n,o){var i;return t().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=3;break}return console.error("SpriteHelper: Sprite is null or undefined"),r.abrupt("return",!1);case 3:return r.next=5,this.getSpriteFrameFromPath(n,o);case 5:if(!(i=r.sent)){r.next=9;break}return e.spriteFrame=i,r.abrupt("return",!0);case 9:return r.abrupt("return",!1);case 10:case"end":return r.stop()}}),r,this)})));return function(e,t,n){return r.apply(this,arguments)}}(),r}());n._RF.pop()}}}));

System.register("chunks:///_virtual/SyntheDataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts"],(function(t){var n,e,a,r,i,s,u;return{setters:[function(t){n=t.createClass,e=t.asyncToGenerator,a=t.regeneratorRuntime},function(t){r=t.cclegacy,i=t.resources,s=t.JsonAsset},function(t){u=t.SharedDefines}],execute:function(){r._RF.push({},"42232cQId5CpJftA8OhJBjy","SyntheDataManager",void 0),t("SyntheDataManager",function(){function t(){this.syntheDataList=[]}var r=t.prototype;return r.loadSyntheData=function(){var t=e(a().mark((function t(){var n=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){i.load(u.JSON_SYNTHE_DATA,s,(function(a,r){if(a)return console.error("Failed to load SyntheData:",a),void e(a);n.syntheDataList=r.json.list,t()}))})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r.findSyntheDataById=function(t){return this.syntheDataList.find((function(n){return n.id===t}))},r.findSyntheDataByName=function(t){return this.syntheDataList.find((function(n){return n.name===t}))},r.filterSyntheDataByBuild=function(t){return this.syntheDataList.filter((function(n){return n.build===t}))},r.getAllSyntheData=function(){return[].concat(this.syntheDataList)},r.getSyntheDataCount=function(){return this.syntheDataList.length},r.isSyntheDataLoaded=function(){return this.syntheDataList.length>0},n(t,null,[{key:"instance",get:function(){return null===this._instance&&(this._instance=new t),this._instance}}]),t}())._instance=null,r._RF.pop()}}}));

System.register("chunks:///_virtual/TipsWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WindowBase.ts"],(function(t){var e,n,i,o,l,s,a,c,r;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){l=t.cclegacy,s=t._decorator,a=t.Label,c=t.Button},function(t){r=t.WindowBase}],execute:function(){var u,h,p,C,d;l._RF.push({},"ed04f8RRXZABYF6cb2Y5x2p","TipsWindow",void 0);var f=s.ccclass,v=s.property,y=function(t){return t[t.OK=0]="OK",t[t.OK_CANCEL=1]="OK_CANCEL",t}(y||{});t("TipsWindow",(u=f("TipsWindow"),h=v(a),u((d=e((C=function(t){function e(){for(var e,n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return e=t.call.apply(t,[this].concat(l))||this,i(e,"lblMessage",d,o(e)),e.mode=y.OK,e.okCallback=null,e.cancelCallback=null,e}n(e,t);var l=e.prototype;return l.initialize=function(){t.prototype.initialize.call(this)},l.show=function(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];if((e=t.prototype.show).call.apply(e,[this].concat(i)),i.length>=2){var l=i[0];this.okCallback=i[1],this.cancelCallback=i[2],this.updateUI(l),this.setupEventListeners()}},l.setupEventListeners=function(){var t,e,n=this.animationNode,i=null==n||null==(t=n.getChildByName("btnConfirm"))?void 0:t.getComponent(c),o=null==n||null==(e=n.getChildByName("btnCancel"))?void 0:e.getComponent(c);i&&i.node.on(c.EventType.CLICK,this.onOkButtonClicked,this),o&&o.node.on(c.EventType.CLICK,this.onCancelButtonClicked,this)},l.updateUI=function(t){this.lblMessage&&(this.lblMessage.string=t)},l.onOkButtonClicked=function(){this.okCallback&&this.okCallback(),this.hide()},l.onCancelButtonClicked=function(){this.cancelCallback&&this.cancelCallback(),this.hide()},l.hide=function(){this.removeEventListeners(),t.prototype.hide.call(this)},l.removeEventListeners=function(){var t,e,n=this.node,i=null==n||null==(t=n.getChildByName("btnConfirm"))?void 0:t.getComponent(c),o=null==n||null==(e=n.getChildByName("btnCancel"))?void 0:e.getComponent(c);i&&i.node.off(c.EventType.CLICK,this.onOkButtonClicked,this),o&&o.node.off(c.EventType.CLICK,this.onCancelButtonClicked,this)},l.onDestroy=function(){t.prototype.onDestroy.call(this),this.removeEventListeners()},e}(r)).prototype,"lblMessage",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=C))||p));l._RF.pop()}}}));

System.register("chunks:///_virtual/ToastWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./WindowBase.ts"],(function(t){var e,o,i,n,a,r,s,c,l,u,p,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){a=t.cclegacy,r=t._decorator,s=t.Label,c=t.Node,l=t.UIOpacity,u=t.tween,p=t.Vec3},function(t){h=t.WindowBase}],execute:function(){var y,d,w,f,T,v,g;a._RF.push({},"8ae5b/wMrdNR5jxBd4gj2QM","ToastWindow",void 0);var N=r.ccclass,b=r.property;t("ToastWindow",(y=N("ToastWindow"),d=b(s),w=b(c),y((v=e((T=function(t){function e(){for(var e,o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,i(e,"txtToast",v,n(e)),i(e,"layoutNode",g,n(e)),e.currentTween=null,e}o(e,t);var a=e.prototype;return a.initialize=function(){t.prototype.initialize.call(this)},a.show=function(){for(var e,o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];(e=t.prototype.show).call.apply(e,[this].concat(i)),i.length>0&&"string"==typeof i[0]&&this.showToast(i[0])},a.showToast=function(t){var e=this;this.txtToast&&(this.txtToast.string=t),this.currentTween&&this.currentTween.stop(),this.layoutNode.active=!0;var o=this.layoutNode.getComponent(l)||this.layoutNode.addComponent(l);o.opacity=0,this.currentTween=u(this.layoutNode).to(.3,{scale:new p(1,1,1)}).call((function(){u(o).to(.3,{opacity:255}).delay(2).to(.3,{opacity:0}).call((function(){e.layoutNode.active=!1})).start()})).start()},a.hide=function(){this.currentTween&&this.currentTween.stop(),this.layoutNode.active=!1,t.prototype.hide.call(this)},e}(h)).prototype,"txtToast",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=e(T.prototype,"layoutNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=T))||f));a._RF.pop()}}}));

System.register("chunks:///_virtual/UIAdaptComponent.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SharedDefines.ts"],(function(t){var e,i,n,o,r,s,a,u,c;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.screen,r=t.view,s=t.ResolutionPolicy,a=t.EventTarget,u=t.Component},function(t){c=t.SharedDefines}],execute:function(){var h;i._RF.push({},"d0bdebnz9FE77EoX4yDppAt","UIAdaptComponent",void 0);var d=n.ccclass,p=(n.property,t("Orientation",function(t){return t[t.Portrait=0]="Portrait",t[t.Landscape=1]="Landscape",t}({})));t("UIAdaptComponent",d("UIAdaptComponent")(h=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).orientation=p.Portrait,e.eventTarget=new a,e}e(i,t);var n=i.prototype;return n.start=function(){var t=this;o.on("window-resize",(function(e,i){return t.updateScreenSize()}),this),this.updateScreenSize()},n.update=function(t){},n.updateOrientation=function(){var t=o.windowSize,e=t.width>t.height;e&&this.orientation!==p.Landscape&&(this.orientation=e?p.Landscape:p.Portrait,this.eventTarget.emit(c.EVENT_ORIENTATION_CHANGED,this.orientation))},n.updateScreenSize=function(){console.log("updateScreenSize");var t=o.windowSize.width/o.windowSize.height,e=r.getDesignResolutionSize().width/r.getDesignResolutionSize().height;t<=1?(console.log(""),t<=e?this.updateFitWidth():this.updateFitHeight()):(console.log(""),this.updateFitHeight())},n.updateFitWidth=function(){r.setDesignResolutionSize(r.getDesignResolutionSize().width,r.getDesignResolutionSize().height,s.FIXED_WIDTH)},n.updateFitHeight=function(){r.setDesignResolutionSize(r.getDesignResolutionSize().width,r.getDesignResolutionSize().height,s.FIXED_HEIGHT)},i}(u))||h);i._RF.pop()}}}));

System.register("chunks:///_virtual/UIEffectHelper.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourceManager.ts","./CoinCollectionEffectComponent.ts","./SharedDefines.ts"],(function(e){var n,t,r,o,c,a,i,u;return{setters:[function(e){n=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){r=e.cclegacy,o=e._decorator,c=e.instantiate},function(e){a=e.ResourceManager},function(e){i=e.CoinCollectionEffectComponent},function(e){u=e.SharedDefines}],execute:function(){var f;r._RF.push({},"d03b8ziZ1FBRprSLb42mnd0","UIEffectHelper",void 0);var s=o.ccclass;o.property,e("UIEffectHelper",s("UIEffectHelper")(f=function(){function e(){}return e.playCoinCollectionEffect=function(){var e=n(t().mark((function e(n,r,o,f){var s,l,p;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.instance.loadPrefab(u.PREFAB_COIN_COLLECTION_EFFECT);case 2:if(!(s=e.sent)){e.next=10;break}return l=c(s),r.addChild(l),l.setPosition(o),(p=l.getComponent(i)).play(n,o,f),e.abrupt("return",p);case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e)})));return function(n,t,r,o){return e.apply(this,arguments)}}(),e}())||f);r._RF.pop()}}}));

System.register("chunks:///_virtual/UIHelper.ts",["cc"],(function(n){var e,o,t,r,c;return{setters:[function(n){e=n.cclegacy,o=n._decorator,t=n.UITransform,r=n.Vec2,c=n.Camera}],execute:function(){e._RF.push({},"4f94aoWOEBIMK41wQhPw3Sc","UIHelper",void 0);o.ccclass,o.property,n("UIHelper",function(){function n(){}return n.isPointInUINode=function(n,e){var o=e.getComponent(t);return!!o&&o.getBoundingBoxToWorld().contains(n)},n.isPointInUINodeWorldPosition=function(n,e){var o=e.getComponent(t);return!!o&&o.getBoundingBoxToWorld().contains(new r(n.x,n.y))},n.convertPositionBetweenCanvas=function(n,e,o){var t=e.getComponentInChildren(c).worldToScreen(n);return o.getComponentInChildren(c).screenToWorld(t)},n}());e._RF.pop()}}}));

System.register("chunks:///_virtual/WindowBase.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameController.ts","./WindowManager.ts"],(function(n){var e,i,t,o,a,l,r,s,c,u,d,h,w,p;return{setters:[function(n){e=n.applyDecoratedDescriptor,i=n.inheritsLoose,t=n.initializerDefineProperty,o=n.assertThisInitialized,a=n.createClass},function(n){l=n.cclegacy,r=n._decorator,s=n.Node,c=n.Vec3,u=n.director,d=n.Tween,h=n.Component},function(n){w=n.GameController},function(n){p=n.WindowOrientation}],execute:function(){var f,y,g,m,v;l._RF.push({},"ed3fbI+4w9EIaqTbHXEvVou","WindowBase",void 0);var C=r.ccclass,N=r.property;n("WindowBase",(f=C("WindowBase"),y=N(s),f((v=e((m=function(n){function e(){for(var e,i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=n.call.apply(n,[this].concat(a))||this,t(e,"animationNode",v,o(e)),e.playingTween=null,e.gameController=null,e.originalContentSize=new c,e.windowOrientation=p.LANDSCAPE,e.realScale=new c,e}i(e,n);var l=e.prototype;return l.onLoad=function(){},l.start=function(){},l.initialize=function(n){var e;void 0===n&&(n=p.LANDSCAPE),this.windowOrientation=n;var i=null==(e=u.getScene())?void 0:e.getChildByName("GameController");i&&(this.gameController=i.getComponent(w))},l.show=function(){var n=this;this.node.active=!0,this.scheduleOnce((function(){n.playJellyAnimation()}),.03)},l.hide=function(){this.playingTween&&(this.playingTween.stop(),this.playingTween=null,this.animationNode.setScale(1,1,1)),this.node.active=!1},l.onOrientationChange=function(n){},l.playJellyAnimation=function(){var n=this;if(this.animationNode){var e=this.animationNode,i=c.ONE;e.setScale(.7,.7,1),this.playingTween=new d(e).to(.03,{scale:new c(1.03,1.03,1)},{easing:"bounceOut"}).to(.06,{scale:new c(.97,.97,1)}).to(.9,{scale:i}).call((function(){n.onJellyAnimationEnd()})).start()}},l.onJellyAnimationEnd=function(){this.playingTween=null,this.animationNode.setScale(1,1,1)},a(e,[{key:"WindowOrientation",get:function(){return this.windowOrientation},set:function(n){this.windowOrientation=n,this.onOrientationChange(n)}},{key:"RealScale",get:function(){return this.realScale}}]),e}(h)).prototype,"animationNode",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=m))||g));l._RF.pop()}}}));

System.register("chunks:///_virtual/WindowManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourceManager.ts","./WindowBase.ts"],(function(n){var e,t,i,r,o,a,s,c,u,d,l,w,p,f,h;return{setters:[function(n){e=n.applyDecoratedDescriptor,t=n.inheritsLoose,i=n.initializerDefineProperty,r=n.assertThisInitialized,o=n.createClass,a=n.asyncToGenerator,s=n.regeneratorRuntime},function(n){c=n.cclegacy,u=n._decorator,d=n.Camera,l=n.Node,w=n.Component,p=n.instantiate},function(n){f=n.ResourceManager},function(n){h=n.WindowBase}],execute:function(){var g,b,W,y,C,v,M,m;c._RF.push({},"abf38uGofRBMJ/xsROxtr96","WindowManager",void 0);var A=u.ccclass,x=u.property,L=n("WindowOrientation",function(n){return n.PORTRAIT="portrait",n.LANDSCAPE="landscape",n}({}));n("WindowManager",(g=A("WindowManager"),b=x(d),W=x(l),g(((m=function(n){function e(){for(var e,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return e=n.call.apply(n,[this].concat(o))||this,i(e,"camera",v,r(e)),e.currentOrientation=L.LANDSCAPE,e.windowMap=new Map,i(e,"windowsContainer",M,r(e)),e.isLoadingWindow=!1,e}t(e,n);var c=e.prototype;return c.onLoad=function(){e._instance=this},c.initialize=function(){this.windowsContainer||console.warn("Windows container is not set. Please assign it in the editor.")},c.show=function(){var n=a(s().mark((function n(e){var t,i,r,o,a,c,u,d,l,w=arguments;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isLoadingWindow){n.next=2;break}return n.abrupt("return");case 2:if(n.prev=2,this.isLoadingWindow=!0,i=this.windowMap.get(e)){n.next=25;break}return r=this.currentOrientation===L.LANDSCAPE?"landscape":"portrait",o="ui/windows/"+r+"/"+e,n.next=10,f.instance.loadPrefab(o);case 10:if(a=n.sent){n.next=14;break}return console.error("Failed to load prefab: "+e),n.abrupt("return");case 14:if(c=p(a),this.windowsContainer){n.next=18;break}return console.error("Windows container is not set"),n.abrupt("return");case 18:if(this.windowsContainer.addChild(c),i=c.getComponent(h)){n.next=23;break}return console.error("WindowBase component not found on prefab: "+e),n.abrupt("return");case 23:i.initialize(this.currentOrientation),this.windowMap.set(e,i);case 25:for(u=w.length,d=new Array(u>1?u-1:0),l=1;l<u;l++)d[l-1]=w[l];(t=i).show.apply(t,d),i.node.setSiblingIndex(i.node.parent.children.length-1);case 28:return n.prev=28,this.isLoadingWindow=!1,n.finish(28);case 31:case"end":return n.stop()}}),n,this,[[2,,28,31]])})));return function(e){return n.apply(this,arguments)}}(),c.getWindow=function(n){var e=this.windowMap.get(n);return e||(console.warn("Window not found: "+n),null)},c.changeWindowOrientation=function(n){this.currentOrientation=n?L.LANDSCAPE:L.PORTRAIT},c.hide=function(n){var e=this.windowMap.get(n);e?e.hide():console.warn("Window not found: "+n)},o(e,[{key:"uiCamera",get:function(){return this.camera}}],[{key:"instance",get:function(){if(null===this._instance){var n=new l("WindowManager");this._instance=n.addComponent(e)}return this._instance}}]),e}(w))._instance=null,v=e((C=m).prototype,"camera",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(C.prototype,"windowsContainer",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=C))||y));c._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});